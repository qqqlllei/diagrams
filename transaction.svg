<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="2101px" height="2631px" viewBox="-0.5 -0.5 2101 2631" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2020-08-26T07:55:55.174Z&quot; agent=&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.6.2 Chrome/83.0.4103.122 Electron/9.2.0 Safari/537.36&quot; etag=&quot;x24Xti76buK4Go9lCigZ&quot; version=&quot;13.6.2&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;Y8oYmp99auzHq-wwUD1S&quot; name=&quot;第 1 页&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs><linearGradient x1="0%" y1="0%" x2="0%" y2="100%" id="mx-gradient-f5f5f5-1-b3b3b3-1-s-0"><stop offset="0%" style="stop-color:#f5f5f5"/><stop offset="100%" style="stop-color:#b3b3b3"/></linearGradient></defs><g><rect x="0" y="460" width="2100" height="2170" rx="42" ry="42" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 2098px; height: 1px; padding-top: 467px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 19px"><b>Transaction</b></font></div></div></div></foreignObject><text x="1050" y="479" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Transaction</text></switch></g><rect x="915" y="495" width="270" height="60" rx="9" ry="9" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 268px; height: 1px; padding-top: 525px; margin-left: 916px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">TransactionInterceptor<br />基于aop，代理对象进行方法拦截invokeWithinTransaction</div></div></div></foreignObject><text x="1050" y="529" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">TransactionInterceptor...</text></switch></g><rect x="20" y="630" width="2060" height="1990" rx="59.7" ry="59.7" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 2058px; height: 1px; padding-top: 637px; margin-left: 21px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">invokeWithinTransaction</div></div></div></foreignObject><text x="1050" y="653" fill="#000000" font-family="Helvetica" font-size="16px" text-anchor="middle" font-weight="bold">invokeWithinTransaction</text></switch></g><path d="M 563 730 L 563 750 L 563 740 L 563 753.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 563 758.88 L 559.5 751.88 L 563 753.63 L 566.5 751.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="440" y="690" width="246" height="40" rx="6" ry="6" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 244px; height: 1px; padding-top: 710px; margin-left: 441px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 12px">getTransactionAttributeSource<br />AnnotationTransactionAttributeSource</font></div></div></div></foreignObject><text x="563" y="715" fill="#000000" font-family="Helvetica" font-size="16px" text-anchor="middle">getTransactionAttributeSource...</text></switch></g><path d="M 563 800 L 563 820 L 563 810 L 563 823.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 563 828.88 L 559.5 821.88 L 563 823.63 L 566.5 821.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="440" y="760" width="246" height="40" rx="6" ry="6" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 244px; height: 1px; padding-top: 780px; margin-left: 441px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 12px">getTransactionAttribute<br />获取事务属性信息<br /></font></div></div></div></foreignObject><text x="563" y="785" fill="#000000" font-family="Helvetica" font-size="16px" text-anchor="middle">getTransactionAttribute...</text></switch></g><path d="M 563 870 L 563 900 L 1050 900 L 1050 923.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1050 928.88 L 1046.5 921.88 L 1050 923.63 L 1053.5 921.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="440" y="830" width="246" height="40" rx="6" ry="6" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 244px; height: 1px; padding-top: 850px; margin-left: 441px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">determineTransactionManager<br />获取TransactionManager</div></div></div></foreignObject><text x="563" y="854" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">determineTransactionManager...</text></switch></g><path d="M 545 2160 L 545 2180 L 405 2180 L 405 2193.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 405 2198.88 L 401.5 2191.88 L 405 2193.63 L 408.5 2191.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="40" y="930" width="2020" height="1230" rx="24.6" ry="24.6" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 2018px; height: 1px; padding-top: 937px; margin-left: 41px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">createTransactionIfNecessary</div></div></div></foreignObject><text x="1050" y="949" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">createTransactionIfNecessary</text></switch></g><rect x="70" y="980" width="1970" height="1140" rx="22.8" ry="22.8" fill="#cce5ff" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1968px; height: 1px; padding-top: 987px; margin-left: 71px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">getTransaction</div></div></div></foreignObject><text x="1055" y="999" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">getTransaction</text></switch></g><path d="M 915 1070 L 915 1090 L 915 1089 L 915 1102.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 915 1107.88 L 911.5 1100.88 L 915 1102.63 L 918.5 1100.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="645" y="1010" width="540" height="60" rx="9" ry="9" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 538px; height: 1px; padding-top: 1017px; margin-left: 646px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">doGetTransaction<br />创建DataSourceTransactionObject对象，从TM里获取ConnectionHolder<br />ConnectionHolder是JDBC的connection包装类</div></div></div></foreignObject><text x="915" y="1029" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">doGetTransaction...</text></switch></g><path d="M 680 1149 L 635 1149 L 635 1223.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 635 1228.88 L 631.5 1221.88 L 635 1223.63 L 638.5 1221.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 1150 1149 L 1505 1149 L 1505 1223.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1505 1228.88 L 1501.5 1221.88 L 1505 1223.63 L 1508.5 1221.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 915 1109 L 1150 1149 L 915 1189 L 680 1149 Z" fill="#a0522d" stroke="#6d1f00" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 468px; height: 1px; padding-top: 1149px; margin-left: 681px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">判断当前是否已经有事务存在<br />holder是否存在，且事务属性transactionActive是否为true</div></div></div></foreignObject><text x="915" y="1153" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">判断当前是否已经有事务存在&#xa;holder是否存在，且事务属性transactionActive是否为true</text></switch></g><path d="M 480 1260 L 405 1260 L 405 1353.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 405 1358.88 L 401.5 1351.88 L 405 1353.63 L 408.5 1351.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="480" y="1230" width="310" height="60" rx="9" ry="9" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 308px; height: 1px; padding-top: 1237px; margin-left: 481px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">如果当前事物传播属性是MANDATORY<br />直接抛出异常，该属性的逻辑是支持当前事务，如果不存在抛出异常</div></div></div></foreignObject><text x="635" y="1249" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">如果当前事物传播属性是MANDATORY...</text></switch></g><rect x="1000" y="1230" width="1010" height="860" rx="17.2" ry="17.2" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1008px; height: 1px; padding-top: 1237px; margin-left: 1001px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">handleExistingTransaction</div></div></div></foreignObject><text x="1505" y="1249" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">handleExistingTransaction</text></switch></g><rect x="590" y="1169" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 1179px; margin-left: 591px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">否</div></div></div></foreignObject><text x="610" y="1183" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">否</text></switch></g><rect x="1220" y="1169" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 1179px; margin-left: 1221px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">是</div></div></div></foreignObject><text x="1240" y="1183" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">是</text></switch></g><path d="M 405 1410 L 405 1473.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 405 1478.88 L 401.5 1471.88 L 405 1473.63 L 408.5 1471.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="280" y="1360" width="250" height="50" rx="7.5" ry="7.5" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 248px; height: 1px; padding-top: 1367px; margin-left: 281px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">REQUIRED||REQUIRES_NEW||NESTED<br />传播类型的事务执行suspend方法，传入参数为null，及挂起一个空事务</div></div></div></foreignObject><text x="405" y="1379" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">REQUIRED||REQUIRES_NEW||NESTED...</text></switch></g><path d="M 405 1530 L 405 1633.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 405 1638.88 L 401.5 1631.88 L 405 1633.63 L 408.5 1631.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="280" y="1480" width="250" height="50" rx="7.5" ry="7.5" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 248px; height: 1px; padding-top: 1487px; margin-left: 281px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">newTransactionStatus<br />DefaultTransactionStatus</div></div></div></foreignObject><text x="405" y="1499" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">newTransactionStatus...</text></switch></g><path d="M 405 1740 L 405 1775 L 405.1 1775 L 405.1 1803.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 405.1 1808.88 L 401.6 1801.88 L 405.1 1803.63 L 408.6 1801.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="97.5" y="1640" width="615" height="100" rx="5" ry="5" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 613px; height: 1px; padding-top: 1647px; margin-left: 100px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">doBegin<br />1：如果connectionHolder不存在||synchronizedWithTransaction为true则从dataSource获取connection，且创建ConnectionHolder对象<br />2：设置synchronizedWithTransaction为true设置previousIsolationLevel<br />3：设置autoCommit属性为false，设置holder的transactionActive为true<br />4：如果是新的holder绑定当前dataSource和connectionHodler存入属性为resources的ThreadLocal中。<div><br /></div><div><br /></div></div></div></div></foreignObject><text x="100" y="1659" fill="#ffffff" font-family="Helvetica" font-size="12px" font-weight="bold">doBegin...</text></switch></g><rect x="1050" y="1270" width="140" height="50" rx="7.5" ry="7.5" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 1295px; margin-left: 1051px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">never<br />传播类型，直接抛出异常</div></div></div></foreignObject><text x="1120" y="1299" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">never...</text></switch></g><path d="M 1295 1320 L 1297.1 1320 L 1297.07 1344.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1297.06 1349.75 L 1293.57 1342.75 L 1297.07 1344.5 L 1300.57 1342.76 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="1260" y="1270" width="140" height="50" rx="7.5" ry="7.5" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 1295px; margin-left: 1261px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">not_supporte</div></div></div></foreignObject><text x="1330" y="1299" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">not_supporte</text></switch></g><path d="M 1530 1320 L 1527.9 1320 L 1527.92 1343.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1527.92 1348.88 L 1524.41 1341.88 L 1527.92 1343.63 L 1531.41 1341.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="1460" y="1270" width="140" height="50" rx="7.5" ry="7.5" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 1295px; margin-left: 1461px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">requires_new</div></div></div></foreignObject><text x="1530" y="1299" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">requires_new</text></switch></g><path d="M 1720 1320 L 1720 1510 L 1719.9 1510 L 1719.9 1693.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1719.9 1698.88 L 1716.4 1691.88 L 1719.9 1693.63 L 1723.4 1691.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="1650" y="1270" width="140" height="50" rx="7.5" ry="7.5" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 1295px; margin-left: 1651px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">nested</div></div></div></foreignObject><text x="1720" y="1299" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">nested</text></switch></g><path d="M 1920 1320 L 1920 1510 L 1919.9 1510 L 1919.92 1690.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1919.92 1695.88 L 1916.42 1688.88 L 1919.92 1690.63 L 1923.42 1688.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="1850" y="1270" width="140" height="50" rx="7.5" ry="7.5" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 1295px; margin-left: 1851px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">required</div></div></div></foreignObject><text x="1920" y="1299" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">required</text></switch></g><path d="M 1515 1640 L 1515 1670 L 1514.8 1670 L 1514.78 1695.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1514.77 1700.88 L 1511.28 1693.88 L 1514.78 1695.63 L 1518.28 1693.89 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 1345 1640 L 1345 1670 L 1344.7 1670 L 1344.68 1691.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1344.68 1696.88 L 1341.19 1689.88 L 1344.68 1691.63 L 1348.19 1689.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="1260" y="1350" width="340" height="290" rx="5.8" ry="5.8" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 338px; height: 1px; padding-top: 1357px; margin-left: 1261px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">suspend挂起当前事务<div><br /></div></div></div></div></foreignObject><text x="1430" y="1369" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">suspend挂起当前事务&#xa;</text></switch></g><rect x="1270" y="1400" width="320" height="80" rx="4.8" ry="4.8" fill="url(#mx-gradient-f5f5f5-1-b3b3b3-1-s-0)" stroke="#666666" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 318px; height: 1px; padding-top: 1407px; margin-left: 1272px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">doSuspend<br />移除transaction对象中的connectionHolder对象<br />解除TransactionSynchronizationManager绑定的资源，即当前线程绑定的connectionHolder对象并返回holder对象。<div><br /></div></div></div></div></foreignObject><text x="1272" y="1419" fill="#000000" font-family="Helvetica" font-size="12px">doSuspend...</text></switch></g><rect x="1270" y="1500" width="320" height="110" rx="6.6" ry="6.6" fill="url(#mx-gradient-f5f5f5-1-b3b3b3-1-s-0)" stroke="#666666" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 318px; height: 1px; padding-top: 1507px; margin-left: 1272px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">清除TransactionSynchronizationManager中部分属性信息如currentTransactionName<br />currentTransactionReadOnly<br />currentTransactionIsolationLevel<br />actualTransactionActive<br />然后构建SuspendedResourcesHolder对象，将返回的holder、name、readOnly等信息传入该对象，并返回</div></div></div></foreignObject><text x="1272" y="1519" fill="#000000" font-family="Helvetica" font-size="12px">清除TransactionSynchronizationManager中部分属性信息如currentTransactionNa...</text></switch></g><rect x="1260" y="1700" width="730" height="250" rx="10" ry="10" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 728px; height: 1px; padding-top: 1707px; margin-left: 1261px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">newTransactionStatus<br />根据传入参数构建DefaultTransactionStatus对象</div></div></div></foreignObject><text x="1625" y="1719" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">newTransactionStatus...</text></switch></g><rect x="1700" y="1750" width="250" height="70" rx="10.5" ry="10.5" fill="url(#mx-gradient-f5f5f5-1-b3b3b3-1-s-0)" stroke="#666666" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 248px; height: 1px; padding-top: 1757px; margin-left: 1702px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">not_supporte<br />transaction传入为null，即以非事物方式运行<br />newTransaction为false<br />有挂起对象<br /><br /></div></div></div></foreignObject><text x="1702" y="1769" fill="#000000" font-family="Helvetica" font-size="12px">not_supporte...</text></switch></g><path d="M 1300 1785 L 1100 1785 L 1100 1670 L 718.87 1670" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 713.62 1670 L 720.62 1666.5 L 718.87 1670 L 720.62 1673.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="1300" y="1750" width="250" height="70" rx="10.5" ry="10.5" fill="url(#mx-gradient-f5f5f5-1-b3b3b3-1-s-0)" stroke="#666666" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 248px; height: 1px; padding-top: 1757px; margin-left: 1302px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">requires_new<br />transaction传入当前事务对象<br />newTransaction为true<br />有挂起对象<br /></div></div></div></foreignObject><text x="1302" y="1769" fill="#000000" font-family="Helvetica" font-size="12px">requires_new...</text></switch></g><rect x="1300" y="1840" width="250" height="70" rx="10.5" ry="10.5" fill="url(#mx-gradient-f5f5f5-1-b3b3b3-1-s-0)" stroke="#666666" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 248px; height: 1px; padding-top: 1847px; margin-left: 1302px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">nested<br />transaction传入当前事务对象<br />newTransaction为false<br />无挂起对象</div></div></div></foreignObject><text x="1302" y="1859" fill="#000000" font-family="Helvetica" font-size="12px">nested...</text></switch></g><rect x="1700" y="1840" width="250" height="70" rx="10.5" ry="10.5" fill="url(#mx-gradient-f5f5f5-1-b3b3b3-1-s-0)" stroke="#666666" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 248px; height: 1px; padding-top: 1847px; margin-left: 1702px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">required<br />transaction传入当前事务对象<br />newTransaction为false<br />无挂起对象</div></div></div></foreignObject><text x="1702" y="1859" fill="#000000" font-family="Helvetica" font-size="12px">required...</text></switch></g><rect x="98.75" y="1810" width="612.5" height="140" rx="7" ry="7" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 611px; height: 1px; padding-top: 1817px; margin-left: 101px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">prepareSynchronization<br />1：设置事务激活状态<br />2：设置事务隔离级别<br />3：设置事务只读属性<br />4：设置当前事务名称<br />5：激活当前线程的事务同步。事务管理器在事务开始时调用。与事务回调有关。<br />TransactionSynchronizationManager.registerSynchronization(new TransactionSynchronizationAdapter() {}<br />自定义回调方法会在事务执行前后调用相关逻辑</div></div></div></foreignObject><text x="101" y="1829" fill="#ffffff" font-family="Helvetica" font-size="12px" font-weight="bold">prepareSynchronization...</text></switch></g><rect x="215" y="2200" width="380" height="130" rx="5.2" ry="5.2" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 378px; height: 1px; padding-top: 2207px; margin-left: 216px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">completeTransactionAfterThrowing<br /></div></div></div></foreignObject><text x="405" y="2219" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">completeTransactionAfterThrowing&#xa;</text></switch></g><path d="M 348.75 2290 L 348.8 2350 L 308.8 2350 L 308.76 2403.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 308.75 2408.88 L 305.26 2401.88 L 308.76 2403.63 L 312.26 2401.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 517.5 2265 L 1042.5 2265 L 1042.5 2353.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1042.5 2358.88 L 1039 2351.88 L 1042.5 2353.63 L 1046 2351.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="292.5" y="2240" width="225" height="50" rx="7.5" ry="7.5" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 223px; height: 1px; padding-top: 2265px; margin-left: 294px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">rollbackOn<br />判断回滚异常类型</div></div></div></foreignObject><text x="405" y="2269" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">rollbackOn...</text></switch></g><rect x="212.5" y="2410" width="385" height="180" rx="7.2" ry="7.2" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 383px; height: 1px; padding-top: 2417px; margin-left: 215px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">TM.rollback<br />1:triggerBeforeCompletion，事务执行前回调<br />2:如果存在Savepoint，执行rollbackToHeldSavepoint，没有标记connectionHolder的rollbackOnly 属性，即外部事物会继续提交。<br />3:如果是新事物，执行connection.rollback<br />4:如果是事务参与者，执行doSetRollbackOnly，该方法会从DefaultTransactionStatus中获取connectionHolder对象，设置对象的rollbackOnly属性为true。外层事务提交时，会查看该字段，如果weitrue，则会回滚事务。<br />5：triggerAfterCompletion，事务执行后回调<br />6：cleanupAfterCompletion，设置status对象completed为true，如果是新事务</div></div></div></foreignObject><text x="215" y="2429" fill="#000000" font-family="Helvetica" font-size="12px">TM.rollback...</text></switch></g><rect x="850" y="2360" width="385" height="180" rx="7.2" ry="7.2" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 383px; height: 1px; padding-top: 2367px; margin-left: 852px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">TM.commit<br />1：查看connectionHolder中rollbackOnly属性，如果是true，则执行rollback逻辑。<br />2：执行triggerBeforeCommit<br />3：triggerBeforeCompletion<br />4：如果是新事务connection.commit<br />5：triggerAfterCommit<br />6：triggerAfterCompletion<br />7：cleanupAfterCompletion，设置status对象completed为true，如果是新事务<br /></div></div></div></foreignObject><text x="852" y="2379" fill="#000000" font-family="Helvetica" font-size="12px">TM.commit...</text></switch></g><rect x="220" y="2360" width="80" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 2370px; margin-left: 221px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">符合回滚异常</div></div></div></foreignObject><text x="260" y="2374" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">符合回滚异常</text></switch></g><rect x="730" y="2240" width="110" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 2250px; margin-left: 731px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">不符合回滚异常</div></div></div></foreignObject><text x="785" y="2254" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">不符合回滚异常</text></switch></g><rect x="870" y="0" width="490" height="280" rx="11.2" ry="11.2" fill="#cce5ff" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 488px; height: 1px; padding-top: 7px; margin-left: 871px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">TransactionInfo</div></div></div></foreignObject><text x="1115" y="19" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">TransactionInfo</text></switch></g><rect x="1140" y="30" width="210" height="50" rx="7.5" ry="7.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 37px; margin-left: 1141px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">transactionAttribute<br />解析@Transaction注解获取的对象，包含注解里的一些信息</div></div></div></foreignObject><text x="1245" y="49" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">transactionAttribute...</text></switch></g><rect x="890" y="100" width="460" height="160" rx="24" ry="24" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 458px; height: 1px; padding-top: 107px; margin-left: 891px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">TransactionStatus</div></div></div></foreignObject><text x="1120" y="119" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">TransactionStatus</text></switch></g><rect x="900" y="130" width="215" height="120" rx="18" ry="18" fill="#ffcccc" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 213px; height: 1px; padding-top: 137px; margin-left: 901px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">DataSourceTransactionObject<br />方法中的transaction对象</div></div></div></foreignObject><text x="1008" y="149" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DataSourceTransactionObject...</text></switch></g><rect x="915" y="170" width="185" height="70" rx="10.5" ry="10.5" fill="#f9f7ed" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 183px; height: 1px; padding-top: 177px; margin-left: 916px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">ConnectionHolder<br />存放connection的对象</div></div></div></foreignObject><text x="1008" y="189" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">ConnectionHolder...</text></switch></g><rect x="1147.5" y="130" width="185" height="120" rx="18" ry="18" fill="#ffcccc" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 183px; height: 1px; padding-top: 137px; margin-left: 1149px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">SuspendedResourcesHolder</div></div></div></foreignObject><text x="1240" y="149" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">SuspendedResourcesHolder</text></switch></g><rect x="1167.5" y="170" width="145" height="70" rx="10.5" ry="10.5" fill="#f9f7ed" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 143px; height: 1px; padding-top: 177px; margin-left: 1169px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">ConnectionHolder<br />被挂起的ConnectionHolder</div></div></div></foreignObject><text x="1240" y="189" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">ConnectionHolder...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>