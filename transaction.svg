<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="2101px" height="2171px" viewBox="-0.5 -0.5 2101 2171" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2020-08-25T10:12:03.027Z&quot; agent=&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.6.2 Chrome/83.0.4103.122 Electron/9.2.0 Safari/537.36&quot; etag=&quot;7qs1xGP-6KZqeo5kidLG&quot; version=&quot;13.6.2&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;Y8oYmp99auzHq-wwUD1S&quot; name=&quot;第 1 页&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs><linearGradient x1="0%" y1="0%" x2="0%" y2="100%" id="mx-gradient-f5f5f5-1-b3b3b3-1-s-0"><stop offset="0%" style="stop-color:#f5f5f5"/><stop offset="100%" style="stop-color:#b3b3b3"/></linearGradient></defs><g><rect x="0" y="0" width="2100" height="2170" rx="42" ry="42" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 2098px; height: 1px; padding-top: 7px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 19px"><b>Transaction</b></font></div></div></div></foreignObject><text x="1050" y="19" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Transaction</text></switch></g><rect x="915" y="35" width="270" height="60" rx="9" ry="9" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 268px; height: 1px; padding-top: 65px; margin-left: 916px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">TransactionInterceptor<br />基于aop，代理对象进行方法拦截invokeWithinTransaction</div></div></div></foreignObject><text x="1050" y="69" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">TransactionInterceptor...</text></switch></g><rect x="20" y="170" width="2060" height="1990" rx="59.7" ry="59.7" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 2058px; height: 1px; padding-top: 177px; margin-left: 21px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">invokeWithinTransaction</div></div></div></foreignObject><text x="1050" y="193" fill="#000000" font-family="Helvetica" font-size="16px" text-anchor="middle" font-weight="bold">invokeWithinTransaction</text></switch></g><path d="M 563 270 L 563 290 L 563 280 L 563 293.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 563 298.88 L 559.5 291.88 L 563 293.63 L 566.5 291.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="440" y="230" width="246" height="40" rx="6" ry="6" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 244px; height: 1px; padding-top: 250px; margin-left: 441px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 12px">getTransactionAttributeSource<br />AnnotationTransactionAttributeSource</font></div></div></div></foreignObject><text x="563" y="255" fill="#000000" font-family="Helvetica" font-size="16px" text-anchor="middle">getTransactionAttributeSource...</text></switch></g><path d="M 563 340 L 563 360 L 563 350 L 563 363.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 563 368.88 L 559.5 361.88 L 563 363.63 L 566.5 361.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="440" y="300" width="246" height="40" rx="6" ry="6" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 244px; height: 1px; padding-top: 320px; margin-left: 441px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 12px">getTransactionAttribute<br />获取事务属性信息<br /></font></div></div></div></foreignObject><text x="563" y="325" fill="#000000" font-family="Helvetica" font-size="16px" text-anchor="middle">getTransactionAttribute...</text></switch></g><path d="M 563 410 L 563 440 L 1050 440 L 1050 463.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1050 468.88 L 1046.5 461.88 L 1050 463.63 L 1053.5 461.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="440" y="370" width="246" height="40" rx="6" ry="6" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 244px; height: 1px; padding-top: 390px; margin-left: 441px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">determineTransactionManager<br />获取TransactionManager</div></div></div></foreignObject><text x="563" y="394" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">determineTransactionManager...</text></switch></g><rect x="40" y="470" width="2020" height="1230" rx="24.6" ry="24.6" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 2018px; height: 1px; padding-top: 477px; margin-left: 41px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">createTransactionIfNecessary</div></div></div></foreignObject><text x="1050" y="489" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">createTransactionIfNecessary</text></switch></g><rect x="70" y="520" width="1970" height="1140" rx="22.8" ry="22.8" fill="#cce5ff" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1968px; height: 1px; padding-top: 527px; margin-left: 71px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">getTransaction</div></div></div></foreignObject><text x="1055" y="539" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">getTransaction</text></switch></g><path d="M 915 610 L 915 630 L 915 629 L 915 642.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 915 647.88 L 911.5 640.88 L 915 642.63 L 918.5 640.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="645" y="550" width="540" height="60" rx="9" ry="9" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 538px; height: 1px; padding-top: 557px; margin-left: 646px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">doGetTransaction<br />创建DataSourceTransactionObject对象，从TM里获取ConnectionHolder<br />ConnectionHolder是JDBC的connection包装类</div></div></div></foreignObject><text x="915" y="569" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">doGetTransaction...</text></switch></g><path d="M 680 689 L 635 689 L 635 763.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 635 768.88 L 631.5 761.88 L 635 763.63 L 638.5 761.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 1150 689 L 1505 689 L 1505 763.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1505 768.88 L 1501.5 761.88 L 1505 763.63 L 1508.5 761.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 915 649 L 1150 689 L 915 729 L 680 689 Z" fill="#a0522d" stroke="#6d1f00" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 468px; height: 1px; padding-top: 689px; margin-left: 681px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">判断当前是否已经有事务存在<br />holder是否存在，且事务属性transactionActive是否为true</div></div></div></foreignObject><text x="915" y="693" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">判断当前是否已经有事务存在&#xa;holder是否存在，且事务属性transactionActive是否为true</text></switch></g><path d="M 480 800 L 405 800 L 405 893.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 405 898.88 L 401.5 891.88 L 405 893.63 L 408.5 891.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="480" y="770" width="310" height="60" rx="9" ry="9" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 308px; height: 1px; padding-top: 777px; margin-left: 481px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">如果当前事物传播属性是MANDATORY<br />直接抛出异常，该属性的逻辑是支持当前事务，如果不存在抛出异常</div></div></div></foreignObject><text x="635" y="789" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">如果当前事物传播属性是MANDATORY...</text></switch></g><rect x="1000" y="770" width="1010" height="860" rx="17.2" ry="17.2" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1008px; height: 1px; padding-top: 777px; margin-left: 1001px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">handleExistingTransaction</div></div></div></foreignObject><text x="1505" y="789" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">handleExistingTransaction</text></switch></g><rect x="590" y="709" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 719px; margin-left: 591px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">否</div></div></div></foreignObject><text x="610" y="723" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">否</text></switch></g><rect x="1220" y="709" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 719px; margin-left: 1221px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">是</div></div></div></foreignObject><text x="1240" y="723" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">是</text></switch></g><path d="M 405 950 L 405 1013.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 405 1018.88 L 401.5 1011.88 L 405 1013.63 L 408.5 1011.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="280" y="900" width="250" height="50" rx="7.5" ry="7.5" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 248px; height: 1px; padding-top: 907px; margin-left: 281px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">REQUIRED||REQUIRES_NEW||NESTED<br />传播类型的事务执行suspend方法，传入参数为null，及挂起一个空事务</div></div></div></foreignObject><text x="405" y="919" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">REQUIRED||REQUIRES_NEW||NESTED...</text></switch></g><path d="M 405 1070 L 405 1173.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 405 1178.88 L 401.5 1171.88 L 405 1173.63 L 408.5 1171.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="280" y="1020" width="250" height="50" rx="7.5" ry="7.5" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 248px; height: 1px; padding-top: 1027px; margin-left: 281px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">newTransactionStatus<br />DefaultTransactionStatus</div></div></div></foreignObject><text x="405" y="1039" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">newTransactionStatus...</text></switch></g><path d="M 405 1280 L 405 1315 L 405.1 1315 L 405.1 1343.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 405.1 1348.88 L 401.6 1341.88 L 405.1 1343.63 L 408.6 1341.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="97.5" y="1180" width="615" height="100" rx="5" ry="5" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 613px; height: 1px; padding-top: 1187px; margin-left: 100px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">doBegin<br />1：如果connectionHolder不存在||synchronizedWithTransaction为true则从dataSource获取connection，且创建ConnectionHolder对象<br />2：设置synchronizedWithTransaction为true设置previousIsolationLevel<br />3：设置autoCommit属性为false，设置holder的transactionActive为true<br />4：如果是新的holder绑定当前dataSource和connectionHodler存入属性为resources的ThreadLocal中。<div><br /></div><div><br /></div></div></div></div></foreignObject><text x="100" y="1199" fill="#ffffff" font-family="Helvetica" font-size="12px" font-weight="bold">doBegin...</text></switch></g><rect x="1050" y="810" width="140" height="50" rx="7.5" ry="7.5" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 835px; margin-left: 1051px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">never<br />传播类型，直接抛出异常</div></div></div></foreignObject><text x="1120" y="839" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">never...</text></switch></g><path d="M 1295 860 L 1297.1 860 L 1297.07 884.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1297.06 889.75 L 1293.57 882.75 L 1297.07 884.5 L 1300.57 882.76 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="1260" y="810" width="140" height="50" rx="7.5" ry="7.5" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 835px; margin-left: 1261px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">not_supporte</div></div></div></foreignObject><text x="1330" y="839" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">not_supporte</text></switch></g><path d="M 1530 860 L 1527.9 860 L 1527.92 883.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1527.92 888.88 L 1524.41 881.88 L 1527.92 883.63 L 1531.41 881.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="1460" y="810" width="140" height="50" rx="7.5" ry="7.5" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 835px; margin-left: 1461px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">requires_new</div></div></div></foreignObject><text x="1530" y="839" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">requires_new</text></switch></g><path d="M 1720 860 L 1720 1050 L 1719.9 1050 L 1719.9 1233.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1719.9 1238.88 L 1716.4 1231.88 L 1719.9 1233.63 L 1723.4 1231.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="1650" y="810" width="140" height="50" rx="7.5" ry="7.5" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 835px; margin-left: 1651px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">nested</div></div></div></foreignObject><text x="1720" y="839" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">nested</text></switch></g><path d="M 1920 860 L 1920 1050 L 1919.9 1050 L 1919.92 1230.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1919.92 1235.88 L 1916.42 1228.88 L 1919.92 1230.63 L 1923.42 1228.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="1850" y="810" width="140" height="50" rx="7.5" ry="7.5" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 835px; margin-left: 1851px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">required</div></div></div></foreignObject><text x="1920" y="839" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">required</text></switch></g><path d="M 1515 1180 L 1515 1210 L 1514.8 1210 L 1514.78 1235.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1514.77 1240.88 L 1511.28 1233.88 L 1514.78 1235.63 L 1518.28 1233.89 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 1345 1180 L 1345 1210 L 1344.7 1210 L 1344.68 1231.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1344.68 1236.88 L 1341.19 1229.88 L 1344.68 1231.63 L 1348.19 1229.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="1260" y="890" width="340" height="290" rx="5.8" ry="5.8" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 338px; height: 1px; padding-top: 897px; margin-left: 1261px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">suspend挂起当前事务<div><br /></div></div></div></div></foreignObject><text x="1430" y="909" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">suspend挂起当前事务&#xa;</text></switch></g><rect x="1270" y="940" width="320" height="80" rx="4.8" ry="4.8" fill="url(#mx-gradient-f5f5f5-1-b3b3b3-1-s-0)" stroke="#666666" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 318px; height: 1px; padding-top: 947px; margin-left: 1272px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">doSuspend<br />移除transaction对象中的connectionHolder对象<br />解除TransactionSynchronizationManager绑定的资源，即当前线程绑定的connectionHolder对象并返回holder对象。<div><br /></div></div></div></div></foreignObject><text x="1272" y="959" fill="#000000" font-family="Helvetica" font-size="12px">doSuspend...</text></switch></g><rect x="1270" y="1040" width="320" height="110" rx="6.6" ry="6.6" fill="url(#mx-gradient-f5f5f5-1-b3b3b3-1-s-0)" stroke="#666666" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 318px; height: 1px; padding-top: 1047px; margin-left: 1272px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">清除TransactionSynchronizationManager中部分属性信息如currentTransactionName<br />currentTransactionReadOnly<br />currentTransactionIsolationLevel<br />actualTransactionActive<br />然后构建SuspendedResourcesHolder对象，将返回的holder、name、readOnly等信息传入该对象，并返回</div></div></div></foreignObject><text x="1272" y="1059" fill="#000000" font-family="Helvetica" font-size="12px">清除TransactionSynchronizationManager中部分属性信息如currentTransactionNa...</text></switch></g><rect x="1260" y="1240" width="730" height="250" rx="10" ry="10" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 728px; height: 1px; padding-top: 1247px; margin-left: 1261px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">newTransactionStatus<br />根据传入参数构建DefaultTransactionStatus对象</div></div></div></foreignObject><text x="1625" y="1259" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">newTransactionStatus...</text></switch></g><rect x="1700" y="1290" width="250" height="70" rx="10.5" ry="10.5" fill="url(#mx-gradient-f5f5f5-1-b3b3b3-1-s-0)" stroke="#666666" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 248px; height: 1px; padding-top: 1297px; margin-left: 1702px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">not_supporte<br />transaction传入为null，即以非事物方式运行<br />newTransaction为false<br />有挂起对象<br /><br /></div></div></div></foreignObject><text x="1702" y="1309" fill="#000000" font-family="Helvetica" font-size="12px">not_supporte...</text></switch></g><path d="M 1300 1325 L 1100 1325 L 1100 1210 L 718.87 1210" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 713.62 1210 L 720.62 1206.5 L 718.87 1210 L 720.62 1213.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="1300" y="1290" width="250" height="70" rx="10.5" ry="10.5" fill="url(#mx-gradient-f5f5f5-1-b3b3b3-1-s-0)" stroke="#666666" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 248px; height: 1px; padding-top: 1297px; margin-left: 1302px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">requires_new<br />transaction传入当前事务对象<br />newTransaction为true<br />有挂起对象<br /></div></div></div></foreignObject><text x="1302" y="1309" fill="#000000" font-family="Helvetica" font-size="12px">requires_new...</text></switch></g><rect x="1300" y="1380" width="250" height="70" rx="10.5" ry="10.5" fill="url(#mx-gradient-f5f5f5-1-b3b3b3-1-s-0)" stroke="#666666" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 248px; height: 1px; padding-top: 1387px; margin-left: 1302px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">nested<br />transaction传入当前事务对象<br />newTransaction为false<br />无挂起对象</div></div></div></foreignObject><text x="1302" y="1399" fill="#000000" font-family="Helvetica" font-size="12px">nested...</text></switch></g><rect x="1700" y="1380" width="250" height="70" rx="10.5" ry="10.5" fill="url(#mx-gradient-f5f5f5-1-b3b3b3-1-s-0)" stroke="#666666" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 248px; height: 1px; padding-top: 1387px; margin-left: 1702px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">required<br />transaction传入当前事务对象<br />newTransaction为false<br />无挂起对象</div></div></div></foreignObject><text x="1702" y="1399" fill="#000000" font-family="Helvetica" font-size="12px">required...</text></switch></g><rect x="98.75" y="1350" width="612.5" height="140" rx="7" ry="7" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 611px; height: 1px; padding-top: 1357px; margin-left: 101px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">prepareSynchronization<br />1：设置事务激活状态<br />2：设置事务隔离级别<br />3：设置事务只读属性<br />4：设置当前事务名称<br />5：激活当前线程的事务同步。事务管理器在事务开始时调用。与事务回调有关。<br />TransactionSynchronizationManager.registerSynchronization(new TransactionSynchronizationAdapter() {}<br />自定义回调方法会在事务执行前后调用相关逻辑</div></div></div></foreignObject><text x="101" y="1369" fill="#ffffff" font-family="Helvetica" font-size="12px" font-weight="bold">prepareSynchronization...</text></switch></g><rect x="215" y="1740" width="380" height="110" rx="4.4" ry="4.4" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 378px; height: 1px; padding-top: 1747px; margin-left: 216px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">completeTransactionAfterThrowing<br /></div></div></div></foreignObject><text x="405" y="1759" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">completeTransactionAfterThrowing&#xa;</text></switch></g><rect x="292.5" y="1770" width="225" height="50" rx="7.5" ry="7.5" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 223px; height: 1px; padding-top: 1795px; margin-left: 294px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">rollbackOn<br />判断回滚异常类型</div></div></div></foreignObject><text x="405" y="1799" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">rollbackOn...</text></switch></g><rect x="215" y="1900" width="385" height="180" rx="7.2" ry="7.2" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 383px; height: 1px; padding-top: 1907px; margin-left: 217px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">TM.rollback<br />1:triggerBeforeCompletion，事务执行前回调<br />2:如果存在Savepoint，执行rollbackToHeldSavepoint<br />3:如果是新事物，执行connection.rollback<br />4:如果是事务参与者，执行doSetRollbackOnly，该方法会从DefaultTransactionStatus中获取connectionHolder对象，设置对象的rollbackOnly属性为true。<br />5：triggerAfterCompletion，事务执行后回调<br />6：cleanupAfterCompletion，设置status对象completed为true，如果是新事务</div></div></div></foreignObject><text x="217" y="1919" fill="#000000" font-family="Helvetica" font-size="12px">TM.rollback...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>