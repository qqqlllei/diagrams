<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="4361px" height="4841px" viewBox="-0.5 -0.5 4361 4841" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2020-09-03T08:52:36.318Z&quot; agent=&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.6.2 Chrome/83.0.4103.122 Electron/9.2.0 Safari/537.36&quot; etag=&quot;5KltgpE7NUF1PsikL8OU&quot; version=&quot;13.6.2&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;ft8qHBVG7MIYmR1m9sZa&quot; name=&quot;第 1 页&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs><linearGradient x1="0%" y1="0%" x2="0%" y2="100%" id="mx-gradient-e6d0de-1-d5739d-1-s-0"><stop offset="0%" style="stop-color:#e6d0de"/><stop offset="100%" style="stop-color:#d5739d"/></linearGradient><linearGradient x1="0%" y1="0%" x2="0%" y2="100%" id="mx-gradient-d5e8d4-1-97d077-1-s-0"><stop offset="0%" style="stop-color:#d5e8d4"/><stop offset="100%" style="stop-color:#97d077"/></linearGradient><linearGradient x1="0%" y1="0%" x2="0%" y2="100%" id="mx-gradient-ffcd28-1-ffa500-1-s-0"><stop offset="0%" style="stop-color:#ffcd28"/><stop offset="100%" style="stop-color:#ffa500"/></linearGradient><linearGradient x1="0%" y1="0%" x2="0%" y2="100%" id="mx-gradient-fff2cc-1-ffd966-1-s-0"><stop offset="0%" style="stop-color:#fff2cc"/><stop offset="100%" style="stop-color:#ffd966"/></linearGradient></defs><g><rect x="0" y="0" width="4360" height="4840" rx="87.2" ry="87.2" fill="#e3c800" stroke="#b09500" pointer-events="all"/><path d="M 735 240 L 735 391.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 735 396.38 L 731.5 389.38 L 735 391.13 L 738.5 389.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="430" y="10" width="610" height="230" rx="6.9" ry="6.9" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 608px; height: 1px; padding-top: 17px; margin-left: 432px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">GlobalTransactionScanner<br />initClient初始化客户端<br />GlobalTransactionScanner实现了AbstractAutoProxyCreate<br />在创建类的时候，会对一些对象做特殊处理<br /><br /><br /><font style="font-size: 13px" color="#ffff00"><b>在执行isTccAutoProxy方法时，如果当前被解析的bean是远程接口如dubbo，sofa等，如果是服务端接口，且接口上带有@TwoPhaseBusinessAction注解，则会将该接口当成资源注册到TC上。如果是消费端类型，在其他bean引用该远程接口时，会给该对象添加上拦截器TccActionInterceptor，一般需要引用远程接口的类的方法上又会有@GlobalTransactional注解即全局事务的发起方。</b></font></div></div></div></foreignObject><text x="432" y="29" fill="#ffffff" font-family="Helvetica" font-size="12px">GlobalTransactionScanner...</text></switch></g><rect x="840" y="20" width="90" height="30" rx="4.5" ry="4.5" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 35px; margin-left: 841px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">RMClient.init</div></div></div></foreignObject><text x="885" y="39" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">RMClient.init</text></switch></g><rect x="940" y="20" width="90" height="30" rx="4.5" ry="4.5" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 35px; margin-left: 941px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">TMClient.init</div></div></div></foreignObject><text x="985" y="39" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">TMClient.init</text></switch></g><path d="M 735 487.5 L 735 563.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 735 568.88 L 731.5 561.88 L 735 563.63 L 738.5 561.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="580" y="397.5" width="310" height="90" rx="2.7" ry="2.7" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 308px; height: 1px; padding-top: 405px; margin-left: 582px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">对带有GlobalTransactional、GlobalLock注解的bean添加增强。增强类为GlobalTransactionalInterceptor，控制着全局事务，一旦带有注解的方便执行，则会进入GlobalTransactionalInterceptor的invoke方法。</div></div></div></foreignObject><text x="582" y="417" fill="#ffffff" font-family="Helvetica" font-size="12px">对带有GlobalTransactional、GlobalLock注解的bean添加增强。增强类为GlobalTransactiona...</text></switch></g><rect x="275" y="570" width="920" height="410" rx="8.2" ry="8.2" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 918px; height: 1px; padding-top: 577px; margin-left: 277px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">handleGlobalTransaction<br />1：getTransactionInfo获取事务信息，隔离级别，回滚规则等信息。<br />2：getCurrentOrCreate：获取全局事务，如果不存在就创建一个，如果是新创建的，则role为launcher及发起者。<br />3：根据隔离级别决定是否挂起当前事务。<br />4：beginTransaction，开始全局事务<br />5：执行自己的业务逻辑<br />6：根据是否发生异常决定是commit还是rollback<div><br /></div><div><br /></div></div></div></div></foreignObject><text x="277" y="589" fill="#ffffff" font-family="Helvetica" font-size="12px">handleGlobalTransaction...</text></switch></g><rect x="522" y="690" width="426" height="115" rx="3.45" ry="3.45" fill="#f8cecc" stroke="#b85450" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 424px; height: 1px; padding-top: 697px; margin-left: 524px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">beginTransaction<br />1：triggerBeforeBegin前置钩子函数<br />2：DefaultTransactionManager.begin，构建GlobalBeginRequest请求对象，同步调用server端，server会返回GlobalBeginResponse对象。接受server返回的xid，设置status为Begin。绑定xid到当前线程。<br />3：triggerAfterBegin后置钩子函数</div></div></div></foreignObject><text x="524" y="709" fill="#000000" font-family="Helvetica" font-size="12px">beginTransaction...</text></switch></g><rect x="520" y="840" width="428" height="90" rx="2.7" ry="2.7" fill="#f8cecc" stroke="#b85450" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 426px; height: 1px; padding-top: 847px; margin-left: 522px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">执行自己的业务的时候，就会调用远程服务了，远程调用会传递xid给全局事务参与者，在执行数据库相关操作的时候会被DataSourceProxy、ConnectionProxy、PreparedStatementProxy做相应拦截做特殊处理<div><br /></div></div></div></div></foreignObject><text x="522" y="859" fill="#000000" font-family="Helvetica" font-size="12px">执行自己的业务的时候，就会调用远程服务了，远程调用会传递xid给全局事务参与者，在执行数据库相关操作的时候会被DataSourceProxy、ConnectionProxy、PreparedStatementProxy做相应拦截做特殊处理&#xa;</text></switch></g><rect x="174" y="1240" width="1166" height="1030" rx="51.5" ry="51.5" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><path d="M 517.5 1310 L 517.5 1353.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 517.5 1358.88 L 514 1351.88 L 517.5 1353.63 L 521 1351.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="377.5" y="1260" width="280" height="50" rx="7.5" ry="7.5" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 278px; height: 1px; padding-top: 1267px; margin-left: 379px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">DataSourceProxy<br />调用getConnection返回ConnectionProxy</div></div></div></foreignObject><text x="518" y="1279" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DataSourceProxy...</text></switch></g><path d="M 517.5 1460 L 517.5 1503.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 517.5 1508.88 L 514 1501.88 L 517.5 1503.63 L 521 1501.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 705 1435 L 947.5 1435 L 947.5 1503.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 947.5 1508.88 L 944 1501.88 L 947.5 1503.63 L 951 1501.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="330" y="1360" width="375" height="100" rx="3" ry="3" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 373px; height: 1px; padding-top: 1410px; margin-left: 331px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">ConnectionProxy<br />prepareStatement方法创建PreparedStatementProxy对象，<font color="#cc0000"><b>（如果不是AT模式，则undolog相关的模块会跳过）</b></font>执行execute会调用ExecuteTemplate的execute方法，该方法会根据具体执行的sql语句构建不同的executor对象，最终执行executer的execute方法。</div></div></div></foreignObject><text x="518" y="1414" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">ConnectionProxy...</text></switch></g><rect x="800" y="1310" width="150" height="40" rx="6" ry="6" fill="url(#mx-gradient-e6d0de-1-d5739d-1-s-0)" stroke="#996185" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 1330px; margin-left: 801px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">InsertExecutor</div></div></div></foreignObject><text x="875" y="1334" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">InsertExecutor</text></switch></g><rect x="980" y="1310" width="150" height="40" rx="6" ry="6" fill="url(#mx-gradient-e6d0de-1-d5739d-1-s-0)" stroke="#996185" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 1330px; margin-left: 981px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">UpdateExecutor</div></div></div></foreignObject><text x="1055" y="1334" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">UpdateExecutor</text></switch></g><rect x="800" y="1370" width="150" height="40" rx="6" ry="6" fill="url(#mx-gradient-e6d0de-1-d5739d-1-s-0)" stroke="#996185" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 1390px; margin-left: 801px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">DeleteExecutor</div></div></div></foreignObject><text x="875" y="1394" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DeleteExecutor</text></switch></g><rect x="980" y="1370" width="150" height="40" rx="6" ry="6" fill="url(#mx-gradient-e6d0de-1-d5739d-1-s-0)" stroke="#996185" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 1390px; margin-left: 981px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">SelectForUpdateExecutor</div></div></div></foreignObject><text x="1055" y="1394" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">SelectForUpdateExecutor</text></switch></g><rect x="1151" y="1310" width="150" height="40" rx="6" ry="6" fill="url(#mx-gradient-e6d0de-1-d5739d-1-s-0)" stroke="#996185" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 1330px; margin-left: 1152px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">PlainExecutor</div></div></div></foreignObject><text x="1226" y="1334" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">PlainExecutor</text></switch></g><rect x="330" y="1510" width="375" height="240" rx="7.2" ry="7.2" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 373px; height: 1px; padding-top: 1517px; margin-left: 331px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">executeAutoCommitFalse</div></div></div></foreignObject><text x="518" y="1529" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">executeAutoCommitFalse</text></switch></g><rect x="426.25" y="1540" width="182.5" height="30" rx="4.5" ry="4.5" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 181px; height: 1px; padding-top: 1555px; margin-left: 427px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">beforeImage</div></div></div></foreignObject><text x="518" y="1559" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">beforeImage</text></switch></g><rect x="426.25" y="1600" width="182.5" height="30" rx="4.5" ry="4.5" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 181px; height: 1px; padding-top: 1615px; margin-left: 427px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">执行目标sql语句</div></div></div></foreignObject><text x="518" y="1619" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">执行目标sql语句</text></switch></g><rect x="426.25" y="1650" width="182.5" height="30" rx="4.5" ry="4.5" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 181px; height: 1px; padding-top: 1665px; margin-left: 427px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">afterImage</div></div></div></foreignObject><text x="518" y="1669" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">afterImage</text></switch></g><rect x="426.25" y="1700" width="182.5" height="30" rx="4.5" ry="4.5" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 181px; height: 1px; padding-top: 1715px; margin-left: 427px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">prepareUndoLog</div></div></div></foreignObject><text x="518" y="1719" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">prepareUndoLog</text></switch></g><rect x="200" y="1780" width="887.5" height="440" rx="13.2" ry="13.2" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 886px; height: 1px; padding-top: 1787px; margin-left: 201px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">doCommit</div></div></div></foreignObject><text x="644" y="1799" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">doCommit</text></switch></g><rect x="423.75" y="1820" width="440" height="390" rx="19.5" ry="19.5" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 438px; height: 1px; padding-top: 1827px; margin-left: 425px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">processGlobalTransactionCommit</div></div></div></foreignObject><text x="644" y="1839" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">processGlobalTransactionCommit</text></switch></g><rect x="514.69" y="1860" width="258.12" height="70" rx="10.5" ry="10.5" fill="url(#mx-gradient-ffcd28-1-ffa500-1-s-0)" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 256px; height: 1px; padding-top: 1867px; margin-left: 516px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">register<br />发送BranchRegisterRequest请求<br />返回branchId存储在ConnectionContext对象中</div></div></div></foreignObject><text x="644" y="1879" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">register...</text></switch></g><rect x="514.69" y="1950" width="258.12" height="40" rx="6" ry="6" fill="url(#mx-gradient-ffcd28-1-ffa500-1-s-0)" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 256px; height: 1px; padding-top: 1957px; margin-left: 516px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">flushUndoLogs<br />undoLogs入库</div></div></div></foreignObject><text x="644" y="1969" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">flushUndoLogs...</text></switch></g><rect x="514.69" y="2010" width="258.12" height="30" rx="4.5" ry="4.5" fill="url(#mx-gradient-ffcd28-1-ffa500-1-s-0)" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 256px; height: 1px; padding-top: 2017px; margin-left: 516px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">targetConnection.commit</div></div></div></foreignObject><text x="644" y="2029" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">targetConnection.commit</text></switch></g><rect x="514.69" y="2060" width="258.12" height="60" rx="9" ry="9" fill="url(#mx-gradient-ffcd28-1-ffa500-1-s-0)" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 256px; height: 1px; padding-top: 2067px; margin-left: 516px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">report<br />发送BranchReportRequest请求<br />上报分支事务第一阶段执行成功。</div></div></div></foreignObject><text x="644" y="2079" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">report...</text></switch></g><rect x="514.69" y="2140" width="258.12" height="60" rx="9" ry="9" fill="url(#mx-gradient-ffcd28-1-ffa500-1-s-0)" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 256px; height: 1px; padding-top: 2147px; margin-left: 516px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">reset<br />xid,branchId,lockKeysBuffer,<br />sqlUndoItemsBuffer属性置空</div></div></div></foreignObject><text x="644" y="2159" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">reset...</text></switch></g><rect x="60" y="2450" width="4250" height="2370" rx="47.4" ry="47.4" fill="#647687" stroke="#314354" pointer-events="all"/><path d="M 405.81 2642.99 L 405.8 2755 L 495 2755 L 495 2859.9" fill="none" stroke="#0066cc" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 495 2866.65 L 490.5 2857.65 L 495 2859.9 L 499.5 2857.65 Z" fill="#0066cc" stroke="#0066cc" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 277.5 2640 L 277.5 3815 L 639.9 3815" fill="none" stroke="#0066cc" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 646.65 3815 L 637.65 3819.5 L 639.9 3815 L 637.65 3810.5 Z" fill="#0066cc" stroke="#0066cc" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="160" y="2510" width="470" height="130" rx="15.6" ry="15.6" fill="#b1ddf0" stroke="#10739e" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 468px; height: 1px; padding-top: 2575px; margin-left: 161px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">TM</div></div></div></foreignObject><text x="395" y="2579" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">TM</text></switch></g><rect x="2010" y="2510" width="880" height="2300" rx="44" ry="44" fill="url(#mx-gradient-ffcd28-1-ffa500-1-s-0)" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 878px; height: 1px; padding-top: 2517px; margin-left: 2011px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 18px"><b>TC</b></font></div></div></div></foreignObject><text x="2450" y="2529" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">TC</text></switch></g><path d="M 495 3070 L 495 3350 L 579.9 3350" fill="none" stroke="#0066cc" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 586.65 3350 L 577.65 3354.5 L 579.9 3350 L 577.65 3345.5 Z" fill="#0066cc" stroke="#0066cc" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="290" y="2870" width="410" height="200" rx="12" ry="12" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 408px; height: 1px; padding-top: 2877px; margin-left: 292px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">RM</div></div></div></foreignObject><text x="292" y="2889" fill="#000000" font-family="Helvetica" font-size="12px">RM</text></switch></g><path d="M 330 2945 C 330 2936.72 347.91 2930 370 2930 C 380.61 2930 390.78 2931.58 398.28 2934.39 C 405.79 2937.21 410 2941.02 410 2945 L 410 2975 C 410 2983.28 392.09 2990 370 2990 C 347.91 2990 330 2983.28 330 2975 Z" fill="#ffff88" stroke="#36393d" stroke-miterlimit="10" pointer-events="all"/><path d="M 410 2945 C 410 2953.28 392.09 2960 370 2960 C 347.91 2960 330 2953.28 330 2945" fill="none" stroke="#36393d" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 2960px; margin-left: 331px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><br /><br />DB</div></div></div></foreignObject><text x="370" y="2964" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DB...</text></switch></g><rect x="395" y="2730" width="75" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 2740px; margin-left: 396px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">远程调用</div></div></div></foreignObject><text x="433" y="2744" fill="#FFFF00" font-family="Helvetica" font-size="12px" text-anchor="middle">远程调用</text></switch></g><rect x="650" y="3680" width="350" height="180" rx="27" ry="27" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 348px; height: 1px; padding-top: 3770px; margin-left: 651px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">RM</div></div></div></foreignObject><text x="825" y="3774" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">RM</text></switch></g><rect x="200" y="3130" width="75" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 3140px; margin-left: 201px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">远程调用</div></div></div></foreignObject><text x="238" y="3144" fill="#FFFF00" font-family="Helvetica" font-size="12px" text-anchor="middle">远程调用</text></switch></g><path d="M 850 3305 L 2001.66 3305.79" fill="none" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" stroke-dasharray="9 9" pointer-events="stroke"/><path d="M 2008.41 3305.8 L 1999.4 3310.29 L 2001.66 3305.79 L 1999.41 3301.29 Z" fill="#cc0000" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="590" y="3260" width="260" height="180" rx="5.4" ry="5.4" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 258px; height: 1px; padding-top: 3267px; margin-left: 592px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">RM</div></div></div></foreignObject><text x="592" y="3279" fill="#000000" font-family="Helvetica" font-size="12px">RM</text></switch></g><rect x="499" y="3120" width="75" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 3130px; margin-left: 500px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">远程调用</div></div></div></foreignObject><text x="537" y="3134" fill="#FFFF00" font-family="Helvetica" font-size="12px" text-anchor="middle">远程调用</text></switch></g><path d="M 598 3386.5 C 598 3378.22 615.91 3371.5 638 3371.5 C 648.61 3371.5 658.78 3373.08 666.28 3375.89 C 673.79 3378.71 678 3382.52 678 3386.5 L 678 3416.5 C 678 3424.78 660.09 3431.5 638 3431.5 C 615.91 3431.5 598 3424.78 598 3416.5 Z" fill="#ffff88" stroke="#36393d" stroke-miterlimit="10" pointer-events="all"/><path d="M 678 3386.5 C 678 3394.78 660.09 3401.5 638 3401.5 C 615.91 3401.5 598 3394.78 598 3386.5" fill="none" stroke="#36393d" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 3402px; margin-left: 599px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><br /><br />DB</div></div></div></foreignObject><text x="638" y="3405" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DB...</text></switch></g><path d="M 670 3805 C 670 3796.72 687.91 3790 710 3790 C 720.61 3790 730.78 3791.58 738.28 3794.39 C 745.79 3797.21 750 3801.02 750 3805 L 750 3835 C 750 3843.28 732.09 3850 710 3850 C 687.91 3850 670 3843.28 670 3835 Z" fill="#ffff88" stroke="#36393d" stroke-miterlimit="10" pointer-events="all"/><path d="M 750 3805 C 750 3813.28 732.09 3820 710 3820 C 687.91 3820 670 3813.28 670 3805" fill="none" stroke="#36393d" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 3820px; margin-left: 671px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><br /><br />DB</div></div></div></foreignObject><text x="710" y="3824" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DB...</text></switch></g><rect x="740" y="2880" width="92.5" height="30" rx="4.5" ry="4.5" fill="url(#mx-gradient-fff2cc-1-ffd966-1-s-0)" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 91px; height: 1px; padding-top: 2887px; margin-left: 742px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">branchRegister</div></div></div></foreignObject><text x="742" y="2899" fill="#000000" font-family="Helvetica" font-size="12px">branchRegister</text></switch></g><path d="M 560 2960 L 418.24 2960" fill="none" stroke="#ffff00" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 412.24 2960 L 420.24 2956 L 418.24 2960 L 420.24 2964 Z" fill="#ffff00" stroke="#ffff00" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="560" y="2940" width="118" height="40" rx="6" ry="6" fill="#cce5ff" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 116px; height: 1px; padding-top: 2947px; margin-left: 562px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">存储undoLog到数据库，执行目标sql到库</div></div></div></foreignObject><text x="562" y="2959" fill="#000000" font-family="Helvetica" font-size="12px">存储undoLog到数据库，执行目标sql到库</text></switch></g><path d="M 991.88 3240 L 991.9 2585 L 613.1 2585" fill="none" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" stroke-dasharray="9 9" pointer-events="stroke"/><path d="M 606.35 2585 L 615.35 2580.5 L 613.1 2585 L 615.35 2589.5 Z" fill="#cc0000" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="863.75" y="3240" width="256.25" height="50" rx="7.5" ry="7.5" fill="url(#mx-gradient-fff2cc-1-ffd966-1-s-0)" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 254px; height: 1px; padding-top: 3265px; margin-left: 865px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">branchRegister超时或者有RuntimeException，整体不一致，TM需要执行rollback逻辑</div></div></div></foreignObject><text x="992" y="3269" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">branchRegister超时或者有RuntimeException，整体不一致，TM需要执行rollback逻辑</text></switch></g><rect x="470" y="2570" width="133" height="60" rx="9" ry="9" fill="#f8cecc" stroke="#b85450" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 131px; height: 1px; padding-top: 2577px; margin-left: 472px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">catch到异常，发送GlobalRollbackRequest请求。</div></div></div></foreignObject><text x="472" y="2589" fill="#000000" font-family="Helvetica" font-size="12px">catch到异常，发送GlobalRollbackReq...</text></switch></g><path d="M 490 3030 L 370 3030 L 370 3000.1" fill="none" stroke="#ffff00" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 370 2993.35 L 374.5 3002.35 L 370 3000.1 L 365.5 3002.35 Z" fill="#ffff00" stroke="#ffff00" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="490" y="3010" width="198" height="40" rx="6" ry="6" fill="#cce5ff" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 196px; height: 1px; padding-top: 3017px; margin-left: 492px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">客户端执行undo操作，将数据还原为全局事务之前的状态。删除undolog</div></div></div></foreignObject><text x="492" y="3029" fill="#000000" font-family="Helvetica" font-size="12px">客户端执行undo操作，将数据还原为全局事务之前的状态。删除undolog</text></switch></g><rect x="2085" y="2550" width="680" height="1350" rx="6.8" ry="6.8" fill="#f8cecc" stroke="#b85450" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 678px; height: 1px; padding-top: 2557px; margin-left: 2086px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 13px"><b>DefaultCoordinator</b></font></div></div></div></foreignObject><text x="2425" y="2569" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DefaultCoordinator</text></switch></g><path d="M 2745 2662.5 L 2745 2658 L 3213 2658 L 3671.76 2657.51" fill="none" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 3677.76 2657.5 L 3669.77 2661.51 L 3671.76 2657.51 L 3669.76 2653.51 Z" fill="#66cc00" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="2135" y="2610" width="610" height="210" rx="31.5" ry="31.5" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 608px; height: 1px; padding-top: 2617px; margin-left: 2136px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">doGlobalBegin</div></div></div></foreignObject><text x="2440" y="2629" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">doGlobalBegin</text></switch></g><rect x="2155" y="2640" width="570" height="160" rx="11.2" ry="11.2" fill="#e3c800" stroke="#b09500" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 568px; height: 1px; padding-top: 2647px; margin-left: 2157px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">DefaultCore.begin<br /><ol><li>GlobalSession.createGlobalSession创建全局事务session</li><li>添加session生命周期监听器，类型为SessionManager的监听器，如果使用的存储时DB,则监听器为DataBaseSessionManager。</li><li>GlobalSession执行begin，开启全局事务。设置status为begin，设置开始时间属性，调用生命周期监听器的onBegin方法即此时会执行DataBaseSessinoManage的insertGlobalTransactionDO方法，将globalSession存储到DB中。</li><li>发送全局事务开始事件GlobalTransactionEvent</li><li>返回全局事务的xid到TM</li></ol></div></div></div></foreignObject><text x="2157" y="2659" fill="#000000" font-family="Helvetica" font-size="12px">DefaultCore.begin...</text></switch></g><path d="M 2745 2953.75 L 3157.5 2953.8 L 3157.5 2955 L 3561.76 2955" fill="none" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 3567.76 2955 L 3559.76 2959 L 3561.76 2955 L 3559.76 2951 Z" fill="#66cc00" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><path d="M 2745 3071.25 L 3210 3071.3 L 3210 3262.5 L 3666.76 3262.5" fill="none" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 3672.76 3262.5 L 3664.76 3266.5 L 3666.76 3262.5 L 3664.76 3258.5 Z" fill="#66cc00" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="2135" y="2895" width="610" height="235" rx="35.25" ry="35.25" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 608px; height: 1px; padding-top: 2902px; margin-left: 2136px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">doBranchRegister</div></div></div></foreignObject><text x="2440" y="2914" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">doBranchRegister</text></switch></g><rect x="2155" y="2930" width="570" height="180" rx="12.6" ry="12.6" fill="#e3c800" stroke="#b09500" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 568px; height: 1px; padding-top: 2937px; margin-left: 2157px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">branchRegister<br /><ol><li>获取根据xId获取GlobalSession</li><li>检查GlobalSession的状态</li><li>添加生命周期监听器</li><li>创建branchSession，设置xid，transactionId，branchId，branchType，resourceId，lockKeys</li><li>AT模式下branchSessionLock，分支加锁，行级锁。在lock_table中加入记录，pk为处理中记录的主键，只有加锁成功才会继续执行。</li><li>globalSession.addBranch,分支事务落库，设置branchSession状态为registered，添加branchSession到属性集合branchSessions中。</li><li>返回branchSession的branchId。</li></ol></div></div></div></foreignObject><text x="2157" y="2949" fill="#000000" font-family="Helvetica" font-size="12px">branchRegister...</text></switch></g><rect x="2135" y="3190" width="610" height="160" rx="24" ry="24" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 608px; height: 1px; padding-top: 3197px; margin-left: 2136px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">doBranchReport(默认不发送该类型消息)</div></div></div></foreignObject><text x="2440" y="3209" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">doBranchReport(默认不发送该类型消息)</text></switch></g><rect x="2155" y="3220" width="570" height="110" rx="7.7" ry="7.7" fill="#e3c800" stroke="#b09500" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 568px; height: 1px; padding-top: 3227px; margin-left: 2157px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">branchReport<br /><ol><li>获取globalSession，且globalSession包含branchSession信息。</li><li>根据分支branchId从globalSession中获取branchSession</li><li>添加生命周期监听器</li><li>更新branchSession状态为PhaseOne_Done,库中状态同步更新。</li></ol></div></div></div></foreignObject><text x="2157" y="3239" fill="#000000" font-family="Helvetica" font-size="12px">branchReport...</text></switch></g><rect x="2135" y="3420" width="610" height="180" rx="27" ry="27" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 608px; height: 1px; padding-top: 3427px; margin-left: 2136px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">doGlobalCommit</div></div></div></foreignObject><text x="2440" y="3439" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">doGlobalCommit</text></switch></g><rect x="2155" y="3450" width="570" height="120" rx="8.4" ry="8.4" fill="#e3c800" stroke="#b09500" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 568px; height: 1px; padding-top: 3457px; margin-left: 2157px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">commit<br /><ol><li>根据xid获取globalSession</li><li>添加生命周期监听器</li><li>设置globalSession的active属性为false，释放所有branchSession的锁</li><li>更改globalSession的状态为committing</li><li>如果是AT模式异步提交全局事务</li><li>返回全局事务提交状态</li></ol></div></div></div></foreignObject><text x="2157" y="3469" fill="#000000" font-family="Helvetica" font-size="12px">commit...</text></switch></g><path d="M 2135 3765 L 1260 3765 L 1260 3030 L 698.1 3030" fill="none" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" stroke-dasharray="9 9" pointer-events="stroke"/><path d="M 691.35 3030 L 700.35 3025.5 L 698.1 3030 L 700.35 3034.5 Z" fill="#cc0000" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="2135" y="3660" width="610" height="210" rx="31.5" ry="31.5" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 608px; height: 1px; padding-top: 3667px; margin-left: 2136px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">doGlobalRollback</div></div></div></foreignObject><text x="2440" y="3679" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">doGlobalRollback</text></switch></g><rect x="2155" y="3690" width="570" height="150" rx="10.5" ry="10.5" fill="#e3c800" stroke="#b09500" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 568px; height: 1px; padding-top: 3697px; margin-left: 2157px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">rollback<br /><ol><li>根据xid获取globalSession</li><li>添加生命周期监听器</li><li>设置globalSession的active属性为false<br /></li><li>设置globalSession的状态为rollbacking</li><li>发送branchRollbackRequest</li><li>根据RM返回phaseTwo_Rollbacked 状态，服务端执行removeBranch</li><li>根据branchSession删除DB中branch记录，删除lock记录，删除内存中globalSession的branchSession</li></ol></div></div></div></foreignObject><text x="2157" y="3709" fill="#000000" font-family="Helvetica" font-size="12px">rollback...</text></switch></g><path d="M 630 2575 L 2440 2575 L 2440 2599.9" fill="none" stroke="#66cc00" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2440 2606.65 L 2435.5 2597.65 L 2440 2599.9 L 2444.5 2597.65 Z" fill="#66cc00" stroke="#66cc00" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 700 2920 L 1418 2920 L 1418 2953.75 L 2124.9 2953.75" fill="none" stroke="#66cc00" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2131.65 2953.75 L 2122.65 2958.25 L 2124.9 2953.75 L 2122.65 2949.25 Z" fill="#66cc00" stroke="#66cc00" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 2133 3010 L 1405.5 3010 L 1405.5 2960 L 688.1 2960" fill="none" stroke="#66cc00" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 681.35 2960 L 690.35 2955.5 L 688.1 2960 L 690.35 2964.5 Z" fill="#66cc00" stroke="#66cc00" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 569.75 2630 L 569.8 2690 L 1330 2690 L 1330 3712.5 L 2124.9 3712.5" fill="none" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" stroke-dasharray="9 9" pointer-events="stroke"/><path d="M 2131.65 3712.5 L 2122.65 3717 L 2124.9 3712.5 L 2122.65 3708 Z" fill="#cc0000" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 638.5 3050 L 638.5 3090 L 1180 3090 L 1180 3817.5 L 2124.9 3817.5" fill="none" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" stroke-dasharray="9 9" pointer-events="stroke"/><path d="M 2131.65 3817.5 L 2122.65 3822 L 2124.9 3817.5 L 2122.65 3813 Z" fill="#cc0000" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="1248.5" cy="2551.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2552px; margin-left: 1231px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">1</div></div></div></foreignObject><text x="1249" y="2560" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">1</text></switch></g><ellipse cx="1419.5" cy="2628.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2629px; margin-left: 1402px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">2</div></div></div></foreignObject><text x="1420" y="2637" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">2</text></switch></g><ellipse cx="518.5" cy="2797.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2798px; margin-left: 501px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">3</div></div></div></foreignObject><text x="519" y="2806" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">3</text></switch></g><ellipse cx="1028.5" cy="2818.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2819px; margin-left: 1011px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">8</div></div></div></foreignObject><text x="1029" y="2827" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">8</text></switch></g><ellipse cx="1358.5" cy="2801.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2802px; margin-left: 1341px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">9</div></div></div></foreignObject><text x="1359" y="2810" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">9</text></switch></g><ellipse cx="1178.5" cy="2895" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2895px; margin-left: 1161px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">4</div></div></div></foreignObject><text x="1179" y="2903" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">4</text></switch></g><ellipse cx="1188.5" cy="2971.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2972px; margin-left: 1171px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">5</div></div></div></foreignObject><text x="1189" y="2980" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">5</text></switch></g><ellipse cx="1258.5" cy="3148.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 3149px; margin-left: 1241px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 25px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">10</div></div></div></foreignObject><text x="1259" y="3156" fill="#CC0000" font-family="Helvetica" font-size="25px" text-anchor="middle">10</text></switch></g><ellipse cx="533.19" cy="3201.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 3202px; margin-left: 516px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">6</div></div></div></foreignObject><text x="533" y="3210" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">6</text></switch></g><ellipse cx="991.5" cy="3331.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 3332px; margin-left: 974px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">7</div></div></div></foreignObject><text x="992" y="3340" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">7</text></switch></g><ellipse cx="1208.5" cy="3510" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 3510px; margin-left: 1191px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 25px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">11</div></div></div></foreignObject><text x="1209" y="3518" fill="#CC0000" font-family="Helvetica" font-size="25px" text-anchor="middle">11</text></switch></g><path d="M 2135 2662.5 L 1382.5 2662.5 L 1382.5 2624 L 641.98 2624.01" fill="none" stroke="#66cc00" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 635.23 2624.01 L 644.23 2619.51 L 641.98 2624.01 L 644.23 2628.51 Z" fill="#66cc00" stroke="#66cc00" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="670" y="2660" width="62.5" height="60" fill="none" stroke="none" pointer-events="all"/><path d="M 695.25 2679.66 C 697.36 2678.47 699.45 2678.07 701.53 2678.09 C 709.9 2678.42 714.02 2685.64 713.35 2690.55 L 705.27 2690.55 L 715.03 2701.53 L 724.79 2690.55 L 718.25 2690.55 C 718.53 2680.57 710.49 2673.76 701.77 2673.49 C 698.64 2673.33 694.98 2674.31 691.98 2676.06 Z M 677.68 2689.5 L 684.19 2689.5 C 684.28 2697.56 689.17 2702.41 693.83 2704.48 C 699.73 2707.35 705.99 2706.2 710.47 2703.56 L 707.17 2699.86 C 705.94 2700.64 704.3 2701.17 702.19 2701.42 C 694.14 2701.85 688.92 2695.86 688.99 2689.5 L 697.09 2689.5 L 687.37 2678.08 Z M 701.33 2720 C 683.65 2720 670 2705.65 670 2691.16 C 670 2672.84 684.03 2660 701.55 2660 C 719.93 2660 732.5 2675.02 732.5 2689.37 C 732.5 2708.2 717.1 2720 701.33 2720 Z" fill="#ffff00" stroke="none" pointer-events="all"/><rect x="2083.13" y="4000" width="683.75" height="780" rx="13.68" ry="13.68" fill="#ffcccc" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 682px; height: 1px; padding-top: 4007px; margin-left: 2085px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 25px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">定时JOB</div></div></div></foreignObject><text x="2085" y="4032" fill="#000000" font-family="Helvetica" font-size="25px">定时JOB</text></switch></g><path d="M 2677.5 4105 L 2677.5 4100 L 2780 4100 L 2780 3765 L 2755.1 3765" fill="none" stroke="#67ab9f" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2748.35 3765 L 2757.35 3760.5 L 2755.1 3765 L 2757.35 3769.5 Z" fill="#67ab9f" stroke="#67ab9f" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="2172.5" y="4050" width="505" height="110" rx="7.7" ry="7.7" fill="#cce5ff" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 503px; height: 1px; padding-top: 4057px; margin-left: 2175px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">handleRetryRollbacking--定时重拾回滚任务<br /><ol><li>获取状态为RollbackRetrying、Rollbacking、TimeoutRollbacking、TimeoutRollbackRetrying的所有globalSession</li><li>检查globalSession的状态，如果是rollbacking且还没有重试超时，跳过</li><li>检查是否重试超时，如果超时删除globalSession，默认一直重试</li><li>调用doGlobalRollback</li></ol></div></div></div></foreignObject><text x="2175" y="4069" fill="#000000" font-family="Helvetica" font-size="12px">handleRetryRollbacking--定时重拾回滚任务...</text></switch></g><rect x="2690" y="4030" width="62.5" height="60" fill="none" stroke="none" pointer-events="all"/><path d="M 2715.25 4049.66 C 2717.36 4048.47 2719.45 4048.07 2721.53 4048.09 C 2729.9 4048.42 2734.02 4055.64 2733.35 4060.55 L 2725.27 4060.55 L 2735.03 4071.53 L 2744.79 4060.55 L 2738.25 4060.55 C 2738.53 4050.57 2730.49 4043.76 2721.77 4043.49 C 2718.64 4043.33 2714.98 4044.31 2711.98 4046.06 Z M 2697.68 4059.5 L 2704.19 4059.5 C 2704.28 4067.56 2709.17 4072.41 2713.83 4074.48 C 2719.73 4077.35 2725.99 4076.2 2730.47 4073.56 L 2727.17 4069.86 C 2725.94 4070.64 2724.3 4071.17 2722.19 4071.42 C 2714.14 4071.85 2708.92 4065.86 2708.99 4059.5 L 2717.09 4059.5 L 2707.37 4048.08 Z M 2721.33 4090 C 2703.65 4090 2690 4075.65 2690 4061.16 C 2690 4042.84 2704.03 4030 2721.55 4030 C 2739.93 4030 2752.5 4045.02 2752.5 4059.37 C 2752.5 4078.2 2737.1 4090 2721.33 4090 Z" fill="#97d077" stroke="none" pointer-events="all"/><path d="M 2677.51 4240 L 2810 4240 L 2810 3510 L 2755.1 3510" fill="none" stroke="#67ab9f" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2748.35 3510 L 2757.35 3505.5 L 2755.1 3510 L 2757.35 3514.5 Z" fill="#67ab9f" stroke="#67ab9f" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="2172.51" y="4190" width="505" height="100" rx="7" ry="7" fill="#cce5ff" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 503px; height: 1px; padding-top: 4197px; margin-left: 2175px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">handleRetryCommitting--定时重拾提交任务<br /><ol><li>获取状态为CommitRetrying的所有globalSession</li><li>检擦是否重拾超时，如果超时删除globalSession</li><li>调用doGlobalCommit</li></ol></div></div></div></foreignObject><text x="2175" y="4209" fill="#000000" font-family="Helvetica" font-size="12px">handleRetryCommitting--定时重拾提交任务...</text></switch></g><rect x="2690" y="4170" width="62.5" height="60" fill="none" stroke="none" pointer-events="all"/><path d="M 2715.25 4189.66 C 2717.36 4188.47 2719.45 4188.07 2721.53 4188.09 C 2729.9 4188.42 2734.02 4195.64 2733.35 4200.55 L 2725.27 4200.55 L 2735.03 4211.53 L 2744.79 4200.55 L 2738.25 4200.55 C 2738.53 4190.57 2730.49 4183.76 2721.77 4183.49 C 2718.64 4183.33 2714.98 4184.31 2711.98 4186.06 Z M 2697.68 4199.5 L 2704.19 4199.5 C 2704.28 4207.56 2709.17 4212.41 2713.83 4214.48 C 2719.73 4217.35 2725.99 4216.2 2730.47 4213.56 L 2727.17 4209.86 C 2725.94 4210.64 2724.3 4211.17 2722.19 4211.42 C 2714.14 4211.85 2708.92 4205.86 2708.99 4199.5 L 2717.09 4199.5 L 2707.37 4188.08 Z M 2721.33 4230 C 2703.65 4230 2690 4215.65 2690 4201.16 C 2690 4182.84 2704.03 4170 2721.55 4170 C 2739.93 4170 2752.5 4185.02 2752.5 4199.37 C 2752.5 4218.2 2737.1 4230 2721.33 4230 Z" fill="#97d077" stroke="none" pointer-events="all"/><path d="M 2677.51 4370 L 2840 4370 L 2840 3465 L 2755.1 3465" fill="none" stroke="#67ab9f" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2748.35 3465 L 2757.35 3460.5 L 2755.1 3465 L 2757.35 3469.5 Z" fill="#67ab9f" stroke="#67ab9f" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="2172.51" y="4320" width="505" height="100" rx="7" ry="7" fill="#cce5ff" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 503px; height: 1px; padding-top: 4327px; margin-left: 2175px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">handleAsyncCommitting--定时异步提交任务，AT模式的事务<br /><ol><li>获取状态为AsyncCommitting的所有globalSession</li><li>调用doGlobalCommit</li></ol></div></div></div></foreignObject><text x="2175" y="4339" fill="#000000" font-family="Helvetica" font-size="12px">handleAsyncCommitting--定时异步提交任务，AT模式的事务...</text></switch></g><rect x="2690" y="4300" width="62.5" height="60" fill="none" stroke="none" pointer-events="all"/><path d="M 2715.25 4319.66 C 2717.36 4318.47 2719.45 4318.07 2721.53 4318.09 C 2729.9 4318.42 2734.02 4325.64 2733.35 4330.55 L 2725.27 4330.55 L 2735.03 4341.53 L 2744.79 4330.55 L 2738.25 4330.55 C 2738.53 4320.57 2730.49 4313.76 2721.77 4313.49 C 2718.64 4313.33 2714.98 4314.31 2711.98 4316.06 Z M 2697.68 4329.5 L 2704.19 4329.5 C 2704.28 4337.56 2709.17 4342.41 2713.83 4344.48 C 2719.73 4347.35 2725.99 4346.2 2730.47 4343.56 L 2727.17 4339.86 C 2725.94 4340.64 2724.3 4341.17 2722.19 4341.42 C 2714.14 4341.85 2708.92 4335.86 2708.99 4329.5 L 2717.09 4329.5 L 2707.37 4318.08 Z M 2721.33 4360 C 2703.65 4360 2690 4345.65 2690 4331.16 C 2690 4312.84 2704.03 4300 2721.55 4300 C 2739.93 4300 2752.5 4315.02 2752.5 4329.37 C 2752.5 4348.2 2737.1 4360 2721.33 4360 Z" fill="#97d077" stroke="none" pointer-events="all"/><rect x="2172.51" y="4460" width="505" height="90" rx="6.3" ry="6.3" fill="#cce5ff" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 503px; height: 1px; padding-top: 4467px; margin-left: 2175px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">timeoutCheck--定时超时检查<br /><ol><li>获取所有globalSession</li><li>如果状态不是Begin，或者没有超时的globalSession跳过</li><li>globalSession的active为false，状态变更为TimeoutRollBacking</li></ol></div></div></div></foreignObject><text x="2175" y="4479" fill="#000000" font-family="Helvetica" font-size="12px">timeoutCheck--定时超时检查...</text></switch></g><path d="M 2172.51 4640 L 825 4640 L 825 3870.1" fill="none" stroke="#67ab9f" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 825 3863.35 L 829.5 3872.35 L 825 3870.1 L 820.5 3872.35 Z" fill="#67ab9f" stroke="#67ab9f" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="2172.51" y="4600" width="505" height="80" rx="5.6" ry="5.6" fill="#cce5ff" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 503px; height: 1px; padding-top: 4607px; margin-left: 2175px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">undoLogDelete--定时定时删除undolog记录<br /><ol><li>向RM发送UndoLogDeleteRequest请求，请求中带有saveDays参数，默认是7天，及记录默认最多保留七天。</li></ol></div></div></div></foreignObject><text x="2175" y="4619" fill="#000000" font-family="Helvetica" font-size="12px">undoLogDelete--定时定时删除undolog记录...</text></switch></g><rect x="2600" y="4470" width="62.5" height="60" fill="none" stroke="none" pointer-events="all"/><path d="M 2625.25 4489.66 C 2627.36 4488.47 2629.45 4488.07 2631.53 4488.09 C 2639.9 4488.42 2644.02 4495.64 2643.35 4500.55 L 2635.27 4500.55 L 2645.03 4511.53 L 2654.79 4500.55 L 2648.25 4500.55 C 2648.53 4490.57 2640.49 4483.76 2631.77 4483.49 C 2628.64 4483.33 2624.98 4484.31 2621.98 4486.06 Z M 2607.68 4499.5 L 2614.19 4499.5 C 2614.28 4507.56 2619.17 4512.41 2623.83 4514.48 C 2629.73 4517.35 2635.99 4516.2 2640.47 4513.56 L 2637.17 4509.86 C 2635.94 4510.64 2634.3 4511.17 2632.19 4511.42 C 2624.14 4511.85 2618.92 4505.86 2618.99 4499.5 L 2627.09 4499.5 L 2617.37 4488.08 Z M 2631.33 4530 C 2613.65 4530 2600 4515.65 2600 4501.16 C 2600 4482.84 2614.03 4470 2631.55 4470 C 2649.93 4470 2662.5 4485.02 2662.5 4499.37 C 2662.5 4518.2 2647.1 4530 2631.33 4530 Z" fill="#97d077" stroke="none" pointer-events="all"/><rect x="2100" y="4570" width="62.5" height="60" fill="none" stroke="none" pointer-events="all"/><path d="M 2125.25 4589.66 C 2127.36 4588.47 2129.45 4588.07 2131.53 4588.09 C 2139.9 4588.42 2144.02 4595.64 2143.35 4600.55 L 2135.27 4600.55 L 2145.03 4611.53 L 2154.79 4600.55 L 2148.25 4600.55 C 2148.53 4590.57 2140.49 4583.76 2131.77 4583.49 C 2128.64 4583.33 2124.98 4584.31 2121.98 4586.06 Z M 2107.68 4599.5 L 2114.19 4599.5 C 2114.28 4607.56 2119.17 4612.41 2123.83 4614.48 C 2129.73 4617.35 2135.99 4616.2 2140.47 4613.56 L 2137.17 4609.86 C 2135.94 4610.64 2134.3 4611.17 2132.19 4611.42 C 2124.14 4611.85 2118.92 4605.86 2118.99 4599.5 L 2127.09 4599.5 L 2117.37 4588.08 Z M 2131.33 4630 C 2113.65 4630 2100 4615.65 2100 4601.16 C 2100 4582.84 2114.03 4570 2131.55 4570 C 2149.93 4570 2162.5 4585.02 2162.5 4599.37 C 2162.5 4618.2 2147.1 4630 2131.33 4630 Z" fill="#97d077" stroke="none" pointer-events="all"/><path d="M 820 3820 L 760.1 3820" fill="none" stroke="#ffff00" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 753.35 3820 L 762.35 3815.5 L 760.1 3820 L 762.35 3824.5 Z" fill="#ffff00" stroke="#ffff00" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="820" y="3785" width="168" height="70" rx="10.5" ry="10.5" fill="#cce5ff" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 166px; height: 1px; padding-top: 3792px; margin-left: 822px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">接受到server端的删除请求，以保留天数为参数执行删除语句，默认一次请求最多删除3000条</div></div></div></foreignObject><text x="822" y="3804" fill="#000000" font-family="Helvetica" font-size="12px">接受到server端的删除请求，以保留天数为参数执行删除语句，默认一次请求最多删除3000条</text></switch></g><rect x="960" y="2470" width="210" height="60" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 2500px; margin-left: 961px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 28px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">AT</div></div></div></foreignObject><text x="1065" y="2508" fill="#FFFF00" font-family="Helvetica" font-size="28px" text-anchor="middle" font-weight="bold">AT</text></switch></g><rect x="3165" y="2450" width="220" height="80" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 2490px; margin-left: 3166px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 28px; font-family: Helvetica; color: #FFB570; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">TCC</div></div></div></foreignObject><text x="3275" y="2498" fill="#FFB570" font-family="Helvetica" font-size="28px" text-anchor="middle" font-weight="bold">TCC</text></switch></g><path d="M 3768.75 2625 L 3768.8 2580 L 2592.5 2580 L 2592.5 2601.76" fill="none" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2592.5 2607.76 L 2588.5 2599.76 L 2592.5 2601.76 L 2596.5 2599.76 Z" fill="#66cc00" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><path d="M 3946.25 2755 L 3946.3 2822.5 L 3918.8 2822.5 L 3918.76 2878.03" fill="none" stroke="#66cc00" stroke-width="4" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 3918.75 2885.53 L 3913.76 2875.52 L 3918.76 2878.03 L 3923.76 2875.53 Z" fill="#66cc00" stroke="#66cc00" stroke-width="4" stroke-miterlimit="10" pointer-events="all"/><path d="M 4035 2690 L 4080 2690 L 4080 3262.5 L 4046.97 3262.5" fill="none" stroke="#66cc00" stroke-width="4" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 4039.47 3262.5 L 4049.47 3257.5 L 4046.97 3262.5 L 4049.47 3267.5 Z" fill="#66cc00" stroke="#66cc00" stroke-width="4" stroke-miterlimit="10" pointer-events="all"/><path d="M 4035 2657.5 L 4160 2657.5 L 4160 3555 L 2756.97 3555" fill="none" stroke="#66cc00" stroke-width="4" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2749.47 3555 L 2759.47 3550 L 2756.97 3555 L 2759.47 3560 Z" fill="#66cc00" stroke="#66cc00" stroke-width="4" stroke-miterlimit="10" pointer-events="all"/><rect x="3680" y="2625" width="355" height="130" rx="15.6" ry="15.6" fill="#b1ddf0" stroke="#10739e" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 353px; height: 1px; padding-top: 2690px; margin-left: 3681px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">TM</div></div></div></foreignObject><text x="3858" y="2694" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">TM</text></switch></g><ellipse cx="3384.5" cy="2548.5" rx="18.5" ry="18.5" fill="#0000cc" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2549px; margin-left: 3367px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#ffffff">1</font></div></div></div></foreignObject><text x="3385" y="2557" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">1</text></switch></g><ellipse cx="3458.5" cy="2628.5" rx="18.5" ry="18.5" fill="#0000cc" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2629px; margin-left: 3441px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#ffffff">2</font></div></div></div></foreignObject><text x="3459" y="2637" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">2</text></switch></g><path d="M 3686.25 2890 L 3686.3 2860 L 2592.5 2860 L 2592.5 2886.76" fill="none" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2592.5 2892.76 L 2588.5 2884.76 L 2592.5 2886.76 L 2596.5 2884.76 Z" fill="#66cc00" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="3570" y="2890" width="465" height="130" rx="7.8" ry="7.8" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 463px; height: 1px; padding-top: 2897px; margin-left: 3572px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">RM</div></div></div></foreignObject><text x="3572" y="2909" fill="#000000" font-family="Helvetica" font-size="12px">RM</text></switch></g><rect x="3560" y="2630" width="70" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 68px; height: 1px; padding-top: 2640px; margin-left: 3561px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">返回xid</div></div></div></foreignObject><text x="3595" y="2645" fill="#FFFF00" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">返回xid</text></switch></g><rect x="3545" y="2550" width="100" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 2560px; margin-left: 3546px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">开启全局事务</div></div></div></foreignObject><text x="3595" y="2565" fill="#FFFF00" font-family="Helvetica" font-size="15px" text-anchor="middle">开启全局事务</text></switch></g><rect x="3960" y="2796" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 2806px; margin-left: 3961px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #FFB570; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#ffff00">RPC</font></div></div></div></foreignObject><text x="3980" y="2811" fill="#FFB570" font-family="Helvetica" font-size="15px" text-anchor="middle">RPC</text></switch></g><ellipse cx="3908.5" cy="2788.5" rx="18.5" ry="18.5" fill="#0000cc" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2789px; margin-left: 3891px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#ffffff">3</font></div></div></div></foreignObject><text x="3909" y="2797" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">3</text></switch></g><ellipse cx="3508.5" cy="2838.5" rx="18.5" ry="18.5" fill="#0000cc" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2839px; margin-left: 3491px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#ffffff">4</font></div></div></div></foreignObject><text x="3509" y="2847" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">4</text></switch></g><rect x="3610" y="2837" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 2847px; margin-left: 3611px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">branchRegister</div></div></div></foreignObject><text x="3630" y="2852" fill="#FFFF00" font-family="Helvetica" font-size="15px" text-anchor="middle">branc...</text></switch></g><ellipse cx="3288.5" cy="2921.5" rx="18.5" ry="18.5" fill="#0000cc" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2922px; margin-left: 3271px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#ffffff">5</font></div></div></div></foreignObject><text x="3289" y="2930" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">5</text></switch></g><rect x="3325" y="2910" width="120" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 2920px; margin-left: 3326px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">返回branchID</div></div></div></foreignObject><text x="3385" y="2925" fill="#FFFF00" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">返回branchID</text></switch></g><path d="M 3765 3230 L 3765 3043.1 L 2753.24 3043.05" fill="none" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2747.24 3043.05 L 2755.24 3039.05 L 2753.24 3043.05 L 2755.24 3047.05 Z" fill="#66cc00" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="4108.5" cy="3171.5" rx="18.5" ry="18.5" fill="#0000cc" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 3172px; margin-left: 4091px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#ffffff">6</font></div></div></div></foreignObject><text x="4109" y="3180" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">6</text></switch></g><rect x="4025.5" y="3161.5" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 3172px; margin-left: 4027px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #FFB570; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#ffff00">RPC</font></div></div></div></foreignObject><text x="4046" y="3176" fill="#FFB570" font-family="Helvetica" font-size="15px" text-anchor="middle">RPC</text></switch></g><ellipse cx="3428.5" cy="3070" rx="18.5" ry="18.5" fill="#0000cc" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 3070px; margin-left: 3411px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#ffffff">7</font></div></div></div></foreignObject><text x="3429" y="3078" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">7</text></switch></g><rect x="3505" y="3060" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 3070px; margin-left: 3506px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">branchRegister</div></div></div></foreignObject><text x="3525" y="3075" fill="#FFFF00" font-family="Helvetica" font-size="15px" text-anchor="middle">branc...</text></switch></g><ellipse cx="3378.5" cy="3228.5" rx="18.5" ry="18.5" fill="#0000cc" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 3229px; margin-left: 3361px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#ffffff">8</font></div></div></div></foreignObject><text x="3379" y="3237" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">8</text></switch></g><rect x="3470" y="3227" width="120" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 3237px; margin-left: 3471px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">返回branchID</div></div></div></foreignObject><text x="3530" y="3242" fill="#FFFF00" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">返回branchID</text></switch></g><path d="M 3810 2985.75 L 3810 3456 L 2753.24 3456" fill="none" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2747.24 3456 L 2755.24 3452 L 2753.24 3456 L 2755.24 3460 Z" fill="#66cc00" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="3770" y="2935.75" width="80" height="50" rx="7.5" ry="7.5" fill="#b1ddf0" stroke="#10739e" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 2961px; margin-left: 3771px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">confirm</div></div></div></foreignObject><text x="3810" y="2964" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">confirm</text></switch></g><rect x="3900" y="2935.75" width="80" height="50" rx="7.5" ry="7.5" fill="#b1ddf0" stroke="#10739e" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 2961px; margin-left: 3901px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span>cancel</span></div></div></div></div></foreignObject><text x="3940" y="2964" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">cancel</text></switch></g><rect x="3628" y="2935.75" width="86" height="48.5" rx="7.27" ry="7.27" fill="#b1ddf0" stroke="#10739e" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 84px; height: 1px; padding-top: 2960px; margin-left: 3629px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span>try</span></div></div></div></div></foreignObject><text x="3671" y="2964" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">try</text></switch></g><ellipse cx="4128.5" cy="3430" rx="18.5" ry="18.5" fill="#0000cc" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 3430px; margin-left: 4111px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#ffffff">9</font></div></div></div></foreignObject><text x="4129" y="3438" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">9</text></switch></g><rect x="4058.5" y="3450" width="100" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 3460px; margin-left: 4060px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">提交全局事务</div></div></div></foreignObject><text x="4109" y="3465" fill="#FFFF00" font-family="Helvetica" font-size="15px" text-anchor="middle">提交全局事务</text></switch></g><path d="M 2745 3440 L 3780 3440 L 3780 2994.24" fill="none" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 3780 2988.24 L 3784 2996.24 L 3780 2994.24 L 3776 2996.24 Z" fill="#66cc00" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="3675" y="3230" width="360" height="130" rx="7.8" ry="7.8" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 358px; height: 1px; padding-top: 3237px; margin-left: 3677px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">RM</div></div></div></foreignObject><text x="3677" y="3249" fill="#000000" font-family="Helvetica" font-size="12px">RM</text></switch></g><rect x="3714" y="3270.75" width="86" height="48.5" rx="7.27" ry="7.27" fill="#b1ddf0" stroke="#10739e" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 84px; height: 1px; padding-top: 3295px; margin-left: 3715px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span>try</span></div></div></div></div></foreignObject><text x="3757" y="3299" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">try</text></switch></g><path d="M 2745 3490.02 L 3833 3490 L 3833.04 3327.24" fill="none" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 3833.04 3321.24 L 3837.04 3329.24 L 3833.04 3327.24 L 3829.04 3329.24 Z" fill="#66cc00" stroke="#66cc00" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="3820" y="3270" width="80" height="50" rx="7.5" ry="7.5" fill="#b1ddf0" stroke="#10739e" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 3295px; margin-left: 3821px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">confirm</div></div></div></foreignObject><text x="3860" y="3299" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">confirm</text></switch></g><rect x="3920" y="3270" width="80" height="50" rx="7.5" ry="7.5" fill="#b1ddf0" stroke="#10739e" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 3295px; margin-left: 3921px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><span>cancel</span></div></div></div></div></foreignObject><text x="3960" y="3299" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">cancel</text></switch></g><ellipse cx="3426.5" cy="3411.5" rx="18.5" ry="18.5" fill="#0000cc" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 3412px; margin-left: 3409px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#ffffff">10</font></div></div></div></foreignObject><text x="3427" y="3420" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">10</text></switch></g><rect x="3463.5" y="3401.5" width="133" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 131px; height: 1px; padding-top: 3412px; margin-left: 3465px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">branchCommit</div></div></div></foreignObject><text x="3530" y="3416" fill="#FFFF00" font-family="Helvetica" font-size="15px" text-anchor="middle">branchCommit</text></switch></g><ellipse cx="3831.5" cy="3091.5" rx="18.5" ry="18.5" fill="#0000cc" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 3092px; margin-left: 3814px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#ffffff">11</font></div></div></div></foreignObject><text x="3832" y="3100" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">11</text></switch></g><rect x="3800" y="3117" width="133" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 131px; height: 1px; padding-top: 3127px; margin-left: 3801px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">branchStatus</div></div></div></foreignObject><text x="3867" y="3132" fill="#FFFF00" font-family="Helvetica" font-size="15px" text-anchor="middle">branchStatus</text></switch></g><ellipse cx="3860" cy="3421.5" rx="18.5" ry="18.5" fill="#0000cc" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 3422px; margin-left: 3843px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#ffffff">12</font></div></div></div></foreignObject><text x="3860" y="3430" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">12</text></switch></g><rect x="3873.5" y="3411.5" width="133" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 131px; height: 1px; padding-top: 3422px; margin-left: 3875px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">branchCommit</div></div></div></foreignObject><text x="3940" y="3426" fill="#FFFF00" font-family="Helvetica" font-size="15px" text-anchor="middle">branchCommit</text></switch></g><rect x="3000" y="3627" width="380" height="88.5" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 372px; height: 1px; padding-top: 3617px; margin-left: 3004px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 99px; overflow: hidden; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><h1><font color="#ea6b66">Try阶段</font></h1><p style="text-align: left"><span style="line-height: 100%">try阶段方法一般是预留资源的，将要变更的数据提前保护起来，例如冻结金额，锁定库存等。</span></p></div></div></div></foreignObject><text x="3190" y="3629" fill="#FFFF00" font-family="Helvetica" font-size="12px" text-anchor="middle">Try阶段...</text></switch></g><rect x="3420" y="3627" width="380" height="88.5" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 372px; height: 1px; padding-top: 3617px; margin-left: 3424px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 99px; overflow: hidden; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><h1><font color="#ea6b66">Confirm阶段</font></h1><div>该阶段一般是对预留资源的处理，正向提交业务逻辑，如将扣减冻结金额，扣减库存等。</div></div></div></div></foreignObject><text x="3610" y="3629" fill="#FFFF00" font-family="Helvetica" font-size="12px" text-anchor="middle">Confirm阶段...</text></switch></g><rect x="3830" y="3627" width="380" height="88.5" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 372px; height: 1px; padding-top: 3617px; margin-left: 3834px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 99px; overflow: hidden; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><h1><font color="#ea6b66">Cancel阶段</font></h1><div>该阶段也是对预留资源的处理，反向提交业务逻辑，如将冻结金额恢复，库存恢复等。</div><div><br /></div></div></div></div></foreignObject><text x="4020" y="3629" fill="#FFFF00" font-family="Helvetica" font-size="12px" text-anchor="middle">Cancel阶段...</text></switch></g><rect x="3165.5" y="3820" width="860" height="200" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 852px; height: 1px; padding-top: 3810px; margin-left: 3171px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 210px; overflow: hidden; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><h1>                     <font color="#ea6b66">注意事项</font></h1></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><div style="font-size: 13px"><ol><li>空回滚：在try还没执行完或者执行失败的情况下，执行了cancel方法，所以cancel方式需要识别出是否是空回归，如果是直接返回成功。</li><li>幂等：TC端可能会重复调用confirm和cancel。可以添加一个事务记录表，记录已经处理的事务。</li><li>悬挂：二阶段的cancel已经执行，try阶段才执行，那么资源就会一直被预留即为悬挂，为了解决这个问题，在二阶段处理时，如果是空回滚，那么就在事务记录表中加入一条状态为已回滚的记录，try阶段提交时发现是已经执行过cancel后就不再执行try。</li></ol></div><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><div style="font-size: 13px"><div>                                        <font style="font-size: 24px" color="#ea6b66"><b>可优化事项</b></font></div></div></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><div style="font-size: 13px"><font style="font-size: 13px">由于try阶段已经预留资源，则其他操作不会对该资源进行处理，那么confirm和cancel的执行可以异步处理。提升业务的并发性。</font></div></blockquote><div><br /></div></div></div></div></foreignObject><text x="3171" y="3822" fill="#FFFF00" font-family="Helvetica" font-size="12px">注意事项...</text></switch></g><rect x="4127" y="3043" width="62.5" height="60" fill="none" stroke="none" pointer-events="all"/><path d="M 4152.25 3062.66 C 4154.36 3061.47 4156.45 3061.07 4158.53 3061.09 C 4166.9 3061.42 4171.02 3068.64 4170.35 3073.55 L 4162.27 3073.55 L 4172.03 3084.53 L 4181.79 3073.55 L 4175.25 3073.55 C 4175.53 3063.57 4167.49 3056.76 4158.77 3056.49 C 4155.64 3056.33 4151.98 3057.31 4148.98 3059.06 Z M 4134.68 3072.5 L 4141.19 3072.5 C 4141.28 3080.56 4146.17 3085.41 4150.83 3087.48 C 4156.73 3090.35 4162.99 3089.2 4167.47 3086.56 L 4164.17 3082.86 C 4162.94 3083.64 4161.3 3084.17 4159.19 3084.42 C 4151.14 3084.85 4145.92 3078.86 4145.99 3072.5 L 4154.09 3072.5 L 4144.37 3061.08 Z M 4158.33 3103 C 4140.65 3103 4127 3088.65 4127 3074.16 C 4127 3055.84 4141.03 3043 4158.55 3043 C 4176.93 3043 4189.5 3058.02 4189.5 3072.37 C 4189.5 3091.2 4174.1 3103 4158.33 3103 Z" fill="#ffff00" stroke="none" pointer-events="all"/><rect x="644.25" y="3296.5" width="181.5" height="70" rx="10.5" ry="10.5" fill="#cce5ff" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 180px; height: 1px; padding-top: 3304px; margin-left: 646px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">如果是二阶段提交，那么会插入带删除队列AsyncWorker，异步删除undolog</div></div></div></foreignObject><text x="646" y="3316" fill="#000000" font-family="Helvetica" font-size="12px">如果是二阶段提交，那么会插入带删除队列AsyncWorker，异步删除undolog</text></switch></g><rect x="760" y="1510" width="375" height="190" rx="5.7" ry="5.7" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 373px; height: 1px; padding-top: 1517px; margin-left: 761px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">processLocalCommitWithGlobalLocks<br />被@GlobalLock标记的方法且是对数据库的写操作<div><br /></div></div></div></div></foreignObject><text x="948" y="1529" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">processLocalCommitWithGlobalLocks...</text></switch></g><rect x="820.62" y="1570" width="253.75" height="90" rx="13.5" ry="13.5" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 252px; height: 1px; padding-top: 1615px; margin-left: 822px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">checkLock<br />发送GlobalLockQueryRequest<br />请求，server端会根据lockKeys从lock_table表中查询记录，如果查询到，且xid不同，则证明已经被其他全局事务锁定，则当前本地事务就不能提交了</div></div></div></foreignObject><text x="947" y="1619" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">checkLock...</text></switch></g><rect x="948" y="1450" width="122" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 120px; height: 1px; padding-top: 1465px; margin-left: 949px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">@GlobalLock</div></div></div></foreignObject><text x="1009" y="1470" fill="#FFFF00" font-family="Helvetica" font-size="16px" text-anchor="middle" font-weight="bold">@GlobalLock</text></switch></g><rect x="494.69" y="1470" width="255.31" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 253px; height: 1px; padding-top: 1485px; margin-left: 496px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">@GlobalTransactional</div></div></div></foreignObject><text x="622" y="1490" fill="#FFFF00" font-family="Helvetica" font-size="16px" text-anchor="middle" font-weight="bold">@GlobalTransactional</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>