<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="2961px" height="3887px" viewBox="-0.5 -0.5 2961 3887" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2020-09-01T03:10:34.926Z&quot; agent=&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.6.2 Chrome/83.0.4103.122 Electron/9.2.0 Safari/537.36&quot; etag=&quot;EcVEcO95Zq1aYRIkdUxs&quot; version=&quot;13.6.2&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;ft8qHBVG7MIYmR1m9sZa&quot; name=&quot;第 1 页&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs><linearGradient x1="0%" y1="0%" x2="0%" y2="100%" id="mx-gradient-e6d0de-1-d5739d-1-s-0"><stop offset="0%" style="stop-color:#e6d0de"/><stop offset="100%" style="stop-color:#d5739d"/></linearGradient><linearGradient x1="0%" y1="0%" x2="0%" y2="100%" id="mx-gradient-d5e8d4-1-97d077-1-s-0"><stop offset="0%" style="stop-color:#d5e8d4"/><stop offset="100%" style="stop-color:#97d077"/></linearGradient><linearGradient x1="0%" y1="0%" x2="0%" y2="100%" id="mx-gradient-ffcd28-1-ffa500-1-s-0"><stop offset="0%" style="stop-color:#ffcd28"/><stop offset="100%" style="stop-color:#ffa500"/></linearGradient><linearGradient x1="0%" y1="0%" x2="0%" y2="100%" id="mx-gradient-fff2cc-1-ffd966-1-s-0"><stop offset="0%" style="stop-color:#fff2cc"/><stop offset="100%" style="stop-color:#ffd966"/></linearGradient></defs><g><rect x="0" y="0" width="2960" height="3886" rx="59.2" ry="59.2" fill="#e3c800" stroke="#b09500" pointer-events="all"/><path d="M 675 166 L 675 227.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 675 232.38 L 671.5 225.38 L 675 227.13 L 678.5 225.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="520" y="76" width="310" height="90" rx="2.7" ry="2.7" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 308px; height: 1px; padding-top: 83px; margin-left: 522px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">GlobalTransactionScanner<br />initClient初始化客户端</div></div></div></foreignObject><text x="522" y="95" fill="#ffffff" font-family="Helvetica" font-size="12px">GlobalTransactionScanner...</text></switch></g><rect x="720" y="126" width="90" height="30" rx="4.5" ry="4.5" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 141px; margin-left: 721px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">RMClient.init</div></div></div></foreignObject><text x="765" y="145" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">RMClient.init</text></switch></g><rect x="720" y="86" width="90" height="30" rx="4.5" ry="4.5" fill="#a0522d" stroke="#6d1f00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 101px; margin-left: 721px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">TMClient.init</div></div></div></foreignObject><text x="765" y="105" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">TMClient.init</text></switch></g><path d="M 675 323.5 L 675 399.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 675 404.88 L 671.5 397.88 L 675 399.63 L 678.5 397.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="520" y="233.5" width="310" height="90" rx="2.7" ry="2.7" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 308px; height: 1px; padding-top: 241px; margin-left: 522px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">对带有GlobalTransactional、GlobalLock注解的bean添加增强。增强类为GlobalTransactionalInterceptor，控制着全局事务，一旦带有注解的方便执行，则会进入GlobalTransactionalInterceptor的invoke方法。</div></div></div></foreignObject><text x="522" y="253" fill="#ffffff" font-family="Helvetica" font-size="12px">对带有GlobalTransactional、GlobalLock注解的bean添加增强。增强类为GlobalTransactiona...</text></switch></g><rect x="215" y="406" width="920" height="410" rx="8.2" ry="8.2" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 918px; height: 1px; padding-top: 413px; margin-left: 217px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">handleGlobalTransaction<br />1：getTransactionInfo获取事务信息，隔离级别，回滚规则等信息。<br />2：getCurrentOrCreate：获取全局事务，如果不存在就创建一个，如果是新创建的，则role为launcher及发起者。<br />3：根据隔离级别决定是否挂起当前事务。<br />4：beginTransaction，开始全局事务<br />5：执行自己的业务逻辑<br />6：根据是否发生异常决定是commit还是rollback<div><br /></div><div><br /></div></div></div></div></foreignObject><text x="217" y="425" fill="#ffffff" font-family="Helvetica" font-size="12px">handleGlobalTransaction...</text></switch></g><rect x="462" y="526" width="426" height="115" rx="3.45" ry="3.45" fill="#f8cecc" stroke="#b85450" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 424px; height: 1px; padding-top: 533px; margin-left: 464px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">beginTransaction<br />1：triggerBeforeBegin前置钩子函数<br />2：DefaultTransactionManager.begin，构建GlobalBeginRequest请求对象，同步调用server端，server会返回GlobalBeginResponse对象。接受server返回的xid，设置status为Begin。绑定xid到当前线程。<br />3：triggerAfterBegin后置钩子函数</div></div></div></foreignObject><text x="464" y="545" fill="#000000" font-family="Helvetica" font-size="12px">beginTransaction...</text></switch></g><rect x="460" y="676" width="428" height="90" rx="2.7" ry="2.7" fill="#f8cecc" stroke="#b85450" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 426px; height: 1px; padding-top: 683px; margin-left: 462px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">执行自己的业务的时候，就会调用远程服务了，远程调用会传递xid给全局事务参与者，在执行数据库相关操作的时候会被DataSourceProxy、ConnectionProxy、PreparedStatementProxy做相应拦截做特殊处理<div><br /></div></div></div></div></foreignObject><text x="462" y="695" fill="#000000" font-family="Helvetica" font-size="12px">执行自己的业务的时候，就会调用远程服务了，远程调用会传递xid给全局事务参与者，在执行数据库相关操作的时候会被DataSourceProxy、ConnectionProxy、PreparedStatementProxy做相应拦截做特殊处理&#xa;</text></switch></g><rect x="114" y="1076" width="1166" height="1030" rx="51.5" ry="51.5" fill="#6d8764" stroke="#3a5431" pointer-events="all"/><path d="M 457.5 1146 L 457.5 1189.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 457.5 1194.88 L 454 1187.88 L 457.5 1189.63 L 461 1187.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="317.5" y="1096" width="280" height="50" rx="7.5" ry="7.5" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 278px; height: 1px; padding-top: 1103px; margin-left: 319px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">DataSourceProxy<br />调用getConnection返回ConnectionProxy</div></div></div></foreignObject><text x="458" y="1115" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DataSourceProxy...</text></switch></g><path d="M 457.5 1296 L 457.5 1339.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 457.5 1344.88 L 454 1337.88 L 457.5 1339.63 L 461 1337.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="270" y="1196" width="375" height="100" rx="3" ry="3" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 373px; height: 1px; padding-top: 1246px; margin-left: 271px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">ConnectionProxy<br />prepareStatement方法创建PreparedStatementProxy对象，执行execute会调用ExecuteTemplate的execute方法，该方法会根据具体执行的sql语句构建不同的executor对象，最终执行executer的execute方法。</div></div></div></foreignObject><text x="458" y="1250" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">ConnectionProxy...</text></switch></g><rect x="740" y="1146" width="150" height="40" rx="6" ry="6" fill="url(#mx-gradient-e6d0de-1-d5739d-1-s-0)" stroke="#996185" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 1166px; margin-left: 741px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">InsertExecutor</div></div></div></foreignObject><text x="815" y="1170" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">InsertExecutor</text></switch></g><rect x="920" y="1146" width="150" height="40" rx="6" ry="6" fill="url(#mx-gradient-e6d0de-1-d5739d-1-s-0)" stroke="#996185" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 1166px; margin-left: 921px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">UpdateExecutor</div></div></div></foreignObject><text x="995" y="1170" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">UpdateExecutor</text></switch></g><rect x="740" y="1206" width="150" height="40" rx="6" ry="6" fill="url(#mx-gradient-e6d0de-1-d5739d-1-s-0)" stroke="#996185" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 1226px; margin-left: 741px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">DeleteExecutor</div></div></div></foreignObject><text x="815" y="1230" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DeleteExecutor</text></switch></g><rect x="920" y="1206" width="150" height="40" rx="6" ry="6" fill="url(#mx-gradient-e6d0de-1-d5739d-1-s-0)" stroke="#996185" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 1226px; margin-left: 921px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">SelectForUpdateExecutor</div></div></div></foreignObject><text x="995" y="1230" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">SelectForUpdateExecutor</text></switch></g><rect x="1091" y="1146" width="150" height="40" rx="6" ry="6" fill="url(#mx-gradient-e6d0de-1-d5739d-1-s-0)" stroke="#996185" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 1166px; margin-left: 1092px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">PlainExecutor</div></div></div></foreignObject><text x="1166" y="1170" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">PlainExecutor</text></switch></g><rect x="270" y="1346" width="375" height="240" rx="7.2" ry="7.2" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 373px; height: 1px; padding-top: 1353px; margin-left: 271px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">executeAutoCommitFalse</div></div></div></foreignObject><text x="458" y="1365" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">executeAutoCommitFalse</text></switch></g><rect x="366.25" y="1376" width="182.5" height="30" rx="4.5" ry="4.5" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 181px; height: 1px; padding-top: 1391px; margin-left: 367px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">beforeImage</div></div></div></foreignObject><text x="458" y="1395" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">beforeImage</text></switch></g><rect x="366.25" y="1436" width="182.5" height="30" rx="4.5" ry="4.5" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 181px; height: 1px; padding-top: 1451px; margin-left: 367px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">执行目标sql语句</div></div></div></foreignObject><text x="458" y="1455" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">执行目标sql语句</text></switch></g><rect x="366.25" y="1486" width="182.5" height="30" rx="4.5" ry="4.5" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 181px; height: 1px; padding-top: 1501px; margin-left: 367px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">afterImage</div></div></div></foreignObject><text x="458" y="1505" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">afterImage</text></switch></g><rect x="366.25" y="1536" width="182.5" height="30" rx="4.5" ry="4.5" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 181px; height: 1px; padding-top: 1551px; margin-left: 367px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">prepareUndoLog</div></div></div></foreignObject><text x="458" y="1555" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">prepareUndoLog</text></switch></g><rect x="140" y="1616" width="887.5" height="440" rx="13.2" ry="13.2" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 886px; height: 1px; padding-top: 1623px; margin-left: 141px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">doCommit</div></div></div></foreignObject><text x="584" y="1635" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">doCommit</text></switch></g><rect x="363.75" y="1656" width="440" height="390" rx="19.5" ry="19.5" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 438px; height: 1px; padding-top: 1663px; margin-left: 365px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">processGlobalTransactionCommit</div></div></div></foreignObject><text x="584" y="1675" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">processGlobalTransactionCommit</text></switch></g><rect x="454.69" y="1696" width="258.12" height="70" rx="10.5" ry="10.5" fill="url(#mx-gradient-ffcd28-1-ffa500-1-s-0)" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 256px; height: 1px; padding-top: 1703px; margin-left: 456px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">register<br />发送BranchRegisterRequest请求<br />返回branchId存储在ConnectionContext对象中</div></div></div></foreignObject><text x="584" y="1715" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">register...</text></switch></g><rect x="454.69" y="1786" width="258.12" height="40" rx="6" ry="6" fill="url(#mx-gradient-ffcd28-1-ffa500-1-s-0)" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 256px; height: 1px; padding-top: 1793px; margin-left: 456px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">flushUndoLogs<br />undoLogs入库</div></div></div></foreignObject><text x="584" y="1805" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">flushUndoLogs...</text></switch></g><rect x="454.69" y="1846" width="258.12" height="30" rx="4.5" ry="4.5" fill="url(#mx-gradient-ffcd28-1-ffa500-1-s-0)" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 256px; height: 1px; padding-top: 1853px; margin-left: 456px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">targetConnection.commit</div></div></div></foreignObject><text x="584" y="1865" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">targetConnection.commit</text></switch></g><rect x="454.69" y="1896" width="258.12" height="60" rx="9" ry="9" fill="url(#mx-gradient-ffcd28-1-ffa500-1-s-0)" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 256px; height: 1px; padding-top: 1903px; margin-left: 456px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">report<br />发送BranchReportRequest请求<br />上报分支事务第一阶段执行成功。</div></div></div></foreignObject><text x="584" y="1915" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">report...</text></switch></g><rect x="454.69" y="1976" width="258.12" height="60" rx="9" ry="9" fill="url(#mx-gradient-ffcd28-1-ffa500-1-s-0)" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 256px; height: 1px; padding-top: 1983px; margin-left: 456px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">reset<br />xid,branchId,lockKeysBuffer,<br />sqlUndoItemsBuffer属性置空</div></div></div></foreignObject><text x="584" y="1995" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">reset...</text></switch></g><rect x="0" y="2286" width="2730" height="1570" rx="31.4" ry="31.4" fill="#647687" stroke="#314354" pointer-events="all"/><path d="M 345.81 2478.99 L 345.8 2591 L 435 2591 L 435 2695.9" fill="none" stroke="#0066cc" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 435 2702.65 L 430.5 2693.65 L 435 2695.9 L 439.5 2693.65 Z" fill="#0066cc" stroke="#0066cc" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 217.5 2476 L 217.5 3651 L 579.9 3651" fill="none" stroke="#0066cc" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 586.65 3651 L 577.65 3655.5 L 579.9 3651 L 577.65 3646.5 Z" fill="#0066cc" stroke="#0066cc" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="100" y="2346" width="470" height="130" rx="15.6" ry="15.6" fill="#b1ddf0" stroke="#10739e" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 468px; height: 1px; padding-top: 2411px; margin-left: 101px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">TM</div></div></div></foreignObject><text x="335" y="2415" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">TM</text></switch></g><rect x="1950" y="2346" width="830" height="1440" rx="41.5" ry="41.5" fill="url(#mx-gradient-ffcd28-1-ffa500-1-s-0)" stroke="#d79b00" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 828px; height: 1px; padding-top: 3066px; margin-left: 1951px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">TC</div></div></div></foreignObject><text x="2365" y="3070" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">TC</text></switch></g><path d="M 435 2906 L 435 3186 L 519.9 3186" fill="none" stroke="#0066cc" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 526.65 3186 L 517.65 3190.5 L 519.9 3186 L 517.65 3181.5 Z" fill="#0066cc" stroke="#0066cc" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="230" y="2706" width="410" height="200" rx="12" ry="12" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 408px; height: 1px; padding-top: 2713px; margin-left: 232px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">RM</div></div></div></foreignObject><text x="232" y="2725" fill="#000000" font-family="Helvetica" font-size="12px">RM</text></switch></g><path d="M 270 2781 C 270 2772.72 287.91 2766 310 2766 C 320.61 2766 330.78 2767.58 338.28 2770.39 C 345.79 2773.21 350 2777.02 350 2781 L 350 2811 C 350 2819.28 332.09 2826 310 2826 C 287.91 2826 270 2819.28 270 2811 Z" fill="#ffff88" stroke="#36393d" stroke-miterlimit="10" pointer-events="all"/><path d="M 350 2781 C 350 2789.28 332.09 2796 310 2796 C 287.91 2796 270 2789.28 270 2781" fill="none" stroke="#36393d" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 2796px; margin-left: 271px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><br /><br />DB</div></div></div></foreignObject><text x="310" y="2800" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DB...</text></switch></g><rect x="335" y="2566" width="75" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 2576px; margin-left: 336px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">远程调用</div></div></div></foreignObject><text x="373" y="2580" fill="#FFFF00" font-family="Helvetica" font-size="12px" text-anchor="middle">远程调用</text></switch></g><rect x="590" y="3516" width="260" height="180" rx="27" ry="27" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 258px; height: 1px; padding-top: 3606px; margin-left: 591px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">RM</div></div></div></foreignObject><text x="720" y="3610" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">RM</text></switch></g><rect x="140" y="2966" width="75" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 2976px; margin-left: 141px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">远程调用</div></div></div></foreignObject><text x="178" y="2980" fill="#FFFF00" font-family="Helvetica" font-size="12px" text-anchor="middle">远程调用</text></switch></g><path d="M 790 3141 L 1941.56 3130.89" fill="none" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" stroke-dasharray="9 9" pointer-events="stroke"/><path d="M 1948.31 3130.83 L 1939.35 3135.41 L 1941.56 3130.89 L 1939.27 3126.41 Z" fill="#cc0000" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="530" y="3096" width="260" height="180" rx="27" ry="27" fill="url(#mx-gradient-d5e8d4-1-97d077-1-s-0)" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 258px; height: 1px; padding-top: 3186px; margin-left: 531px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">RM</div></div></div></foreignObject><text x="660" y="3190" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">RM</text></switch></g><rect x="439" y="2956" width="75" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 2966px; margin-left: 440px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">远程调用</div></div></div></foreignObject><text x="477" y="2970" fill="#FFFF00" font-family="Helvetica" font-size="12px" text-anchor="middle">远程调用</text></switch></g><path d="M 548.75 3221 C 548.75 3212.72 566.66 3206 588.75 3206 C 599.36 3206 609.53 3207.58 617.03 3210.39 C 624.54 3213.21 628.75 3217.02 628.75 3221 L 628.75 3251 C 628.75 3259.28 610.84 3266 588.75 3266 C 566.66 3266 548.75 3259.28 548.75 3251 Z" fill="#ffff88" stroke="#36393d" stroke-miterlimit="10" pointer-events="all"/><path d="M 628.75 3221 C 628.75 3229.28 610.84 3236 588.75 3236 C 566.66 3236 548.75 3229.28 548.75 3221" fill="none" stroke="#36393d" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 3236px; margin-left: 550px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><br /><br />DB</div></div></div></foreignObject><text x="589" y="3240" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DB...</text></switch></g><path d="M 610 3641 C 610 3632.72 627.91 3626 650 3626 C 660.61 3626 670.78 3627.58 678.28 3630.39 C 685.79 3633.21 690 3637.02 690 3641 L 690 3671 C 690 3679.28 672.09 3686 650 3686 C 627.91 3686 610 3679.28 610 3671 Z" fill="#ffff88" stroke="#36393d" stroke-miterlimit="10" pointer-events="all"/><path d="M 690 3641 C 690 3649.28 672.09 3656 650 3656 C 627.91 3656 610 3649.28 610 3641" fill="none" stroke="#36393d" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 3656px; margin-left: 611px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><br /><br />DB</div></div></div></foreignObject><text x="650" y="3660" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DB...</text></switch></g><rect x="680" y="2716" width="92.5" height="30" rx="4.5" ry="4.5" fill="url(#mx-gradient-fff2cc-1-ffd966-1-s-0)" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 91px; height: 1px; padding-top: 2723px; margin-left: 682px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">branchRegister</div></div></div></foreignObject><text x="682" y="2735" fill="#000000" font-family="Helvetica" font-size="12px">branchRegister</text></switch></g><path d="M 500 2796 L 358.24 2796" fill="none" stroke="#ffff00" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 352.24 2796 L 360.24 2792 L 358.24 2796 L 360.24 2800 Z" fill="#ffff00" stroke="#ffff00" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="500" y="2776" width="118" height="40" rx="6" ry="6" fill="#cce5ff" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 116px; height: 1px; padding-top: 2783px; margin-left: 502px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">存储undoLog到数据库，执行目标sql到库</div></div></div></foreignObject><text x="502" y="2795" fill="#000000" font-family="Helvetica" font-size="12px">存储undoLog到数据库，执行目标sql到库</text></switch></g><path d="M 931.88 3076 L 931.9 2421 L 553.1 2421" fill="none" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" stroke-dasharray="9 9" pointer-events="stroke"/><path d="M 546.35 2421 L 555.35 2416.5 L 553.1 2421 L 555.35 2425.5 Z" fill="#cc0000" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="803.75" y="3076" width="256.25" height="50" rx="7.5" ry="7.5" fill="url(#mx-gradient-fff2cc-1-ffd966-1-s-0)" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 254px; height: 1px; padding-top: 3101px; margin-left: 805px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">branchRegister超时或者有RuntimeException，整体不一致，TM需要执行rollback逻辑</div></div></div></foreignObject><text x="932" y="3105" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">branchRegister超时或者有RuntimeException，整体不一致，TM需要执行rollback逻辑</text></switch></g><rect x="410" y="2406" width="133" height="60" rx="9" ry="9" fill="#f8cecc" stroke="#b85450" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 131px; height: 1px; padding-top: 2413px; margin-left: 412px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">catch到异常，发送GlobalRollbackRequest请求。</div></div></div></foreignObject><text x="412" y="2425" fill="#000000" font-family="Helvetica" font-size="12px">catch到异常，发送GlobalRollbackReq...</text></switch></g><path d="M 460 2866 L 310 2866 L 310 2836.1" fill="none" stroke="#ffff00" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 310 2829.35 L 314.5 2838.35 L 310 2836.1 L 305.5 2838.35 Z" fill="#ffff00" stroke="#ffff00" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="460" y="2846" width="168" height="40" rx="6" ry="6" fill="#cce5ff" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 166px; height: 1px; padding-top: 2853px; margin-left: 462px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">客户端执行undo操作，将数据还原为全局事务之前的状态。</div></div></div></foreignObject><text x="462" y="2865" fill="#000000" font-family="Helvetica" font-size="12px">客户端执行undo操作，将数据还原为全局事务之前的状态。</text></switch></g><rect x="2025" y="2366" width="680" height="1370" rx="6.8" ry="6.8" fill="#f8cecc" stroke="#b85450" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 678px; height: 1px; padding-top: 2373px; margin-left: 2026px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">DefaultCoordinator</div></div></div></foreignObject><text x="2365" y="2385" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DefaultCoordinator</text></switch></g><rect x="2075" y="2446" width="610" height="210" rx="31.5" ry="31.5" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 608px; height: 1px; padding-top: 2453px; margin-left: 2076px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">doGlobalBegin</div></div></div></foreignObject><text x="2380" y="2465" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">doGlobalBegin</text></switch></g><rect x="2095" y="2476" width="570" height="160" rx="11.2" ry="11.2" fill="#e3c800" stroke="#b09500" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 568px; height: 1px; padding-top: 2483px; margin-left: 2097px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">DefaultCore.begin<br /><ol><li>GlobalSession.createGlobalSession创建全局事务session</li><li>添加session生命周期监听器，类型为SessionManager的监听器，如果使用的存储时DB,则监听器为DataBaseSessionManager。</li><li>GlobalSession执行begin，开启全局事务。设置status为begin，设置开始时间属性，调用生命周期监听器的onBegin方法即此时会执行DataBaseSessinoManage的insertGlobalTransactionDO方法，将globalSession存储到DB中。</li><li>发送全局事务开始事件GlobalTransactionEvent</li><li>返回全局事务的xid到TM</li></ol></div></div></div></foreignObject><text x="2097" y="2495" fill="#000000" font-family="Helvetica" font-size="12px">DefaultCore.begin...</text></switch></g><rect x="2075" y="2731" width="610" height="210" rx="31.5" ry="31.5" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 608px; height: 1px; padding-top: 2738px; margin-left: 2076px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">doBranchRegister</div></div></div></foreignObject><text x="2380" y="2750" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">doBranchRegister</text></switch></g><rect x="2095" y="2766" width="570" height="160" rx="11.2" ry="11.2" fill="#e3c800" stroke="#b09500" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 568px; height: 1px; padding-top: 2773px; margin-left: 2097px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">branchRegister<br /><ol><li>获取根据xId获取GlobalSession</li><li>检查GlobalSession的状态</li><li>添加生命周期监听器</li><li>创建branchSession，设置xid，transactionId，branchId，branchType，resourceId，lockKeys</li><li>branchSessionLock，分支加锁，行级锁。假锁成功才会继续执行。</li><li>globalSession.addBranch,分支事务落库，设置branchSession状态为registered，添加branchSession到属性集合branchSessions中。</li><li>返回branchSession的branchId。</li></ol></div></div></div></foreignObject><text x="2097" y="2785" fill="#000000" font-family="Helvetica" font-size="12px">branchRegister...</text></switch></g><rect x="2075" y="3026" width="610" height="160" rx="24" ry="24" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 608px; height: 1px; padding-top: 3033px; margin-left: 2076px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">doBranchReport(默认不发送该类型消息)</div></div></div></foreignObject><text x="2380" y="3045" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">doBranchReport(默认不发送该类型消息)</text></switch></g><rect x="2095" y="3056" width="570" height="110" rx="7.7" ry="7.7" fill="#e3c800" stroke="#b09500" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 568px; height: 1px; padding-top: 3063px; margin-left: 2097px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">branchReport<br /><ol><li>获取globalSession，且globalSession包含branchSession信息。</li><li>根据分支branchId从globalSession中获取branchSession</li><li>添加生命周期监听器</li><li>更新branchSession状态为PhaseOne_Done,库中状态同步更新。</li></ol></div></div></div></foreignObject><text x="2097" y="3075" fill="#000000" font-family="Helvetica" font-size="12px">branchReport...</text></switch></g><rect x="2075" y="3256" width="610" height="180" rx="27" ry="27" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 608px; height: 1px; padding-top: 3263px; margin-left: 2076px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">doGlobalCommit</div></div></div></foreignObject><text x="2380" y="3275" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">doGlobalCommit</text></switch></g><rect x="2095" y="3286" width="570" height="120" rx="8.4" ry="8.4" fill="#e3c800" stroke="#b09500" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 568px; height: 1px; padding-top: 3293px; margin-left: 2097px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">commit<br /><ol><li>根据xid获取globalSession</li><li>添加生命周期监听器</li><li>设置globalSession的active属性为false，释放所有branchSession的锁</li><li>更改globalSession的状态为committing</li><li>如果是AT模式异步提交全局事务</li><li>返回全局事务提交状态</li></ol></div></div></div></foreignObject><text x="2097" y="3305" fill="#000000" font-family="Helvetica" font-size="12px">commit...</text></switch></g><path d="M 2075 3601 L 1200 3601 L 1200 2866 L 638.1 2866" fill="none" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" stroke-dasharray="9 9" pointer-events="stroke"/><path d="M 631.35 2866 L 640.35 2861.5 L 638.1 2866 L 640.35 2870.5 Z" fill="#cc0000" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="2075" y="3496" width="610" height="210" rx="31.5" ry="31.5" fill="#6a00ff" stroke="#3700cc" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 608px; height: 1px; padding-top: 3503px; margin-left: 2076px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #ffffff; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">doGlobalRollback</div></div></div></foreignObject><text x="2380" y="3515" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">doGlobalRollback</text></switch></g><rect x="2095" y="3526" width="570" height="150" rx="10.5" ry="10.5" fill="#e3c800" stroke="#b09500" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 568px; height: 1px; padding-top: 3533px; margin-left: 2097px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">rollback<br /><ol><li>根据xid获取globalSession</li><li>添加生命周期监听器</li><li>设置globalSession的active属性为false<br /></li><li>设置globalSession的状态为rollbacking</li><li>发送branchRollbackRequest</li><li>根据RM返回phaseTwo_Rollbacked 状态，服务端执行removeBranch</li><li>根据branchSession删除DB中branch记录，删除lock记录，删除内存中globalSession的branchSession</li></ol></div></div></div></foreignObject><text x="2097" y="3545" fill="#000000" font-family="Helvetica" font-size="12px">rollback...</text></switch></g><path d="M 570 2411 L 2380 2411 L 2380 2435.9" fill="none" stroke="#66cc00" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2380 2442.65 L 2375.5 2433.65 L 2380 2435.9 L 2384.5 2433.65 Z" fill="#66cc00" stroke="#66cc00" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 640 2756 L 1358 2756 L 1358 2783.5 L 2064.9 2783.5" fill="none" stroke="#66cc00" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2071.65 2783.5 L 2062.65 2788 L 2064.9 2783.5 L 2062.65 2779 Z" fill="#66cc00" stroke="#66cc00" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 2073 2846 L 1345.5 2846 L 1345.5 2796 L 628.1 2796" fill="none" stroke="#66cc00" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 621.35 2796 L 630.35 2791.5 L 628.1 2796 L 630.35 2800.5 Z" fill="#66cc00" stroke="#66cc00" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 509.75 2466 L 509.8 2526 L 1270 2526 L 1270 3548.5 L 2064.9 3548.5" fill="none" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" stroke-dasharray="9 9" pointer-events="stroke"/><path d="M 2071.65 3548.5 L 2062.65 3553 L 2064.9 3548.5 L 2062.65 3544 Z" fill="#cc0000" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 586 2886 L 586 2926 L 1120 2926 L 1120 3653.5 L 2064.9 3653.5" fill="none" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" stroke-dasharray="9 9" pointer-events="stroke"/><path d="M 2071.65 3653.5 L 2062.65 3658 L 2064.9 3653.5 L 2062.65 3649 Z" fill="#cc0000" stroke="#cc0000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="1188.5" cy="2387.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2388px; margin-left: 1171px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">1</div></div></div></foreignObject><text x="1189" y="2396" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">1</text></switch></g><ellipse cx="1359.5" cy="2464.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2465px; margin-left: 1342px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">2</div></div></div></foreignObject><text x="1360" y="2473" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">2</text></switch></g><ellipse cx="458.5" cy="2633.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2634px; margin-left: 441px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">3</div></div></div></foreignObject><text x="459" y="2642" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">3</text></switch></g><ellipse cx="968.5" cy="2654.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2655px; margin-left: 951px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">8</div></div></div></foreignObject><text x="969" y="2663" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">8</text></switch></g><ellipse cx="1298.5" cy="2637.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2638px; margin-left: 1281px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">9</div></div></div></foreignObject><text x="1299" y="2646" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">9</text></switch></g><ellipse cx="1118.5" cy="2731" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2731px; margin-left: 1101px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">4</div></div></div></foreignObject><text x="1119" y="2739" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">4</text></switch></g><ellipse cx="1128.5" cy="2807.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2808px; margin-left: 1111px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">5</div></div></div></foreignObject><text x="1129" y="2816" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">5</text></switch></g><ellipse cx="1198.5" cy="2984.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2985px; margin-left: 1181px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 25px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">10</div></div></div></foreignObject><text x="1199" y="2992" fill="#CC0000" font-family="Helvetica" font-size="25px" text-anchor="middle">10</text></switch></g><ellipse cx="473.19" cy="3037.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 3038px; margin-left: 456px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">6</div></div></div></foreignObject><text x="473" y="3046" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">6</text></switch></g><ellipse cx="931.5" cy="3167.5" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 3168px; margin-left: 914px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">7</div></div></div></foreignObject><text x="932" y="3176" fill="#CC0000" font-family="Helvetica" font-size="27px" text-anchor="middle">7</text></switch></g><ellipse cx="1148.5" cy="3346" rx="18.5" ry="18.5" fill="#ffff88" stroke="#36393d" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 3346px; margin-left: 1131px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 25px; font-family: Helvetica; color: #CC0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">11</div></div></div></foreignObject><text x="1149" y="3354" fill="#CC0000" font-family="Helvetica" font-size="25px" text-anchor="middle">11</text></switch></g><path d="M 2075 2498.5 L 1322.5 2498.5 L 1322.5 2460 L 581.98 2460.01" fill="none" stroke="#66cc00" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 575.23 2460.01 L 584.23 2455.51 L 581.98 2460.01 L 584.23 2464.51 Z" fill="#66cc00" stroke="#66cc00" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>