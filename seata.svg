<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="4362px" height="3572px" viewBox="-0.5 -0.5 4362 3572" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2020-12-18T09:14:54.974Z&quot; agent=&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.6.2 Chrome/83.0.4103.122 Electron/9.2.0 Safari/537.36&quot; etag=&quot;dPukpGRDkNvON9E3lNSO&quot; version=&quot;13.6.2&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;ft8qHBVG7MIYmR1m9sZa&quot; name=&quot;第 1 页&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><rect x="0" y="0" width="4360" height="3570" rx="35.7" ry="35.7" fill="#b1ddf0" stroke="#10739e" pointer-events="all"/><path d="M 729 450 L 729 487.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 729 492.88 L 725.5 485.88 L 729 487.63 L 732.5 485.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="424" y="230" width="610" height="220" rx="6.6" ry="6.6" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 608px; height: 1px; padding-top: 237px; margin-left: 426px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><span><font color="#1a1a1a">GlobalTransactionScanner是InitializingBean初始化后会调用<br />afterPropertiesSet 方法，进而执行initClient初始化客户端（TMClient,RMClient）<br />GlobalTransactionScanner实现了AbstractAutoProxyCreate<br />在创建类的时候，会对一些对象做特殊处理生成代理对象。<br /><br /><br /><font style="font-size: 13px">在执行isTccAutoProxy方法时，如果当前被解析的bean是远程接口如dubbo，sofa等（Feign，相关的需加上@LocalTCC，不依赖于指定框架，远程调用协议即可，在调用之前绑定xid等逻辑都要满足），如果是服务端接口，且接口上带有@TwoPhaseBusinessAction注解，则会将该接口当成资源注册到TC上,并且在本地存入tccResource信息，tccResource中存有commitMethod，rollbackMethod信息及TCC第二阶段的时候，会获取改信息来执行相应的方法。如果是消费端类型，在其他bean引用该远程接口时，会给该对象添加上拦截器TccActionInterceptor，一般需要引用远程接口的类的方法上又会有@GlobalTransactional注解即全局事务的发起方。</font></font></span></div></div></div></foreignObject><text x="426" y="249" fill="#000000" font-family="Helvetica" font-size="12px" font-weight="bold">GlobalTransactionScanner是InitializingBean初始化后会调用...</text></switch></g><rect x="814" y="270" width="90" height="30" rx="4.5" ry="4.5" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 285px; margin-left: 815px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">RMClient.init</div></div></div></foreignObject><text x="859" y="289" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">RMClient.init</text></switch></g><rect x="920" y="270" width="90" height="30" rx="4.5" ry="4.5" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 285px; margin-left: 921px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">TMClient.init</div></div></div></foreignObject><text x="965" y="289" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">TMClient.init</text></switch></g><path d="M 729 584 L 729 628.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 729 633.88 L 725.5 626.88 L 729 628.63 L 732.5 626.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="459" y="494" width="540" height="90" rx="2.7" ry="2.7" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 538px; height: 1px; padding-top: 501px; margin-left: 461px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">对带有GlobalTransactional、GlobalLock注解的bean添加增强。增强类为GlobalTransactionalInterceptor，控制着全局事务，一旦带有注解的方法执行，则会进入GlobalTransactionalInterceptor的invoke方法。</div></div></div></foreignObject><text x="461" y="515" fill="#000000" font-family="Helvetica" font-size="14px" font-weight="bold">对带有GlobalTransactional、GlobalLock注解的bean添加增强。增强类为GlobalTransactionalInterceptor，控制着全局事务，一旦带有注解的方法执行，则会进入GlobalTransact...</text></switch></g><rect x="269" y="635" width="920" height="335" rx="6.7" ry="6.7" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 918px; height: 1px; padding-top: 642px; margin-left: 271px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">handleGlobalTransaction<br />1：getTransactionInfo获取事务信息，隔离级别，回滚规则等信息。<br />2：getCurrentOrCreate：获取全局事务，如果不存在就创建一个，如果是新创建的，则role为launcher及发起者。<br />3：根据隔离级别决定是否挂起当前事务。<br />4：beginTransaction，开始全局事务<br />5：执行自己的业务逻辑<br />6：根据是否发生异常决定是commit还是rollback<div><br /></div><div><br /></div></div></div></div></foreignObject><text x="271" y="656" fill="#000000" font-family="Helvetica" font-size="14px" font-weight="bold">handleGlobalTransaction...</text></switch></g><rect x="285" y="770" width="888" height="85" rx="2.55" ry="2.55" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 886px; height: 1px; padding-top: 777px; margin-left: 287px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">beginTransaction<br />1：triggerBeforeBegin前置钩子函数<br />2：DefaultTransactionManager.begin，构建GlobalBeginRequest请求对象，同步调用server端，server会返回GlobalBeginResponse对象。接受server返回的xid，设置status为Begin。绑定xid到当前线程。<br />3：triggerAfterBegin后置钩子函数</div></div></div></foreignObject><text x="287" y="789" fill="#000000" font-family="Helvetica" font-size="12px" font-weight="bold">beginTransaction...</text></switch></g><rect x="285" y="870" width="890" height="85" rx="2.55" ry="2.55" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 888px; height: 1px; padding-top: 877px; margin-left: 287px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">执行自己的业务的时候，就会调用远程服务了，远程调用会传递xid给全局事务参与者（例如使用dubbo进行远程调用，通过dubbo的filter拓展，group配置位provider和consumer，传递的方式是通过dubbo的隐式传参，从RootContext获取xId和branchType传递过去。请求前在发送request之前需要从RootContext里获取xid放入请求头，在发送request，对于http接受的处理添加了HandlerInterceptorAdapter的实现类做请求前后的拦截，从header里获取xid绑定到当前RootContext。<br />），<br />在执行数据库相关操作的时候会被DataSourceProxy、ConnectionProxy、PreparedStatementProxy做相应拦截做特殊处理<div><br /></div></div></div></div></foreignObject><text x="287" y="889" fill="#000000" font-family="Helvetica" font-size="12px" font-weight="bold">执行自己的业务的时候，就会调用远程服务了，远程调用会传递xid给全局事务参与者（例如使用dubbo进行远程调用，通过dubbo的filter拓展，group配置位provider和consumer，传递的方式是通过dubbo的隐式传参，从RootContext获取xId和branchType传递过去。请求前在发送request之前需要从RootContext里获取xid放入请求头，在发送request，对于http接受的处理添加了HandlerInterceptorAdapter的实现类做请求前后的拦截，从header里获取xid绑定到当前RootContext。...</text></switch></g><rect x="1650" y="50" width="1166" height="1020" rx="51" ry="51" fill="none" stroke="#000000" pointer-events="all"/><path d="M 1993.5 120 L 1993.5 163.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1993.5 168.88 L 1990 161.88 L 1993.5 163.63 L 1997 161.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="1853.5" y="70" width="280" height="50" rx="7.5" ry="7.5" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 278px; height: 1px; padding-top: 77px; margin-left: 1855px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">DataSourceProxy<br />调用getConnection返回ConnectionProxy</div></div></div></foreignObject><text x="1994" y="90" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">DataSourceProxy...</text></switch></g><path d="M 1993.5 270 L 1993.5 313.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1993.5 318.88 L 1990 311.88 L 1993.5 313.63 L 1997 311.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 2181 245 L 2423.53 245 L 2423.53 313.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2423.53 318.88 L 2420.03 311.88 L 2423.53 313.63 L 2427.03 311.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="1806" y="170" width="375" height="100" rx="3" ry="3" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 373px; height: 1px; padding-top: 220px; margin-left: 1807px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">ConnectionProxy<br style="font-size: 13px" />prepareStatement方法创建PreparedStatementProxy对象，<font style="font-size: 13px"><span style="font-size: 13px">（如果不是AT模式，则undolog相关的模块会跳过）</span></font>执行execute会调用ExecuteTemplate的execute方法，该方法会根据具体执行的sql语句构建不同的executor对象，最终执行executer的execute方法。</div></div></div></foreignObject><text x="1994" y="224" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">ConnectionProxy...</text></switch></g><rect x="2276" y="120" width="150" height="40" rx="6" ry="6" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 140px; margin-left: 2277px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">InsertExecutor</div></div></div></foreignObject><text x="2351" y="144" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">InsertExecutor</text></switch></g><rect x="2456" y="120" width="150" height="40" rx="6" ry="6" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 140px; margin-left: 2457px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">UpdateExecutor</div></div></div></foreignObject><text x="2531" y="144" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">UpdateExecutor</text></switch></g><rect x="2276" y="180" width="150" height="40" rx="6" ry="6" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 200px; margin-left: 2277px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">DeleteExecutor</div></div></div></foreignObject><text x="2351" y="204" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">DeleteExecutor</text></switch></g><rect x="2456" y="180" width="150" height="40" rx="6" ry="6" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 200px; margin-left: 2457px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">SelectForUpdateExecutor</div></div></div></foreignObject><text x="2531" y="204" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">SelectForUpdateExecutor</text></switch></g><rect x="2627" y="120" width="150" height="40" rx="6" ry="6" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 140px; margin-left: 2628px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">PlainExecutor</div></div></div></foreignObject><text x="2702" y="144" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">PlainExecutor</text></switch></g><path d="M 1993.5 560 L 1993.53 582.53 L 2193.06 582.53 L 2193.06 598.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2193.06 603.88 L 2189.56 596.88 L 2193.06 598.63 L 2196.56 596.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="1806" y="320" width="375" height="240" rx="7.2" ry="7.2" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 373px; height: 1px; padding-top: 327px; margin-left: 1807px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">executeAutoCommitFalse</div></div></div></foreignObject><text x="1994" y="340" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">executeAutoCommitFalse</text></switch></g><rect x="1902.25" y="350" width="182.5" height="30" rx="4.5" ry="4.5" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 181px; height: 1px; padding-top: 365px; margin-left: 1903px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">beforeImage<br />目标语句执行前数据值</div></div></div></foreignObject><text x="1994" y="369" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">beforeImage...</text></switch></g><rect x="1902.25" y="410" width="182.5" height="30" rx="4.5" ry="4.5" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 181px; height: 1px; padding-top: 425px; margin-left: 1903px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">执行目标sql语句</div></div></div></foreignObject><text x="1994" y="429" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">执行目标sql语句</text></switch></g><rect x="1902.25" y="460" width="182.5" height="30" rx="4.5" ry="4.5" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 181px; height: 1px; padding-top: 475px; margin-left: 1903px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">afterImage<br />目标语句执行后数据值</div></div></div></foreignObject><text x="1994" y="479" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">afterImage...</text></switch></g><rect x="1902.25" y="510" width="182.5" height="30" rx="4.5" ry="4.5" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 181px; height: 1px; padding-top: 525px; margin-left: 1903px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">prepareUndoLog</div></div></div></foreignObject><text x="1994" y="529" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">prepareUndoLog</text></switch></g><rect x="1676" y="605" width="1034" height="455" rx="13.65" ry="13.65" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1032px; height: 1px; padding-top: 612px; margin-left: 1677px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">doCommit</div></div></div></foreignObject><text x="2193" y="625" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">doCommit</text></switch></g><rect x="1695" y="620" width="440" height="430" rx="21.5" ry="21.5" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 438px; height: 1px; padding-top: 627px; margin-left: 1696px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">processGlobalTransactionCommit</div></div></div></foreignObject><text x="1915" y="640" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">processGlobalTransactionCommit</text></switch></g><rect x="1705.51" y="643.13" width="419.75" height="98.75" rx="14.81" ry="14.81" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 418px; height: 1px; padding-top: 650px; margin-left: 1707px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">register<br style="font-size: 13px" />发送BranchRegisterRequest请求，在TC端要获取锁，如果已经有了该分支记录的锁，那么注册分支事务会失败，在RM端，autoCommit为true会重试注册<br style="font-size: 13px" />返回branchId存储在ConnectionContext对象中，branchId上报分支执行状态使用。</div></div></div></foreignObject><text x="1915" y="663" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">register...</text></switch></g><path d="M 2125 771.88 L 2237.53 771.94 L 2237.53 725 L 2343.63 725" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2348.88 725 L 2341.88 728.5 L 2343.63 725 L 2341.88 721.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="1705" y="750" width="420" height="87.5" rx="13.13" ry="13.13" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 418px; height: 1px; padding-top: 757px; margin-left: 1706px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">flushUndoLogs<br style="font-size: 13px" />undoLogs入库，undoLogs记录数是以事务来划分，同一个事物undoLog是一条记录，记录里的rollback_info里的json数据其中sqlUndoLogs是以sql语句划分，执行多少个sql，就会有多少个SqlUndoLog记录</div></div></div></foreignObject><text x="1915" y="770" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">flushUndoLogs...</text></switch></g><rect x="1785.94" y="850" width="258.12" height="55" rx="8.25" ry="8.25" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 256px; height: 1px; padding-top: 857px; margin-left: 1787px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">targetConnection.commit<br style="font-size: 13px" />把undoLog和本地sql绑定在一个Transaction里</div></div></div></foreignObject><text x="1915" y="870" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">targetConnection.commit...</text></switch></g><rect x="1786.32" y="910" width="258.12" height="60" rx="9" ry="9" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 256px; height: 1px; padding-top: 917px; margin-left: 1787px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">report（默认不上报）<br style="font-size: 13px" />发送BranchReportRequest请求<br style="font-size: 13px" />上报分支事务第一阶段执行成功。</div></div></div></foreignObject><text x="1915" y="930" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">report（默认不上报）...</text></switch></g><rect x="1786.32" y="980" width="258.12" height="60" rx="9" ry="9" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 256px; height: 1px; padding-top: 987px; margin-left: 1787px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">reset<br style="font-size: 13px" />xid,branchId,lockKeysBuffer,<br style="font-size: 13px" />sqlUndoItemsBuffer属性置空</div></div></div></foreignObject><text x="1915" y="1000" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">reset...</text></switch></g><rect x="55" y="1180" width="4250" height="2370" rx="23.7" ry="23.7" fill="none" stroke="#000000" pointer-events="all"/><path d="M 405.81 1352.99 L 405.76 1465 L 495.06 1465 L 495.01 1569.9" fill="none" stroke="#4d4d4d" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 495 1576.65 L 490.51 1567.64 L 495.01 1569.9 L 499.51 1567.65 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 277.5 1350 L 277.53 2525 L 639.9 2525" fill="none" stroke="#4d4d4d" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 646.65 2525 L 637.65 2529.5 L 639.9 2525 L 637.65 2520.5 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="160" y="1220" width="470" height="130" rx="15.6" ry="15.6" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 468px; height: 1px; padding-top: 1227px; margin-left: 161px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 19px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b>TM</b></div></div></div></foreignObject><text x="395" y="1246" fill="#000000" font-family="Helvetica" font-size="19px" text-anchor="middle">TM</text></switch></g><rect x="2010" y="1220" width="870" height="2300" rx="8.7" ry="8.7" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 868px; height: 1px; padding-top: 1227px; margin-left: 2011px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 18px"><b>TC</b></font></div></div></div></foreignObject><text x="2445" y="1239" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">TC</text></switch></g><path d="M 495 1780 L 495.06 2060.06 L 579.9 2060.01" fill="none" stroke="#4d4d4d" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 586.65 2060 L 577.65 2064.51 L 579.9 2060.01 L 577.64 2055.51 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="290" y="1580" width="410" height="200" rx="12" ry="12" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 408px; height: 1px; padding-top: 1587px; margin-left: 291px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 19px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">RM</div></div></div></foreignObject><text x="495" y="1606" fill="#000000" font-family="Helvetica" font-size="19px" text-anchor="middle" font-weight="bold">RM</text></switch></g><path d="M 330 1655 C 330 1646.72 347.91 1640 370 1640 C 380.61 1640 390.78 1641.58 398.28 1644.39 C 405.79 1647.21 410 1651.02 410 1655 L 410 1685 C 410 1693.28 392.09 1700 370 1700 C 347.91 1700 330 1693.28 330 1685 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 410 1655 C 410 1663.28 392.09 1670 370 1670 C 347.91 1670 330 1663.28 330 1655" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 1670px; margin-left: 331px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b style="font-size: 13px"><br /><br />DB</b></div></div></div></foreignObject><text x="370" y="1674" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DB...</text></switch></g><rect x="410" y="1440" width="75" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 1450px; margin-left: 411px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">远程调用</div></div></div></foreignObject><text x="448" y="1454" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">远程调用</text></switch></g><rect x="650" y="2390" width="350" height="180" rx="27" ry="27" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 348px; height: 1px; padding-top: 2397px; margin-left: 651px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 19px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">RM</div></div></div></foreignObject><text x="825" y="2416" fill="#000000" font-family="Helvetica" font-size="19px" text-anchor="middle" font-weight="bold">RM</text></switch></g><rect x="200" y="1840" width="75" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 1850px; margin-left: 201px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">远程调用</div></div></div></foreignObject><text x="238" y="1854" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">远程调用</text></switch></g><path d="M 850 2015 L 2001.64 2015.79" fill="none" stroke="#4d4d4d" stroke-width="3" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 2008.39 2015.8 L 1999.38 2020.29 L 2001.64 2015.79 L 1999.39 2011.29 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="590" y="1970" width="260" height="180" rx="5.4" ry="5.4" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 258px; height: 1px; padding-top: 1977px; margin-left: 591px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 19px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">RM</div></div></div></foreignObject><text x="720" y="1996" fill="#000000" font-family="Helvetica" font-size="19px" text-anchor="middle" font-weight="bold">RM</text></switch></g><rect x="499" y="1830" width="75" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 1840px; margin-left: 500px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">远程调用</div></div></div></foreignObject><text x="537" y="1844" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">远程调用</text></switch></g><path d="M 598 2096.5 C 598 2088.22 615.91 2081.5 638 2081.5 C 648.61 2081.5 658.78 2083.08 666.28 2085.89 C 673.79 2088.71 678 2092.52 678 2096.5 L 678 2126.5 C 678 2134.78 660.09 2141.5 638 2141.5 C 615.91 2141.5 598 2134.78 598 2126.5 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 678 2096.5 C 678 2104.78 660.09 2111.5 638 2111.5 C 615.91 2111.5 598 2104.78 598 2096.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 2112px; margin-left: 599px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><br style="font-size: 13px" /><br style="font-size: 13px" />DB</div></div></div></foreignObject><text x="638" y="2115" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">DB...</text></switch></g><path d="M 670 2515 C 670 2506.72 687.91 2500 710 2500 C 720.61 2500 730.78 2501.58 738.28 2504.39 C 745.79 2507.21 750 2511.02 750 2515 L 750 2545 C 750 2553.28 732.09 2560 710 2560 C 687.91 2560 670 2553.28 670 2545 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 750 2515 C 750 2523.28 732.09 2530 710 2530 C 687.91 2530 670 2523.28 670 2515" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 2530px; margin-left: 671px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><br style="font-size: 13px" /><br style="font-size: 13px" />DB</div></div></div></foreignObject><text x="710" y="2534" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">DB...</text></switch></g><rect x="740" y="1590" width="100" height="30" rx="4.5" ry="4.5" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 1597px; margin-left: 741px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">branchRegister</div></div></div></foreignObject><text x="790" y="1610" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">branchRegister</text></switch></g><path d="M 540 1670 L 418.24 1670" fill="none" stroke="#4d4d4d" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 412.24 1670 L 420.24 1666 L 418.24 1670 L 420.24 1674 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="540" y="1650" width="138" height="40" rx="6" ry="6" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 136px; height: 1px; padding-top: 1657px; margin-left: 541px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">存储undoLog到数据库，执行目标sql到库</div></div></div></foreignObject><text x="609" y="1670" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">存储undoLog到数据库，执行目标sql到库</text></switch></g><path d="M 991.88 1950 L 991.88 1295 L 613.1 1295" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 606.35 1295 L 615.35 1290.5 L 613.1 1295 L 615.35 1299.5 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="863.75" y="1950" width="256.25" height="50" rx="7.5" ry="7.5" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 254px; height: 1px; padding-top: 1975px; margin-left: 865px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">branchRegister超时或者有RuntimeException，整体不一致，TM需要执行rollback逻辑</div></div></div></foreignObject><text x="992" y="1979" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">branchRegister超时或者有RuntimeException，整体不一致，TM需要执行rollbac...</text></switch></g><rect x="440" y="1280" width="163" height="60" rx="9" ry="9" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 161px; height: 1px; padding-top: 1287px; margin-left: 442px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">catch到异常，发送GlobalRollbackRequest请求。</div></div></div></foreignObject><text x="442" y="1301" fill="#000000" font-family="Helvetica" font-size="14px" font-weight="bold">catch到异常，发送GlobalRollbackRequ...</text></switch></g><path d="M 470 1740 L 370 1740.06 L 370 1710.1" fill="none" stroke="#4d4d4d" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 370 1703.35 L 374.5 1712.35 L 370 1710.1 L 365.5 1712.35 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="470" y="1720" width="218" height="40" rx="6" ry="6" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 216px; height: 1px; padding-top: 1727px; margin-left: 472px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">客户端执行undo操作，将数据还原为全局事务之前的状态。删除undolog</div></div></div></foreignObject><text x="472" y="1740" fill="#000000" font-family="Helvetica" font-size="13px" font-weight="bold">客户端执行undo操作，将数据还原为全局事务之前的状态。删除undolog</text></switch></g><rect x="2085" y="1260" width="680" height="1350" rx="6.8" ry="6.8" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 678px; height: 1px; padding-top: 1267px; margin-left: 2086px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 13px"><b>DefaultCoordinator</b></font></div></div></div></foreignObject><text x="2425" y="1279" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">DefaultCoordinator</text></switch></g><path d="M 2745 1372.5 L 2745.06 1368.06 L 3213.06 1368.06 L 3671.76 1367.51" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 3677.76 1367.5 L 3669.77 1371.51 L 3671.76 1367.51 L 3669.76 1363.51 Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="2135" y="1320" width="610" height="210" rx="31.5" ry="31.5" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 608px; height: 1px; padding-top: 1327px; margin-left: 2136px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b><font style="font-size: 13px">doGlobalBegin</font></b></div></div></div></foreignObject><text x="2440" y="1339" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">doGlobalBegin</text></switch></g><rect x="2155" y="1350" width="570" height="160" rx="11.2" ry="11.2" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 568px; height: 1px; padding-top: 1357px; margin-left: 2157px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><font style="font-size: 13px">DefaultCore.begin<br /></font><ol style="font-size: 13px"><li><font style="font-size: 13px">GlobalSession.createGlobalSession创建全局事务session</font></li><li><font style="font-size: 13px">添加session生命周期监听器，类型为SessionManager的监听器，如果使用的存储时DB,则监听器为DataBaseSessionManager。</font></li><li><font style="font-size: 13px">GlobalSession执行begin，开启全局事务。设置status为begin，设置开始时间属性，调用生命周期监听器的onBegin方法即此时会执行DataBaseSessinoManage的insertGlobalTransactionDO方法，将globalSession存储到DB中。</font></li><li><font style="font-size: 13px">发送全局事务开始事件GlobalTransactionEvent</font></li><li><font style="font-size: 13px">返回全局事务的xid到TM</font></li></ol></div></div></div></foreignObject><text x="2157" y="1369" fill="#000000" font-family="Helvetica" font-size="12px" font-weight="bold">DefaultCore.begin...</text></switch></g><rect x="2135" y="1605" width="610" height="235" rx="18.8" ry="18.8" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 608px; height: 1px; padding-top: 1612px; margin-left: 2136px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">doBranchRegister</div></div></div></foreignObject><text x="2440" y="1625" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">doBranchRegister</text></switch></g><rect x="2155" y="1632.5" width="570" height="197.5" rx="7.9" ry="7.9" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 568px; height: 1px; padding-top: 1640px; margin-left: 2157px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">BranchRegister<br style="font-size: 13px" /><ol style="font-size: 13px"><li style="font-size: 13px">根据xId获取GlobalSession</li><li style="font-size: 13px">检查GlobalSession的状态</li><li style="font-size: 13px">添加生命周期监听器</li><li style="font-size: 13px">创建branchSession，设置xid，transactionId，branchId，branchType，resourceId，lockKeys</li><li style="font-size: 13px">AT模式下branchSessionLock，分支加锁，行级锁。在lock_table中加入记录，pk为处理中记录的主键，只有加锁成功才会继续执行。</li><li style="font-size: 13px">GlobalSession.addBranch,分支事务落库，设置branchSession状态为registered，添加branchSession到属性集合branchSessions中。</li><li style="font-size: 13px">返回branchSession的branchId。</li></ol></div></div></div></foreignObject><text x="2157" y="1653" fill="#000000" font-family="Helvetica" font-size="13px" font-weight="bold">BranchRegister...</text></switch></g><rect x="2135" y="1900" width="610" height="160" rx="24" ry="24" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 608px; height: 1px; padding-top: 1907px; margin-left: 2136px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">doBranchReport(默认不发送该类型消息)</div></div></div></foreignObject><text x="2440" y="1920" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">doBranchReport(默认不发送该类型消息)</text></switch></g><rect x="2155" y="1930" width="570" height="110" rx="7.7" ry="7.7" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 568px; height: 1px; padding-top: 1937px; margin-left: 2157px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">branchReport<br style="font-size: 13px" /><ol style="font-size: 13px"><li style="font-size: 13px">获取globalSession，且globalSession包含branchSession信息。</li><li style="font-size: 13px">根据分支branchId从globalSession中获取branchSession</li><li style="font-size: 13px">添加生命周期监听器</li><li style="font-size: 13px">更新branchSession状态为PhaseOne_Done,库中状态同步更新。</li></ol></div></div></div></foreignObject><text x="2157" y="1950" fill="#000000" font-family="Helvetica" font-size="13px" font-weight="bold">branchReport...</text></switch></g><rect x="2135" y="2130" width="610" height="180" rx="27" ry="27" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 608px; height: 1px; padding-top: 2137px; margin-left: 2136px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">doGlobalCommit</div></div></div></foreignObject><text x="2440" y="2150" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">doGlobalCommit</text></switch></g><rect x="2155" y="2160" width="570" height="140" rx="9.8" ry="9.8" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 568px; height: 1px; padding-top: 2167px; margin-left: 2157px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">commit<br style="font-size: 13px" /><ol style="font-size: 13px"><li style="font-size: 13px">根据xid获取globalSession</li><li style="font-size: 13px">添加生命周期监听器</li><li style="font-size: 13px">设置globalSession的active属性为false，释放所有branchSession的锁</li><li style="font-size: 13px">更改globalSession的状态为committing</li><li style="font-size: 13px">如果是AT模式异步提交全局事务</li><li style="font-size: 13px">返回全局事务提交状态</li></ol></div></div></div></foreignObject><text x="2157" y="2180" fill="#000000" font-family="Helvetica" font-size="13px" font-weight="bold">commit...</text></switch></g><path d="M 2135 2475 L 1260 2475 L 1260 1740.06 L 698.1 1740" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 691.35 1740 L 700.35 1735.5 L 698.1 1740 L 700.35 1744.5 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="2135" y="2350" width="610" height="250" rx="22.5" ry="22.5" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 608px; height: 1px; padding-top: 2357px; margin-left: 2136px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">doGlobalRollback</div></div></div></foreignObject><text x="2440" y="2370" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">doGlobalRollback</text></switch></g><rect x="2155" y="2380" width="570" height="180" rx="10.8" ry="10.8" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 568px; height: 1px; padding-top: 2387px; margin-left: 2157px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">rollback<br style="font-size: 13px" /><ol style="font-size: 13px"><li style="font-size: 13px">根据xid获取globalSession</li><li style="font-size: 13px">添加生命周期监听器</li><li style="font-size: 13px">设置globalSession的active属性为false<br style="font-size: 13px" /></li><li style="font-size: 13px">设置globalSession的状态为rollbacking</li><li style="font-size: 13px">发送branchRollbackRequest</li><li style="font-size: 13px">根据RM返回phaseTwo_Rollbacked 状态，服务端执行removeBranch</li><li style="font-size: 13px">二次查询库中数据，避免回滚过程中的新的分支事务注册上来</li><li style="font-size: 13px">根据branchSession删除DB中branch记录，删除lock记录，删除内存中globalSession的branchSession</li></ol></div></div></div></foreignObject><text x="2157" y="2400" fill="#000000" font-family="Helvetica" font-size="13px" font-weight="bold">rollback...</text></switch></g><path d="M 630 1285 L 2440 1285 L 2440 1309.9" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2440 1316.65 L 2435.5 1307.65 L 2440 1309.9 L 2444.5 1307.65 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 700 1630 L 1417.06 1630 L 1417.06 1663.75 L 2124.9 1663.75" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2131.65 1663.75 L 2122.65 1668.25 L 2124.9 1663.75 L 2122.65 1659.25 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 2133 1720 L 1405.53 1720.06 L 1405.53 1670.06 L 688.1 1670" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 681.35 1670 L 690.35 1665.5 L 688.1 1670 L 690.35 1674.5 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 562.25 1340 L 562.35 1400.06 L 1330 1400.06 L 1330 2412.53 L 2124.9 2412.5" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 2131.65 2412.5 L 2122.65 2417 L 2124.9 2412.5 L 2122.65 2408 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 633.5 1760 L 633.53 1800.06 L 1180 1800.06 L 1180 2537.47 L 2124.9 2537.5" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 2131.65 2537.5 L 2122.65 2542 L 2124.9 2537.5 L 2122.65 2533 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="1248.5" cy="1261.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1262px; margin-left: 1231px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">1</div></div></div></foreignObject><text x="1249" y="1270" fill="#000000" font-family="Helvetica" font-size="27px" text-anchor="middle">1</text></switch></g><ellipse cx="1419.5" cy="1338.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1339px; margin-left: 1402px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">2</div></div></div></foreignObject><text x="1420" y="1347" fill="#000000" font-family="Helvetica" font-size="27px" text-anchor="middle">2</text></switch></g><ellipse cx="518.5" cy="1507.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1508px; margin-left: 501px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">3</div></div></div></foreignObject><text x="519" y="1516" fill="#000000" font-family="Helvetica" font-size="27px" text-anchor="middle">3</text></switch></g><ellipse cx="1028.5" cy="1528.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1529px; margin-left: 1011px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">8</div></div></div></foreignObject><text x="1029" y="1537" fill="#000000" font-family="Helvetica" font-size="27px" text-anchor="middle">8</text></switch></g><ellipse cx="1358.5" cy="1511.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1511px; margin-left: 1341px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">9</div></div></div></foreignObject><text x="1359" y="1520" fill="#000000" font-family="Helvetica" font-size="27px" text-anchor="middle">9</text></switch></g><ellipse cx="1178.5" cy="1605" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1605px; margin-left: 1161px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">4</div></div></div></foreignObject><text x="1179" y="1613" fill="#000000" font-family="Helvetica" font-size="27px" text-anchor="middle">4</text></switch></g><ellipse cx="1188.5" cy="1688.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1689px; margin-left: 1171px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">5</div></div></div></foreignObject><text x="1189" y="1697" fill="#000000" font-family="Helvetica" font-size="27px" text-anchor="middle">5</text></switch></g><ellipse cx="1278.5" cy="1858.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1859px; margin-left: 1261px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 25px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">10</div></div></div></foreignObject><text x="1279" y="1866" fill="#000000" font-family="Helvetica" font-size="25px" text-anchor="middle">10</text></switch></g><ellipse cx="533.19" cy="1911.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1911px; margin-left: 516px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">6</div></div></div></foreignObject><text x="533" y="1920" fill="#000000" font-family="Helvetica" font-size="27px" text-anchor="middle">6</text></switch></g><ellipse cx="991.5" cy="2041.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2041px; margin-left: 974px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">7</div></div></div></foreignObject><text x="991" y="2050" fill="#000000" font-family="Helvetica" font-size="27px" text-anchor="middle">7</text></switch></g><ellipse cx="1208.5" cy="2220" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2220px; margin-left: 1191px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 25px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">11</div></div></div></foreignObject><text x="1209" y="2228" fill="#000000" font-family="Helvetica" font-size="25px" text-anchor="middle">11</text></switch></g><path d="M 2135 1372.5 L 1382.47 1372.53 L 1382.47 1334.06 L 641.98 1334.01" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 635.23 1334.01 L 644.23 1329.51 L 641.98 1334.01 L 644.23 1338.51 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="670" y="1405" width="62.5" height="60" fill="none" stroke="none" pointer-events="all"/><path d="M 695.25 1424.66 C 697.36 1423.47 699.45 1423.07 701.53 1423.09 C 709.9 1423.42 714.02 1430.64 713.35 1435.55 L 705.27 1435.55 L 715.03 1446.53 L 724.79 1435.55 L 718.25 1435.55 C 718.53 1425.57 710.49 1418.76 701.77 1418.49 C 698.64 1418.33 694.98 1419.31 691.98 1421.06 Z M 677.68 1434.5 L 684.19 1434.5 C 684.28 1442.56 689.17 1447.41 693.83 1449.48 C 699.73 1452.35 705.99 1451.2 710.47 1448.56 L 707.17 1444.86 C 705.94 1445.64 704.3 1446.17 702.19 1446.42 C 694.14 1446.85 688.92 1440.86 688.99 1434.5 L 697.09 1434.5 L 687.37 1423.08 Z M 701.33 1465 C 683.65 1465 670 1450.65 670 1436.16 C 670 1417.84 684.03 1405 701.55 1405 C 719.93 1405 732.5 1420.02 732.5 1434.37 C 732.5 1453.2 717.1 1465 701.33 1465 Z" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="2083.13" y="2710" width="683.75" height="780" rx="13.68" ry="13.68" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 682px; height: 1px; padding-top: 2717px; margin-left: 2084px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 25px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">定时JOB</div></div></div></foreignObject><text x="2425" y="2742" fill="#000000" font-family="Helvetica" font-size="25px" text-anchor="middle">定时JOB</text></switch></g><path d="M 2677.5 2815 L 2677.53 2810.06 L 2780 2810.06 L 2780 2475 L 2755.1 2475" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2748.35 2475 L 2757.35 2470.5 L 2755.1 2475 L 2757.35 2479.5 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="2172.5" y="2760" width="505" height="110" rx="7.7" ry="7.7" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 503px; height: 1px; padding-top: 2767px; margin-left: 2175px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">handleRetryRollbacking--定时重拾回滚任务<br style="font-size: 13px" /><ol style="font-size: 13px"><li style="font-size: 13px">获取状态为RollbackRetrying、Rollbacking、TimeoutRollbacking、TimeoutRollbackRetrying的所有globalSession</li><li style="font-size: 13px">检查globalSession的状态，如果是rollbacking且还没有重试超时，跳过</li><li style="font-size: 13px">检查是否重试超时，如果超时删除globalSession，默认一直重试</li><li style="font-size: 13px">调用doGlobalRollback</li></ol></div></div></div></foreignObject><text x="2175" y="2780" fill="#000000" font-family="Helvetica" font-size="13px" font-weight="bold">handleRetryRollbacking--定时重拾回滚任务...</text></switch></g><rect x="2690" y="2740" width="62.5" height="60" fill="none" stroke="none" pointer-events="all"/><path d="M 2715.25 2759.66 C 2717.36 2758.47 2719.45 2758.07 2721.53 2758.09 C 2729.9 2758.42 2734.02 2765.64 2733.35 2770.55 L 2725.27 2770.55 L 2735.03 2781.53 L 2744.79 2770.55 L 2738.25 2770.55 C 2738.53 2760.57 2730.49 2753.76 2721.77 2753.49 C 2718.64 2753.33 2714.98 2754.31 2711.98 2756.06 Z M 2697.68 2769.5 L 2704.19 2769.5 C 2704.28 2777.56 2709.17 2782.41 2713.83 2784.48 C 2719.73 2787.35 2725.99 2786.2 2730.47 2783.56 L 2727.17 2779.86 C 2725.94 2780.64 2724.3 2781.17 2722.19 2781.42 C 2714.14 2781.85 2708.92 2775.86 2708.99 2769.5 L 2717.09 2769.5 L 2707.37 2758.08 Z M 2721.33 2800 C 2703.65 2800 2690 2785.65 2690 2771.16 C 2690 2752.84 2704.03 2740 2721.55 2740 C 2739.93 2740 2752.5 2755.02 2752.5 2769.37 C 2752.5 2788.2 2737.1 2800 2721.33 2800 Z" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 2677.51 2950 L 2810 2950.06 L 2810 2220.06 L 2755.1 2220.01" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2748.35 2220 L 2757.36 2215.51 L 2755.1 2220.01 L 2757.35 2224.51 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="2172.51" y="2900" width="505" height="100" rx="7" ry="7" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 503px; height: 1px; padding-top: 2907px; margin-left: 2175px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">handleRetryCommitting--定时重拾提交任务<br style="font-size: 13px" /><ol style="font-size: 13px"><li style="font-size: 13px">获取状态为CommitRetrying的所有globalSession</li><li style="font-size: 13px">检擦是否重拾超时，如果超时删除globalSession</li><li style="font-size: 13px">调用doGlobalCommit</li></ol></div></div></div></foreignObject><text x="2175" y="2920" fill="#000000" font-family="Helvetica" font-size="13px" font-weight="bold">handleRetryCommitting--定时重拾提交任务...</text></switch></g><rect x="2690" y="2880" width="62.5" height="60" fill="none" stroke="none" pointer-events="all"/><path d="M 2715.25 2899.66 C 2717.36 2898.47 2719.45 2898.07 2721.53 2898.09 C 2729.9 2898.42 2734.02 2905.64 2733.35 2910.55 L 2725.27 2910.55 L 2735.03 2921.53 L 2744.79 2910.55 L 2738.25 2910.55 C 2738.53 2900.57 2730.49 2893.76 2721.77 2893.49 C 2718.64 2893.33 2714.98 2894.31 2711.98 2896.06 Z M 2697.68 2909.5 L 2704.19 2909.5 C 2704.28 2917.56 2709.17 2922.41 2713.83 2924.48 C 2719.73 2927.35 2725.99 2926.2 2730.47 2923.56 L 2727.17 2919.86 C 2725.94 2920.64 2724.3 2921.17 2722.19 2921.42 C 2714.14 2921.85 2708.92 2915.86 2708.99 2909.5 L 2717.09 2909.5 L 2707.37 2898.08 Z M 2721.33 2940 C 2703.65 2940 2690 2925.65 2690 2911.16 C 2690 2892.84 2704.03 2880 2721.55 2880 C 2739.93 2880 2752.5 2895.02 2752.5 2909.37 C 2752.5 2928.2 2737.1 2940 2721.33 2940 Z" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 2677.51 3080 L 2840 3080.06 L 2840 2190.06 L 2745.06 2190.06 L 2755.1 2190.01" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2748.35 2190 L 2757.36 2185.51 L 2755.1 2190.01 L 2757.35 2194.51 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="2172.51" y="3030" width="505" height="100" rx="7" ry="7" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 503px; height: 1px; padding-top: 3037px; margin-left: 2175px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">handleAsyncCommitting--定时异步提交任务，AT模式的事务<br style="font-size: 13px" /><ol style="font-size: 13px"><li style="font-size: 13px">获取状态为AsyncCommitting的所有globalSession</li><li style="font-size: 13px">调用doGlobalCommit</li><li style="font-size: 13px">AT模式下支持异步提交，该提交发送branchCommitRequest到RM</li></ol></div></div></div></foreignObject><text x="2175" y="3050" fill="#000000" font-family="Helvetica" font-size="13px" font-weight="bold">handleAsyncCommitting--定时异步提交任务，AT模式的事务...</text></switch></g><rect x="2690" y="3010" width="62.5" height="60" fill="none" stroke="none" pointer-events="all"/><path d="M 2715.25 3029.66 C 2717.36 3028.47 2719.45 3028.07 2721.53 3028.09 C 2729.9 3028.42 2734.02 3035.64 2733.35 3040.55 L 2725.27 3040.55 L 2735.03 3051.53 L 2744.79 3040.55 L 2738.25 3040.55 C 2738.53 3030.57 2730.49 3023.76 2721.77 3023.49 C 2718.64 3023.33 2714.98 3024.31 2711.98 3026.06 Z M 2697.68 3039.5 L 2704.19 3039.5 C 2704.28 3047.56 2709.17 3052.41 2713.83 3054.48 C 2719.73 3057.35 2725.99 3056.2 2730.47 3053.56 L 2727.17 3049.86 C 2725.94 3050.64 2724.3 3051.17 2722.19 3051.42 C 2714.14 3051.85 2708.92 3045.86 2708.99 3039.5 L 2717.09 3039.5 L 2707.37 3028.08 Z M 2721.33 3070 C 2703.65 3070 2690 3055.65 2690 3041.16 C 2690 3022.84 2704.03 3010 2721.55 3010 C 2739.93 3010 2752.5 3025.02 2752.5 3039.37 C 2752.5 3058.2 2737.1 3070 2721.33 3070 Z" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="2172.51" y="3170" width="505" height="90" rx="6.3" ry="6.3" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 503px; height: 1px; padding-top: 3177px; margin-left: 2175px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">timeoutCheck--定时超时检查<br style="font-size: 13px" /><ol style="font-size: 13px"><li style="font-size: 13px">获取所有globalSession</li><li style="font-size: 13px">如果状态不是Begin，或者没有超时的globalSession跳过</li><li style="font-size: 13px">globalSession的active为false，状态变更为TimeoutRollBacking</li></ol></div></div></div></foreignObject><text x="2175" y="3190" fill="#000000" font-family="Helvetica" font-size="13px" font-weight="bold">timeoutCheck--定时超时检查...</text></switch></g><path d="M 2172.51 3350 L 825.06 3350.06 L 825.06 2580.1" fill="none" stroke="#4d4d4d" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 825.06 2573.35 L 829.56 2582.35 L 825.06 2580.1 L 820.56 2582.35 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="2172.51" y="3310" width="505" height="80" rx="5.6" ry="5.6" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 503px; height: 1px; padding-top: 3317px; margin-left: 2175px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">undoLogDelete--定时定时删除undolog记录<br style="font-size: 13px" /><ol style="font-size: 13px"><li style="font-size: 13px">向RM发送UndoLogDeleteRequest请求，请求中带有saveDays参数，默认是7天，及记录默认最多保留七天。</li></ol></div></div></div></foreignObject><text x="2175" y="3330" fill="#000000" font-family="Helvetica" font-size="13px" font-weight="bold">undoLogDelete--定时定时删除undolog记录...</text></switch></g><rect x="2600" y="3180" width="62.5" height="60" fill="none" stroke="none" pointer-events="all"/><path d="M 2625.25 3199.66 C 2627.36 3198.47 2629.45 3198.07 2631.53 3198.09 C 2639.9 3198.42 2644.02 3205.64 2643.35 3210.55 L 2635.27 3210.55 L 2645.03 3221.53 L 2654.79 3210.55 L 2648.25 3210.55 C 2648.53 3200.57 2640.49 3193.76 2631.77 3193.49 C 2628.64 3193.33 2624.98 3194.31 2621.98 3196.06 Z M 2607.68 3209.5 L 2614.19 3209.5 C 2614.28 3217.56 2619.17 3222.41 2623.83 3224.48 C 2629.73 3227.35 2635.99 3226.2 2640.47 3223.56 L 2637.17 3219.86 C 2635.94 3220.64 2634.3 3221.17 2632.19 3221.42 C 2624.14 3221.85 2618.92 3215.86 2618.99 3209.5 L 2627.09 3209.5 L 2617.37 3198.08 Z M 2631.33 3240 C 2613.65 3240 2600 3225.65 2600 3211.16 C 2600 3192.84 2614.03 3180 2631.55 3180 C 2649.93 3180 2662.5 3195.02 2662.5 3209.37 C 2662.5 3228.2 2647.1 3240 2631.33 3240 Z" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="2100" y="3280" width="62.5" height="60" fill="none" stroke="none" pointer-events="all"/><path d="M 2125.25 3299.66 C 2127.36 3298.47 2129.45 3298.07 2131.53 3298.09 C 2139.9 3298.42 2144.02 3305.64 2143.35 3310.55 L 2135.27 3310.55 L 2145.03 3321.53 L 2154.79 3310.55 L 2148.25 3310.55 C 2148.53 3300.57 2140.49 3293.76 2131.77 3293.49 C 2128.64 3293.33 2124.98 3294.31 2121.98 3296.06 Z M 2107.68 3309.5 L 2114.19 3309.5 C 2114.28 3317.56 2119.17 3322.41 2123.83 3324.48 C 2129.73 3327.35 2135.99 3326.2 2140.47 3323.56 L 2137.17 3319.86 C 2135.94 3320.64 2134.3 3321.17 2132.19 3321.42 C 2124.14 3321.85 2118.92 3315.86 2118.99 3309.5 L 2127.09 3309.5 L 2117.37 3298.08 Z M 2131.33 3340 C 2113.65 3340 2100 3325.65 2100 3311.16 C 2100 3292.84 2114.03 3280 2131.55 3280 C 2149.93 3280 2162.5 3295.02 2162.5 3309.37 C 2162.5 3328.2 2147.1 3340 2131.33 3340 Z" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><path d="M 820 2530 L 760.1 2530" fill="none" stroke="#4d4d4d" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 753.35 2530 L 762.35 2525.5 L 760.1 2530 L 762.35 2534.5 Z" fill="#4d4d4d" stroke="#4d4d4d" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/><rect x="820" y="2495" width="168" height="70" rx="10.5" ry="10.5" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 166px; height: 1px; padding-top: 2502px; margin-left: 822px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">接受到server端的删除请求，以保留天数为参数执行删除语句，默认一次请求最多删除3000条。</div></div></div></foreignObject><text x="822" y="2515" fill="#000000" font-family="Helvetica" font-size="13px" font-weight="bold">接受到server端的删除请求，以保留天数为参数执行删除语句，默认一次请求最多删除3000条。</text></switch></g><rect x="960" y="1180" width="210" height="60" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 1210px; margin-left: 961px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 28px; font-family: Helvetica; color: #FFFF00; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><font color="#4d4d4d">AT</font></div></div></div></foreignObject><text x="1065" y="1218" fill="#FFFF00" font-family="Helvetica" font-size="28px" text-anchor="middle" font-weight="bold">AT</text></switch></g><rect x="3165" y="1160" width="220" height="80" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 1200px; margin-left: 3166px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 28px; font-family: Helvetica; color: #FFB570; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><font color="#4d4d4d">TCC</font></div></div></div></foreignObject><text x="3275" y="1208" fill="#FFB570" font-family="Helvetica" font-size="28px" text-anchor="middle" font-weight="bold">TCC</text></switch></g><path d="M 3768.75 1335 L 3768.82 1290.06 L 2592.47 1290.06 L 2592.49 1311.76" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2592.5 1317.76 L 2588.49 1309.77 L 2592.49 1311.76 L 2596.49 1309.76 Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><path d="M 3946.25 1465 L 3946.35 1532.53 L 3918.82 1532.53 L 3918.76 1588.03" fill="none" stroke="#000000" stroke-width="4" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 3918.75 1595.53 L 3913.77 1585.52 L 3918.76 1588.03 L 3923.77 1585.53 Z" fill="#000000" stroke="#000000" stroke-width="4" stroke-miterlimit="10" pointer-events="all"/><path d="M 4035 1400 L 4080 1400.06 L 4080 1972.53 L 4046.97 1972.51" fill="none" stroke="#000000" stroke-width="4" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 4039.47 1972.5 L 4049.48 1967.51 L 4046.97 1972.51 L 4049.47 1977.51 Z" fill="#000000" stroke="#000000" stroke-width="4" stroke-miterlimit="10" pointer-events="all"/><rect x="3680" y="1335" width="355" height="130" rx="15.6" ry="15.6" fill="#b1ddf0" stroke="#000000" stroke-width="4" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 353px; height: 1px; padding-top: 1400px; margin-left: 3681px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 19px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">TM</div></div></div></foreignObject><text x="3858" y="1406" fill="#000000" font-family="Helvetica" font-size="19px" text-anchor="middle" font-weight="bold">TM</text></switch></g><ellipse cx="3384.5" cy="1258.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1259px; margin-left: 3367px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#4d4d4d">1</font></div></div></div></foreignObject><text x="3385" y="1267" fill="#000000" font-family="Helvetica" font-size="27px" text-anchor="middle">1</text></switch></g><ellipse cx="3458.5" cy="1338.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1339px; margin-left: 3441px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #4D4D4D; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font>2</font></div></div></div></foreignObject><text x="3459" y="1347" fill="#4D4D4D" font-family="Helvetica" font-size="27px" text-anchor="middle">2</text></switch></g><path d="M 3686.25 1600 L 3686.35 1570.06 L 2592.47 1570.06 L 2592.49 1596.76" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2592.5 1602.76 L 2588.49 1594.77 L 2592.49 1596.76 L 2596.49 1594.76 Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="3570" y="1600" width="465" height="130" rx="7.8" ry="7.8" fill="none" stroke="#000000" stroke-width="4" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 463px; height: 1px; padding-top: 1607px; margin-left: 3571px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 19px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">RM</div></div></div></foreignObject><text x="3803" y="1626" fill="#000000" font-family="Helvetica" font-size="19px" text-anchor="middle" font-weight="bold">RM</text></switch></g><rect x="3560" y="1340" width="70" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 68px; height: 1px; padding-top: 1350px; margin-left: 3561px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #4D4D4D; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><font color="#000000">返回xid</font></div></div></div></foreignObject><text x="3595" y="1355" fill="#4D4D4D" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">返回xid</text></switch></g><rect x="3545" y="1260" width="100" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 1270px; margin-left: 3546px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #4D4D4D; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><font color="#000000">开启全局事务</font></div></div></div></foreignObject><text x="3595" y="1275" fill="#4D4D4D" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">开启全局事务</text></switch></g><rect x="3960" y="1506" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 1516px; margin-left: 3961px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><font>RPC</font></div></div></div></foreignObject><text x="3980" y="1521" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">RPC</text></switch></g><ellipse cx="3908.5" cy="1498.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1499px; margin-left: 3891px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #4D4D4D; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font>3</font></div></div></div></foreignObject><text x="3909" y="1507" fill="#4D4D4D" font-family="Helvetica" font-size="27px" text-anchor="middle">3</text></switch></g><ellipse cx="3508.5" cy="1548.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1549px; margin-left: 3491px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #4D4D4D; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font>4</font></div></div></div></foreignObject><text x="3509" y="1557" fill="#4D4D4D" font-family="Helvetica" font-size="27px" text-anchor="middle">4</text></switch></g><rect x="3594" y="1547" width="120" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1557px; margin-left: 3595px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">branchRegister</div></div></div></foreignObject><text x="3654" y="1562" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">branchRegister</text></switch></g><ellipse cx="3288.5" cy="1631.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1631px; margin-left: 3271px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #4D4D4D; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font>5</font></div></div></div></foreignObject><text x="3289" y="1640" fill="#4D4D4D" font-family="Helvetica" font-size="27px" text-anchor="middle">5</text></switch></g><rect x="3325" y="1620" width="120" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1630px; margin-left: 3326px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">返回branchID</div></div></div></foreignObject><text x="3385" y="1635" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">返回branchID</text></switch></g><path d="M 3765 1940 L 3765.06 1753.12 L 2753.24 1753.05" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2747.24 1753.05 L 2755.24 1749.05 L 2753.24 1753.05 L 2755.24 1757.05 Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="4108.5" cy="1881.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1881px; margin-left: 4091px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #4D4D4D; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font>6</font></div></div></div></foreignObject><text x="4109" y="1890" fill="#4D4D4D" font-family="Helvetica" font-size="27px" text-anchor="middle">6</text></switch></g><rect x="4025.5" y="1871.5" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 1882px; margin-left: 4027px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><font>RPC</font></div></div></div></foreignObject><text x="4046" y="1886" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">RPC</text></switch></g><ellipse cx="3428.5" cy="1780" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1780px; margin-left: 3411px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #4D4D4D; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font>7</font></div></div></div></foreignObject><text x="3429" y="1788" fill="#4D4D4D" font-family="Helvetica" font-size="27px" text-anchor="middle">7</text></switch></g><rect x="3505" y="1770" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 1780px; margin-left: 3506px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">branchRegister</div></div></div></foreignObject><text x="3525" y="1785" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">branc...</text></switch></g><ellipse cx="3378.5" cy="1938.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1939px; margin-left: 3361px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #4D4D4D; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font>8</font></div></div></div></foreignObject><text x="3379" y="1947" fill="#4D4D4D" font-family="Helvetica" font-size="27px" text-anchor="middle">8</text></switch></g><rect x="3470" y="1937" width="120" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1947px; margin-left: 3471px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">返回branchID</div></div></div></foreignObject><text x="3530" y="1952" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">返回branchID</text></switch></g><path d="M 3810 1695.75 L 3810 2166.06 L 2753.24 2166" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2747.24 2166 L 2755.24 2162 L 2753.24 2166 L 2755.24 2170 Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="3770" y="1645.75" width="80" height="50" rx="7.5" ry="7.5" fill="none" stroke="#000000" stroke-width="2" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 1671px; margin-left: 3771px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">confirm</div></div></div></foreignObject><text x="3810" y="1675" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">confirm</text></switch></g><rect x="3900" y="1645.75" width="80" height="50" rx="7.5" ry="7.5" fill="none" stroke="#000000" stroke-width="2" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 1671px; margin-left: 3901px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><div style="font-size: 15px"><span style="font-size: 15px">cancel</span></div></div></div></div></foreignObject><text x="3940" y="1675" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">cancel</text></switch></g><rect x="3628" y="1645.75" width="86" height="48.5" rx="7.27" ry="7.27" fill="none" stroke="#000000" stroke-width="2" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 84px; height: 1px; padding-top: 1670px; margin-left: 3629px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><div style="font-size: 15px"><span style="font-size: 15px">try</span></div></div></div></div></foreignObject><text x="3671" y="1675" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">try</text></switch></g><ellipse cx="4128.5" cy="2140" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2140px; margin-left: 4111px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #4D4D4D; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font>9</font></div></div></div></foreignObject><text x="4129" y="2148" fill="#4D4D4D" font-family="Helvetica" font-size="27px" text-anchor="middle">9</text></switch></g><rect x="4058.5" y="2160" width="100" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 2170px; margin-left: 4059px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">提交全局事务</div></div></div></foreignObject><text x="4108" y="2175" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">提交全局事务</text></switch></g><path d="M 2745 2150.06 L 3780 2150.06 L 3780 1696.06 L 3780 1704.24" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 3780 1698.24 L 3784 1706.24 L 3780 1704.24 L 3776 1706.24 Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="3675" y="1940" width="360" height="130" rx="7.8" ry="7.8" fill="none" stroke="#000000" stroke-width="4" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 358px; height: 1px; padding-top: 1947px; margin-left: 3676px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 19px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">RM</div></div></div></foreignObject><text x="3855" y="1966" fill="#000000" font-family="Helvetica" font-size="19px" text-anchor="middle" font-weight="bold">RM</text></switch></g><rect x="3714" y="1980.75" width="86" height="48.5" rx="7.27" ry="7.27" fill="none" stroke="#000000" stroke-width="2" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 84px; height: 1px; padding-top: 2005px; margin-left: 3715px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><div style="font-size: 15px"><span style="font-size: 15px">try</span></div></div></div></div></foreignObject><text x="3757" y="2010" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">try</text></switch></g><path d="M 2745 2200.02 L 3833.06 2200.06 L 3833.04 2037.24" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 3833.04 2031.24 L 3837.04 2039.24 L 3833.04 2037.24 L 3829.04 2039.24 Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="3820" y="1980" width="80" height="50" rx="7.5" ry="7.5" fill="none" stroke="#000000" stroke-width="2" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 2005px; margin-left: 3821px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">confirm</div></div></div></foreignObject><text x="3860" y="2010" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">confirm</text></switch></g><rect x="3920" y="1980" width="80" height="50" rx="7.5" ry="7.5" fill="none" stroke="#000000" stroke-width="2" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 2005px; margin-left: 3921px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><div style="font-size: 15px"><span style="font-size: 15px">cancel</span></div></div></div></div></foreignObject><text x="3960" y="2010" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">cancel</text></switch></g><ellipse cx="3426.5" cy="2121.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2121px; margin-left: 3409px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #4D4D4D; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font>10</font></div></div></div></foreignObject><text x="3427" y="2130" fill="#4D4D4D" font-family="Helvetica" font-size="27px" text-anchor="middle">10</text></switch></g><rect x="3463.5" y="2111.5" width="133" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 131px; height: 1px; padding-top: 2122px; margin-left: 3464px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">branchCommit</div></div></div></foreignObject><text x="3530" y="2126" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">branchCommit</text></switch></g><ellipse cx="3831.5" cy="1801.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 1801px; margin-left: 3814px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #4D4D4D; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font>11</font></div></div></div></foreignObject><text x="3832" y="1810" fill="#4D4D4D" font-family="Helvetica" font-size="27px" text-anchor="middle">11</text></switch></g><rect x="3800" y="1827" width="133" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 131px; height: 1px; padding-top: 1837px; margin-left: 3801px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">branchStatus</div></div></div></foreignObject><text x="3867" y="1842" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">branchStatus</text></switch></g><ellipse cx="3860" cy="2131.5" rx="18.5" ry="18.5" fill="none" stroke="#000000" stroke-width="3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 35px; height: 1px; padding-top: 2131px; margin-left: 3843px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 27px; font-family: Helvetica; color: #4D4D4D; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font>12</font></div></div></div></foreignObject><text x="3860" y="2140" fill="#4D4D4D" font-family="Helvetica" font-size="27px" text-anchor="middle">12</text></switch></g><rect x="3873.5" y="2121.5" width="133" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 131px; height: 1px; padding-top: 2132px; margin-left: 3874px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">branchCommit</div></div></div></foreignObject><text x="3940" y="2136" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">branchCommit</text></switch></g><rect x="3000" y="2337" width="380" height="88.5" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 372px; height: 1px; padding-top: 2327px; margin-left: 3004px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 99px; overflow: hidden; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><h1><font>Try阶段</font></h1><p style="text-align: left"><span style="line-height: 100%"><font>try阶段方法一般是预留资源的，将要变更的数据提前保护起来，例如冻结金额，锁定库存等。</font></span></p></div></div></div></foreignObject><text x="3190" y="2339" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">Try阶段...</text></switch></g><rect x="3420" y="2337" width="380" height="88.5" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 372px; height: 1px; padding-top: 2327px; margin-left: 3424px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 99px; overflow: hidden; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><h1><font>Confirm阶段</font></h1><div><font>该阶段一般是对预留资源的处理，正向提交业务逻辑，如将扣减冻结金额，扣减库存等。</font></div></div></div></div></foreignObject><text x="3610" y="2339" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">Confirm阶段...</text></switch></g><rect x="3830" y="2337" width="380" height="88.5" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 372px; height: 1px; padding-top: 2327px; margin-left: 3834px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 99px; overflow: hidden; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><h1><font>Cancel阶段</font></h1><div><font>该阶段也是对预留资源的处理，反向提交业务逻辑，如将冻结金额恢复，库存恢复等。</font></div><div><br /></div></div></div></div></foreignObject><text x="4020" y="2339" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">Cancel阶段...</text></switch></g><rect x="3165.5" y="2530" width="860" height="280" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 852px; height: 1px; padding-top: 2520px; margin-left: 3171px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 290px; overflow: hidden; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><h1><font>                     注意事项</font></h1></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><div style="font-size: 13px"><ol><li><font>空回滚：在try还没执行完或者执行失败的情况下，执行了cancel方法，所以cancel方式需要识别出是否是空回归，如果是直接返回成功。</font></li><li><font>幂等：TC端可能会重复调用confirm和cancel。可以添加一个事务记录表，记录已经处理的事务。</font></li><li><font>悬挂：二阶段的cancel已经执行，try阶段才执行，那么资源就会一直被预留即为悬挂，为了解决这个问题，在二阶段处理时，如果是空回滚，那么就在事务记录表中加入一条状态为已回滚的记录，try阶段提交时发现是已经执行过cancel后就不再执行try。</font></li><li><font>在AT模式下，二阶段回滚的时候，如果beforeImage和afterImage相同、currentImage等于beforeImage、currentimage不等于afterImage都不回滚，只有在currentImage等于afterImage的时候才回滚。</font></li><li><font>默认情况下，如果GlobalCommit或GlobalRollback提交失败会一直重拾，可以设置maxCommitRetryTimeout和maxRollbackRetryTimeout，来管理重试多久后就不在重试，删除GlobalTransaction记录。</font></li></ol></div><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><div style="font-size: 13px"><div><font>                                        <font style="font-size: 24px"><span>可优化事项</span></font></font></div></div></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><blockquote style="margin: 0 0 0 40px ; border: none ; padding: 0px"><div style="font-size: 13px"><font style="font-size: 13px">由于try阶段已经预留资源，则其他操作不会对该资源进行处理，那么confirm和cancel的执行可以异步处理。提升业务的并发性。</font></div></blockquote><div><br /></div></div></div></div></foreignObject><text x="3171" y="2532" fill="#000000" font-family="Helvetica" font-size="12px" font-weight="bold">注意事项...</text></switch></g><rect x="658.5" y="2011.5" width="181.5" height="70" rx="10.5" ry="10.5" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 180px; height: 1px; padding-top: 2019px; margin-left: 660px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">如果是二阶段提交，那么会插入带删除队列AsyncWorker，异步删除undolog</div></div></div></foreignObject><text x="660" y="2032" fill="#000000" font-family="Helvetica" font-size="13px" font-weight="bold">如果是二阶段提交，那么会插入带删除队列AsyncWorker，异步删除undolog</text></switch></g><rect x="2236" y="320" width="375" height="190" rx="5.7" ry="5.7" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 373px; height: 1px; padding-top: 327px; margin-left: 2237px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">processLocalCommitWithGlobalLocks<br />被@GlobalLock标记的方法且是对数据库的写操作<div><br /></div></div></div></div></foreignObject><text x="2424" y="340" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">processLocalCommitWithGlobalLocks...</text></switch></g><rect x="2296.62" y="380" width="253.75" height="90" rx="13.5" ry="13.5" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 252px; height: 1px; padding-top: 425px; margin-left: 2298px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">checkLock<br />发送GlobalLockQueryRequest<br />请求，server端会根据lockKeys从lock_table表中查询记录，如果查询到，且xid不同，则证明已经被其他全局事务锁定，则当前本地事务就不能提交了</div></div></div></foreignObject><text x="2423" y="429" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">checkLock...</text></switch></g><rect x="2290" y="280" width="122" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 120px; height: 1px; padding-top: 295px; margin-left: 2291px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">@GlobalLock</div></div></div></foreignObject><text x="2351" y="299" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">@GlobalLock</text></switch></g><rect x="1970" y="280" width="255.31" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 253px; height: 1px; padding-top: 295px; margin-left: 1971px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">@GlobalTransactional</div></div></div></foreignObject><text x="2098" y="299" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">@GlobalTransactional</text></switch></g><path d="M 2745 1781.25 L 3229.53 1781.35 L 3229.53 1992.88 L 3705.76 1992.88" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 3711.76 1992.88 L 3703.76 1996.88 L 3705.76 1992.88 L 3703.76 1988.88 Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><path d="M 2745 1663.75 L 3619.76 1657.93" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 3625.76 1657.89 L 3617.79 1661.94 L 3619.76 1657.93 L 3617.74 1653.94 Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"/><rect x="2350" y="630" width="340" height="380" rx="10.2" ry="10.2" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 338px; height: 1px; padding-top: 637px; margin-left: 2351px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">Transaction</div></div></div></foreignObject><text x="2520" y="650" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">Transaction</text></switch></g><rect x="2360" y="665" width="320" height="335" rx="9.6" ry="9.6" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 672px; margin-left: 2361px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">UndoLog 表中一条记录</div></div></div></foreignObject><text x="2520" y="685" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">UndoLog 表中一条记录</text></switch></g><rect x="2370" y="695" width="300" height="295" rx="8.85" ry="8.85" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 298px; height: 1px; padding-top: 702px; margin-left: 2371px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">sqlUndoLogs 记录中一个属性</div></div></div></foreignObject><text x="2520" y="715" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">sqlUndoLogs 记录中一个属性</text></switch></g><path d="M 2568 782.5 L 2704 782.53 L 2704 833.82 L 2833.63 833.75" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2838.88 833.75 L 2831.88 837.25 L 2833.63 833.75 L 2831.88 830.25 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="2388" y="725" width="180" height="115" rx="5.75" ry="5.75" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 178px; height: 1px; padding-top: 732px; margin-left: 2390px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">SqlUndoLog<br style="font-size: 13px" />type：语句类型如insert，update<br style="font-size: 13px" />beforeImage：执行前数据镜像<br style="font-size: 13px" />afterImage：执行后数据镜像</div></div></div></foreignObject><text x="2390" y="745" fill="#000000" font-family="Helvetica" font-size="13px" font-weight="bold">SqlUndoLog...</text></switch></g><rect x="2388" y="870" width="180" height="105" rx="7.35" ry="7.35" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 178px; height: 1px; padding-top: 877px; margin-left: 2390px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">SqlUndoLog<br style="font-size: 13px" />type：语句类型如delete<br style="font-size: 13px" />beforeImage：执行前数据镜像<br style="font-size: 13px" />afterImage：执行后数据镜像</div></div></div></foreignObject><text x="2390" y="890" fill="#000000" font-family="Helvetica" font-size="13px" font-weight="bold">SqlUndoLog...</text></switch></g><rect x="2200" y="675" width="137" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 135px; height: 1px; padding-top: 685px; margin-left: 2201px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><font style="font-size: 13px">undoLog内容解释</font></div></div></div></foreignObject><text x="2269" y="689" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">undoLog内容解释</text></switch></g><rect x="2840" y="757.5" width="330" height="152.5" rx="7.63" ry="7.63" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 328px; height: 1px; padding-top: 765px; margin-left: 2842px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><font style="font-size: 15px">lock_table<br style="font-size: 15px" />row_key：resource_id^^^表名^^^数据主键<br style="font-size: 15px" />xid：全局事务id<br style="font-size: 15px" />branchId：分支事务id<br style="font-size: 15px" />table_name：表名<br style="font-size: 15px" />pk：数据主键</font></div></div></div></foreignObject><text x="2842" y="780" fill="#000000" font-family="Helvetica" font-size="15px" font-weight="bold">lock_table...</text></switch></g><rect x="2840" y="720" width="223" height="50" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 221px; height: 1px; padding-top: 745px; margin-left: 2841px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 15px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><font style="font-size: 15px">对应TC中lock_table的一条记录</font></div></div></div></foreignObject><text x="2952" y="750" fill="#000000" font-family="Helvetica" font-size="15px" text-anchor="middle" font-weight="bold">对应TC中lock_table的一条记录</text></switch></g><rect x="3560" y="1496.75" width="308.5" height="38.5" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 307px; height: 1px; padding-top: 1516px; margin-left: 3561px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 13px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><font style="font-size: 13px">带有BusinessActionContextParameter的属性会构建位json对象传到分支事务的属性信息里存入d'b</font></div></div></div></foreignObject><text x="3714" y="1520" fill="#000000" font-family="Helvetica" font-size="13px" text-anchor="middle" font-weight="bold">带有BusinessActionContextParameter的属性会构建位json对象传到分支事务的属性信息里存入d'b</text></switch></g><rect x="2213" y="70" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 80px; margin-left: 2214px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 19px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><font style="font-size: 19px">AT</font></div></div></div></foreignObject><text x="2233" y="86" fill="#000000" font-family="Helvetica" font-size="19px" text-anchor="middle" font-weight="bold">AT</text></switch></g><rect x="3200" y="275" width="700" height="835" rx="14" ry="14" fill="none" stroke="#000000" pointer-events="all"/><path d="M 3545 640 L 3545 723.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 3545 728.88 L 3541.5 721.88 L 3545 723.63 L 3548.5 721.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="3240" y="335" width="610" height="305" rx="18.3" ry="18.3" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 608px; height: 1px; padding-top: 342px; margin-left: 3241px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 18px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><font>对TCC模式的远程服务提供者的处理<br style="font-size: 18px" /></font><ol style="font-size: 18px"><li style="text-align: left ; font-size: 18px"><font>解析注解@TwoPhaseBusinessAction的属性，name（全局唯一）、prepareMethod、commitMethod、rollbackMethod。方法里的参数类型都是BusinessActionContext。</font></li><li style="text-align: left ; font-size: 18px"><font>注册到TCCResourceManager，一个本地的资源管理器。（</font><font>dubbo，sofa这种远程reference类型的bean会加上TccActionInterceptor的拦截器，加上该拦截器的bean在这个事务模型里就会成为一个TccResource。除了这种内置实现的远程接口，还可以使用@LocalTCC注解来标记一个TccResource,一般http接口的调用可以使用这种方式，但是需要调用时传送xid到TccResource这一端，存入上下文中</font><font>） TccResource维护者二阶段的方法，目标类等信息，TCCResourceManager根据TccResource来执行二阶段的方法。</font></li><li style="text-align: left ; font-size: 18px"><font>注册到远端的TC，二阶段获取channel使用。</font></li></ol></div></div></div></foreignObject><text x="3545" y="360" fill="#000000" font-family="Helvetica" font-size="18px" text-anchor="middle" font-weight="bold">对TCC模式的远程服务提供者的处理...</text></switch></g><rect x="3235" y="730" width="620" height="240" rx="7.2" ry="7.2" fill="none" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 618px; height: 1px; padding-top: 737px; margin-left: 3236px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 18px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; "><font>TccActionInterceptor执行invoke拦截方法<br /></font><ol><li style="text-align: left"><font>判断上下文中是否存在xid，如果不存在，则直接调用目标类的目标方法。</font></li><li style="text-align: left"><font>获取接口上的@TwoPhaseBusinessAction注解，如果为null，则直接执行目标类目标方法。</font></li><li style="text-align: left"><font>构建BussinessActionContext，二阶段方法参数，业务上的参数可以通过该对象的getActionContext方法获取@BusinessActionContextParameter注解标注的属性参数值。</font></li><li style="text-align: left"><font>执行branchRegister方法，将分支事务注册到TC。try阶段的自定义参数也会随着注册的方法写入到TC分之事务的属性里。待二阶段使用。</font></li></ol></div></div></div></foreignObject><text x="3545" y="755" fill="#000000" font-family="Helvetica" font-size="18px" text-anchor="middle" font-weight="bold">TccActionInterceptor执行invoke拦截方法...</text></switch></g><path d="M 4035 1367.5 L 4160 1367.47 L 4160 2265 L 2756.97 2265" fill="none" stroke="#000000" stroke-width="4" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2749.47 2265 L 2759.47 2260 L 2756.97 2265 L 2759.47 2270 Z" fill="#000000" stroke="#000000" stroke-width="4" stroke-miterlimit="10" pointer-events="all"/><rect x="4170" y="1753" width="62.5" height="60" fill="none" stroke="none" pointer-events="all"/><path d="M 4195.25 1772.66 C 4197.36 1771.47 4199.45 1771.07 4201.53 1771.09 C 4209.9 1771.42 4214.02 1778.64 4213.35 1783.55 L 4205.27 1783.55 L 4215.03 1794.53 L 4224.79 1783.55 L 4218.25 1783.55 C 4218.53 1773.57 4210.49 1766.76 4201.77 1766.49 C 4198.64 1766.33 4194.98 1767.31 4191.98 1769.06 Z M 4177.68 1782.5 L 4184.19 1782.5 C 4184.28 1790.56 4189.17 1795.41 4193.83 1797.48 C 4199.73 1800.35 4205.99 1799.2 4210.47 1796.56 L 4207.17 1792.86 C 4205.94 1793.64 4204.3 1794.17 4202.19 1794.42 C 4194.14 1794.85 4188.92 1788.86 4188.99 1782.5 L 4197.09 1782.5 L 4187.37 1771.08 Z M 4201.33 1813 C 4183.65 1813 4170 1798.65 4170 1784.16 C 4170 1765.84 4184.03 1753 4201.55 1753 C 4219.93 1753 4232.5 1768.02 4232.5 1782.37 C 4232.5 1801.2 4217.1 1813 4201.33 1813 Z" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="all"/></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>